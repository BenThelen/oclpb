/* Generated by Cython 0.15.1 on Tue Jan 10 10:54:06 2012 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#else

#include <stddef.h> /* For offsetof */
#ifndef offsetof
#define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif

#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif

#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif

#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif

#if PY_VERSION_HEX < 0x02040000
  #define METH_COEXIST 0
  #define PyDict_CheckExact(op) (Py_TYPE(op) == &PyDict_Type)
  #define PyDict_Contains(d,o)   PySequence_Contains(d,o)
#endif

#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PY_FORMAT_SIZE_T ""
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   __Pyx_PyInt_AsInt(o)
  #define PyNumber_Index(o)    PyNumber_Int(o)
  #define PyIndex_Check(o)     PyNumber_Check(o)
  #define PyErr_WarnEx(category, message, stacklevel) PyErr_Warn(category, message)
#endif

#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)

  typedef struct {
     void *buf;
     PyObject *obj;
     Py_ssize_t len;
     Py_ssize_t itemsize;
     int readonly;
     int ndim;
     char *format;
     Py_ssize_t *shape;
     Py_ssize_t *strides;
     Py_ssize_t *suboffsets;
     void *internal;
  } Py_buffer;

  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)

#endif

#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
#endif

#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif

#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif

#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif

#if PY_VERSION_HEX < 0x02060000
  #define PyBytesObject                PyStringObject
  #define PyBytes_Type                 PyString_Type
  #define PyBytes_Check                PyString_Check
  #define PyBytes_CheckExact           PyString_CheckExact
  #define PyBytes_FromString           PyString_FromString
  #define PyBytes_FromStringAndSize    PyString_FromStringAndSize
  #define PyBytes_FromFormat           PyString_FromFormat
  #define PyBytes_DecodeEscape         PyString_DecodeEscape
  #define PyBytes_AsString             PyString_AsString
  #define PyBytes_AsStringAndSize      PyString_AsStringAndSize
  #define PyBytes_Size                 PyString_Size
  #define PyBytes_AS_STRING            PyString_AS_STRING
  #define PyBytes_GET_SIZE             PyString_GET_SIZE
  #define PyBytes_Repr                 PyString_Repr
  #define PyBytes_Concat               PyString_Concat
  #define PyBytes_ConcatAndDel         PyString_ConcatAndDel
#endif

#if PY_VERSION_HEX < 0x02060000
  #define PySet_Check(obj)             PyObject_TypeCheck(obj, &PySet_Type)
  #define PyFrozenSet_Check(obj)       PyObject_TypeCheck(obj, &PyFrozenSet_Type)
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif

#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)

#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
#endif

#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif

#if PY_VERSION_HEX < 0x03020000
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif


#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceDivide(x,y)
#endif

#if (PY_MAJOR_VERSION < 3) || (PY_VERSION_HEX >= 0x03010300)
  #define __Pyx_PySequence_GetSlice(obj, a, b) PySequence_GetSlice(obj, a, b)
  #define __Pyx_PySequence_SetSlice(obj, a, b, value) PySequence_SetSlice(obj, a, b, value)
  #define __Pyx_PySequence_DelSlice(obj, a, b) PySequence_DelSlice(obj, a, b)
#else
  #define __Pyx_PySequence_GetSlice(obj, a, b) (unlikely(!(obj)) ? \
        (PyErr_SetString(PyExc_SystemError, "null argument to internal routine"), (PyObject*)0) : \
        (likely((obj)->ob_type->tp_as_mapping) ? (PySequence_GetSlice(obj, a, b)) : \
            (PyErr_Format(PyExc_TypeError, "'%.200s' object is unsliceable", (obj)->ob_type->tp_name), (PyObject*)0)))
  #define __Pyx_PySequence_SetSlice(obj, a, b, value) (unlikely(!(obj)) ? \
        (PyErr_SetString(PyExc_SystemError, "null argument to internal routine"), -1) : \
        (likely((obj)->ob_type->tp_as_mapping) ? (PySequence_SetSlice(obj, a, b, value)) : \
            (PyErr_Format(PyExc_TypeError, "'%.200s' object doesn't support slice assignment", (obj)->ob_type->tp_name), -1)))
  #define __Pyx_PySequence_DelSlice(obj, a, b) (unlikely(!(obj)) ? \
        (PyErr_SetString(PyExc_SystemError, "null argument to internal routine"), -1) : \
        (likely((obj)->ob_type->tp_as_mapping) ? (PySequence_DelSlice(obj, a, b)) : \
            (PyErr_Format(PyExc_TypeError, "'%.200s' object doesn't support slice deletion", (obj)->ob_type->tp_name), -1)))
#endif

#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#endif

#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),((char *)(n)))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),((char *)(n)),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),((char *)(n)))
#else
  #define __Pyx_GetAttrString(o,n)   PyObject_GetAttrString((o),(n))
  #define __Pyx_SetAttrString(o,n,a) PyObject_SetAttrString((o),(n),(a))
  #define __Pyx_DelAttrString(o,n)   PyObject_DelAttrString((o),(n))
#endif

#if PY_VERSION_HEX < 0x02050000
  #define __Pyx_NAMESTR(n) ((char *)(n))
  #define __Pyx_DOCSTR(n)  ((char *)(n))
#else
  #define __Pyx_NAMESTR(n) (n)
  #define __Pyx_DOCSTR(n)  (n)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
#define _USE_MATH_DEFINES
#endif
#include <math.h>
#define __PYX_HAVE__opencl__cl_mem
#define __PYX_HAVE_API__opencl__cl_mem
#include "cl_header.h"
#include "stdlib.h"
#include "string.h"
#include "stdio.h"
#include "pythread.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif


/* inline attribute */
#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif

/* unused attribute */
#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || defined(__INTEL_COMPILER)
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif

typedef struct {PyObject **p; char *s; const long n; const char* encoding; const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry; /*proto*/


/* Type Conversion Predeclarations */

#define __Pyx_PyBytes_FromUString(s) PyBytes_FromString((char*)s)
#define __Pyx_PyBytes_AsUString(s)   ((unsigned char*) PyBytes_AsString(s))

#define __Pyx_Owned_Py_None(b) (Py_INCREF(Py_None), Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x);

static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
static CYTHON_INLINE size_t __Pyx_PyInt_AsSize_t(PyObject*);

#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))


#ifdef __GNUC__
  /* Test for GCC > 2.95 */
  #if __GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95))
    #define likely(x)   __builtin_expect(!!(x), 1)
    #define unlikely(x) __builtin_expect(!!(x), 0)
  #else /* __GNUC__ > 2 ... */
    #define likely(x)   (x)
    #define unlikely(x) (x)
  #endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */
    
static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;


static const char *__pyx_f[] = {
  "cl_mem.pyx",
  "bool.pxd",
  "complex.pxd",
};

static PyObject *__Pyx_Generator_Next(PyObject *self);
static PyObject *__Pyx_Generator_Send(PyObject *self, PyObject *value);
static PyObject *__Pyx_Generator_Close(PyObject *self);
static PyObject *__Pyx_Generator_Throw(PyObject *gen, PyObject *args, CYTHON_UNUSED PyObject *kwds);

typedef PyObject *(*__pyx_generator_body_t)(PyObject *, PyObject *);

/*--- Type declarations ---*/
struct __pyx_obj_6opencl_6cl_mem_ImageFormat;
struct __pyx_Generator_object;
struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr;
struct __pyx_obj_6opencl_6cl_mem_MemoryObject;
struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView;
struct __pyx_obj_6opencl_6cl_mem_UserData;
struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy;
struct __pyx_obj_6opencl_6cl_mem_Image;

/* "opencl/cl_mem.pyx":790
 * 
 * 
 * cdef class ImageFormat:             # <<<<<<<<<<<<<<
 *     '''
 *     '''
 */
struct __pyx_obj_6opencl_6cl_mem_ImageFormat {
  PyObject_HEAD
  cl_image_format cl_format;
};


/* "opencl/cl_mem.pyx":603
 *             queue.enqueue_copy_buffer(self, dest, src_offset=offset, dst_offset=0, size=self.nbytes, wait_on=())
 * 
 *         elif any(stride < 0 for stride in self.strides):             # <<<<<<<<<<<<<<
 *             raise NotImplementedError("stride < 0")
 * 
 */
struct __pyx_Generator_object {
  PyObject_HEAD
  __pyx_generator_body_t body;
  int is_running;
  int resume_label;
  PyObject *exc_type;
  PyObject *exc_value;
  PyObject *exc_traceback;
};

struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr {
  struct __pyx_Generator_object __pyx_base;
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *__pyx_outer_scope;
  PyObject *__pyx_v_stride;
  PyObject *__pyx_t_0;
  Py_ssize_t __pyx_t_1;
  PyObject *(*__pyx_t_2)(PyObject *);
};


/* "opencl/cl_mem.pyx":60
 *     return
 * 
 * cdef class MemoryObject:             # <<<<<<<<<<<<<<
 *     '''
 *     Memory objects are categorized into two types: buffer objects, and image objects.  A buffer
 */
struct __pyx_obj_6opencl_6cl_mem_MemoryObject {
  PyObject_HEAD
  struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject *__pyx_vtab;
  cl_mem buffer_id;
};


/* "opencl/cl_mem.pyx":247
 *     pass
 * 
 * cdef class DeviceMemoryView(MemoryObject):             # <<<<<<<<<<<<<<
 *     '''
 *     A buffer object stores a one-dimensional collection of elements.  Elements of a buffer object can
 */
struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView {
  struct __pyx_obj_6opencl_6cl_mem_MemoryObject __pyx_base;
  Py_buffer *buffer;
  PyObject *__weakref__;
  PyObject *_host_pointer;
  PyObject *_ctype;
};


/* "opencl/cl_mem.pyx":34
 * 
 * 
 * cdef class UserData:             # <<<<<<<<<<<<<<
 *     cdef object function
 *     cdef object args
 */
struct __pyx_obj_6opencl_6cl_mem_UserData {
  PyObject_HEAD
  PyObject *function;
  PyObject *args;
  PyObject *kwargs;
};


/* "opencl/cl_mem.pyx":588
 *             return self.strides == tuple(strides[::-1])
 * 
 *     def copy(self, queue):             # <<<<<<<<<<<<<<
 *         '''
 *         Copy this buffer into a new object
 */
struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy {
  PyObject_HEAD
  PyObject *__pyx_v_self;
};


/* "opencl/cl_mem.pyx":983
 * 
 * 
 * cdef class Image(MemoryObject):             # <<<<<<<<<<<<<<
 *     cdef Py_buffer * buffer
 *     cdef object __weakref__
 */
struct __pyx_obj_6opencl_6cl_mem_Image {
  struct __pyx_obj_6opencl_6cl_mem_MemoryObject __pyx_base;
  Py_buffer *buffer;
  PyObject *__weakref__;
};



/* "opencl/cl_mem.pyx":60
 *     return
 * 
 * cdef class MemoryObject:             # <<<<<<<<<<<<<<
 *     '''
 *     Memory objects are categorized into two types: buffer objects, and image objects.  A buffer
 */

struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject {
  cl_mem (*_get_base)(struct __pyx_obj_6opencl_6cl_mem_MemoryObject *);
};
static struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject *__pyx_vtabptr_6opencl_6cl_mem_MemoryObject;


/* "opencl/cl_mem.pyx":983
 * 
 * 
 * cdef class Image(MemoryObject):             # <<<<<<<<<<<<<<
 *     cdef Py_buffer * buffer
 *     cdef object __weakref__
 */

struct __pyx_vtabstruct_6opencl_6cl_mem_Image {
  struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject __pyx_base;
};
static struct __pyx_vtabstruct_6opencl_6cl_mem_Image *__pyx_vtabptr_6opencl_6cl_mem_Image;


/* "opencl/cl_mem.pyx":247
 *     pass
 * 
 * cdef class DeviceMemoryView(MemoryObject):             # <<<<<<<<<<<<<<
 *     '''
 *     A buffer object stores a one-dimensional collection of elements.  Elements of a buffer object can
 */

struct __pyx_vtabstruct_6opencl_6cl_mem_DeviceMemoryView {
  struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject __pyx_base;
};
static struct __pyx_vtabstruct_6opencl_6cl_mem_DeviceMemoryView *__pyx_vtabptr_6opencl_6cl_mem_DeviceMemoryView;

#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif

#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname); /*proto*/
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
  #define __Pyx_RefNannySetupContext(name)           __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
  #define __Pyx_RefNannyFinishContext()           __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif /* CYTHON_REFNANNY */

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

#ifndef __PYX_FORCE_INIT_THREADS
  #if PY_VERSION_HEX < 0x02040200
    #define __PYX_FORCE_INIT_THREADS 1
  #else
    #define __PYX_FORCE_INIT_THREADS 0
  #endif
#endif

static PyObject* __Pyx_PyEval_CallObjectWithKeywords(PyObject*, PyObject*, PyObject*); /*proto*/

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found); /*proto*/

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict,
    const char* function_name, int kw_allowed); /*proto*/

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name, PyObject* kw_name); /*proto*/

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,     const char* function_name); /*proto*/

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause); /*proto*/

#define __Pyx_SetItemInt(o, i, v, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_SetItemInt_Fast(o, i, v) : \
                                                    __Pyx_SetItemInt_Generic(o, to_py_func(i), v))

static CYTHON_INLINE int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
    int r;
    if (!j) return -1;
    r = PyObject_SetItem(o, j, v);
    Py_DECREF(j);
    return r;
}

static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v) {
    if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        Py_INCREF(v);
        Py_DECREF(PyList_GET_ITEM(o, i));
        PyList_SET_ITEM(o, i, v);
        return 1;
    }
    else if (Py_TYPE(o)->tp_as_sequence && Py_TYPE(o)->tp_as_sequence->sq_ass_item && (likely(i >= 0)))
        return PySequence_SetItem(o, i, v);
    else {
        PyObject *j = PyInt_FromSsize_t(i);
        return __Pyx_SetItemInt_Generic(o, j, v);
    }
}

#include <string.h>

static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected); /*proto*/

static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname);


static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}


#define __Pyx_GetItemInt_List(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_List_Fast(o, i) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i) {
    if (likely(o != Py_None)) {
        if (likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
            PyObject *r = PyList_GET_ITEM(o, i);
            Py_INCREF(r);
            return r;
        }
        else if ((-PyList_GET_SIZE(o) <= i) & (i < 0)) {
            PyObject *r = PyList_GET_ITEM(o, PyList_GET_SIZE(o) + i);
            Py_INCREF(r);
            return r;
        }
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

#define __Pyx_GetItemInt_Tuple(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Tuple_Fast(o, i) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i) {
    if (likely(o != Py_None)) {
        if (likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, i);
            Py_INCREF(r);
            return r;
        }
        else if ((-PyTuple_GET_SIZE(o) <= i) & (i < 0)) {
            PyObject *r = PyTuple_GET_ITEM(o, PyTuple_GET_SIZE(o) + i);
            Py_INCREF(r);
            return r;
        }
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}


#define __Pyx_GetItemInt(o, i, size, to_py_func) (((size) <= sizeof(Py_ssize_t)) ? \
                                                    __Pyx_GetItemInt_Fast(o, i) : \
                                                    __Pyx_GetItemInt_Generic(o, to_py_func(i)))

static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i) {
    PyObject *r;
    if (PyList_CheckExact(o) && ((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
    }
    else if (PyTuple_CheckExact(o) && ((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
    }
    else if (Py_TYPE(o)->tp_as_sequence && Py_TYPE(o)->tp_as_sequence->sq_item && (likely(i >= 0))) {
        r = PySequence_GetItem(o, i);
    }
    else {
        r = __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
    }
    return r;
}

static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname);

static double __Pyx__PyObject_AsDouble(PyObject* obj); /* proto */

#define __Pyx_PyObject_AsDouble(obj) \
    ((likely(PyFloat_CheckExact(obj))) ? \
     PyFloat_AS_DOUBLE(obj) : __Pyx__PyObject_AsDouble(obj))

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static CYTHON_INLINE PyObject* __Pyx_tp_new(PyObject* type_obj) {
    return (PyObject*) (((PyTypeObject*)(type_obj))->tp_new(
        (PyTypeObject*)(type_obj), __pyx_empty_tuple, NULL));
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact); /*proto*/

static CYTHON_INLINE void __Pyx_RaiseNoneIndexingError(void);

#if PY_MAJOR_VERSION >= 3
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
    PyObject *value;
    if (unlikely(d == Py_None)) {
        __Pyx_RaiseNoneIndexingError();
        return NULL;
    }
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (!PyErr_Occurred())
            PyErr_SetObject(PyExc_KeyError, key);
        return NULL;
    }
    Py_INCREF(value);
    return value;
}
#else
    #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#endif

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, long level); /*proto*/

#include "descrobject.h"
static PyObject* __Pyx_Method_ClassMethod(PyObject *method); /*proto*/

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_int32_t(int32_t);

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_uint32_t(uint32_t);

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_uint64_t(uint64_t);

static CYTHON_INLINE uint32_t __Pyx_PyInt_from_py_uint32_t(PyObject *);

static CYTHON_INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject *);

static CYTHON_INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject *);

static CYTHON_INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject *);

static CYTHON_INLINE char __Pyx_PyInt_AsChar(PyObject *);

static CYTHON_INLINE short __Pyx_PyInt_AsShort(PyObject *);

static CYTHON_INLINE int __Pyx_PyInt_AsInt(PyObject *);

static CYTHON_INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject *);

static CYTHON_INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject *);

static CYTHON_INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject *);

static CYTHON_INLINE int __Pyx_PyInt_AsLongDouble(PyObject *);

static CYTHON_INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject *);

static CYTHON_INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject *);

static CYTHON_INLINE long __Pyx_PyInt_AsLong(PyObject *);

static CYTHON_INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject *);

static CYTHON_INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject *);

static CYTHON_INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject *);

static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                  int lineno, const char *filename); /*proto*/

static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static int __Pyx_check_binary_version(void);

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig); /*proto*/

static int __Pyx_SetVtable(PyObject *dict, void *vtable); /*proto*/

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);  /*proto*/

static PyObject *__Pyx_ImportModule(const char *name); /*proto*/

static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig); /*proto*/

static void __Pyx_AddTraceback(const char *funcname, int __pyx_clineno,
                               int __pyx_lineno, const char *__pyx_filename); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

/* Module declarations from 'opencl._cl_platform' */

/* Module declarations from 'opencl._cl' */

/* Module declarations from 'libc.stdlib' */

/* Module declarations from 'libc.string' */

/* Module declarations from 'cpython.version' */

/* Module declarations from 'cpython.ref' */

/* Module declarations from 'cpython.exc' */

/* Module declarations from 'cpython.module' */

/* Module declarations from 'cpython.mem' */

/* Module declarations from 'cpython.tuple' */

/* Module declarations from 'cpython.list' */

/* Module declarations from 'libc.stdio' */

/* Module declarations from 'cpython.object' */

/* Module declarations from 'cpython.sequence' */

/* Module declarations from 'cpython.mapping' */

/* Module declarations from 'cpython.iterator' */

/* Module declarations from 'cpython.type' */

/* Module declarations from 'cpython.number' */

/* Module declarations from 'cpython.int' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.bool' */
static PyTypeObject *__pyx_ptype_7cpython_4bool_bool = 0;

/* Module declarations from 'cpython.long' */

/* Module declarations from 'cpython.float' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.complex' */
static PyTypeObject *__pyx_ptype_7cpython_7complex_complex = 0;

/* Module declarations from 'cpython.string' */

/* Module declarations from 'cpython.unicode' */

/* Module declarations from 'cpython.dict' */

/* Module declarations from 'cpython.instance' */

/* Module declarations from 'cpython.function' */

/* Module declarations from 'cpython.method' */

/* Module declarations from 'cpython.weakref' */

/* Module declarations from 'cpython.getargs' */

/* Module declarations from 'cpython.pythread' */

/* Module declarations from 'cpython.pystate' */

/* Module declarations from 'cpython.cobject' */

/* Module declarations from 'cpython.oldbuffer' */

/* Module declarations from 'cpython.set' */

/* Module declarations from 'cpython.buffer' */

/* Module declarations from 'cpython.bytes' */

/* Module declarations from 'cpython.pycapsule' */

/* Module declarations from 'cpython' */

/* Module declarations from 'opencl.context' */
static cl_context (*__pyx_f_6opencl_7context_CyContext_GetID)(PyObject *); /*proto*/
static PyObject *(*__pyx_f_6opencl_7context_CyContext_Create)(cl_context); /*proto*/
static int (*__pyx_f_6opencl_7context_CyContext_Check)(PyObject *); /*proto*/

/* Module declarations from 'opencl.cl_mem' */
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem_UserData = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem_MemoryObject = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem_ImageFormat = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem_Image = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem___pyx_scope_struct__copy = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem___pyx_Generator = 0;
static PyTypeObject *__pyx_ptype_6opencl_6cl_mem___pyx_scope_struct_1_genexpr = 0;
static PyObject *__pyx_f_6opencl_6cl_mem_CyMemoryObject_Create(cl_mem); /*proto*/
static int __pyx_f_6opencl_6cl_mem_CyView_GetBuffer(PyObject *, Py_buffer *); /*proto*/
static PyObject *__pyx_f_6opencl_6cl_mem_CyView_Create(cl_mem, Py_buffer *, PyObject *, int); /*proto*/
static int __pyx_f_6opencl_6cl_mem_CyMemoryObject_Check(PyObject *); /*proto*/
static cl_mem __pyx_f_6opencl_6cl_mem_CyMemoryObject_GetID(PyObject *); /*proto*/
static PyObject *__pyx_f_6opencl_6cl_mem_CyImageFormat_New(cl_image_format); /*proto*/
static PyObject *__pyx_f_6opencl_6cl_mem_CyImage_New(cl_mem); /*proto*/
static Py_buffer *__pyx_f_6opencl_6cl_mem_CyView_GetPyBuffer(PyObject *); /*proto*/
static int __pyx_f_6opencl_6cl_mem_CyImage_GetBuffer(PyObject *, Py_buffer *); /*proto*/
static void __pyx_f_6opencl_6cl_mem_pfn_notify_destroy_mem_object(cl_mem, struct __pyx_obj_6opencl_6cl_mem_UserData *); /*proto*/
static PyObject *__pyx_f_6opencl_6cl_mem_CyView_CreateSubclass(PyObject *, cl_mem, Py_buffer *, PyObject *, int); /*proto*/
static PyObject *__pyx_f_6opencl_6cl_mem_CyImage_Create(cl_mem, Py_buffer *, int); /*proto*/
static int __pyx_f_6opencl_6cl_mem_ImageFormat_Check(PyObject *); /*proto*/
static cl_image_format __pyx_f_6opencl_6cl_mem_ImageFormat_Get(PyObject *); /*proto*/
#define __Pyx_MODULE_NAME "opencl.cl_mem"
int __pyx_module_is_main_opencl__cl_mem = 0;

/* Implementation of 'opencl.cl_mem' */
static PyObject *__pyx_builtin_TypeError;
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_ValueError;
static PyObject *__pyx_builtin_Exception;
static PyObject *__pyx_builtin_enumerate;
static PyObject *__pyx_builtin_NotImplementedError;
static PyObject *__pyx_builtin_IndexError;
static PyObject *__pyx_builtin_any;
static PyObject *__pyx_builtin_NotImplemented;
static char __pyx_k_1[] = "Can not initialize 'DeviceMemoryView' directly use 'opencl.empty'";
static char __pyx_k_3[] = "total size of new array must be unchanged";
static char __pyx_k_5[] = "array must be contiguous to reshape";
static char __pyx_k_10[] = "opencl.queue";
static char __pyx_k_14[] = "argument 'context' must be a valid opencl.Context object";
static char __pyx_k_16[] = "at least one of arguments 'readable' or 'writable' must be true";
static char __pyx_k_18[] = "argument host must support the buffer protocol (got %r)";
static char __pyx_k_19[] = "data must be contiguous";
static char __pyx_k_21[] = "too many indices expected %i (got %i)";
static char __pyx_k_23[] = "stride < 0";
static char __pyx_k_26[] = "enqueue_copy_buffer_rect";
static char __pyx_k_28[] = "can only convert an array  of size 1 to a Python scalar";
static char __pyx_k_32[] = "enqueue_write_buffer";
static char __pyx_k_33[] = "can not create a new memory view from obj %r";
static char __pyx_k_38[] = "al least one of readable or wirteable must be True";
static char __pyx_k_40[] = "_CHANNEL_ORDER_CTYPE_MAP";
static char __pyx_k_41[] = "Could not create opencl image format from ctype format specifier (got %r)";
static char __pyx_k_42[] = "<ImageFormat channel_order=%r channel_data_type=%r>";
static char __pyx_k_45[] = "argument 'view' must be a valid opencl.DeviceMemoryView object";
static char __pyx_k_47[] = "ndim of arguement shape must be >= view.ndim";
static char __pyx_k_49[] = "Can not broadcast dim %i from %i to %i";
static char __pyx_k_51[] = "shape must be 2 or 3 dimentional (got ndim=%i)";
static char __pyx_k_52[] = "arguement 'image_format' must be a valid ImageFormat object";
static char __pyx_k_54[] = "CyImage_New takes a valid image object as an argument";
static char __pyx_k_56[] = "\n        Return the context that this object was created with. \n        ";
static char __pyx_k_57[] = "\n        return the enumed type of this object. \n        One of MemoryObject.BUFFER, MemoryObject.IMAGE2D or MemoryObject.IMAGE3D\n        ";
static char __pyx_k_58[] = "\n        Return the size in bytes of this memory object.\n        ";
static char __pyx_k_59[] = "\n        Return the OpenCL internal refrence count of this object. \n        ";
static char __pyx_k_60[] = "\n        Return the original memobject if this is a sub-buffer. \n        ";
static char __pyx_k_61[] = "offset from base buffer";
static char __pyx_k_62[] = "number of dimensions";
static char __pyx_k_63[] = "Is this memory writable";
static char __pyx_k_64[] = "size of each element";
static char __pyx_k_65[] = "ctype format of the elements";
static char __pyx_k_66[] = "Shape of the array";
static char __pyx_k_67[] = "Strides of the array";
static char __pyx_k_68[] = "Total number of elements";
static char __pyx_k_69[] = "Total number of bytes";
static char __pyx_k_70[] = "is this array C-contiguous";
static char __pyx_k_71[] = "opencl.type_formats";
static char __pyx_k_72[] = "opencl.errors";
static char __pyx_k_73[] = "opencl.cl_mem";
static char __pyx_k_74[] = "T{%(dtype)s:r:}";
static char __pyx_k_75[] = "T{%(dtype)s:i:}";
static char __pyx_k_76[] = "T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}";
static char __pyx_k_77[] = "T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:%(dtype)s:a:}";
static char __pyx_k_78[] = "T{%(dtype)s:a:%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}";
static char __pyx_k_79[] = "T{%(dtype)s:b:%(dtype)s:g:%(dtype)s:r:%(dtype)s:a:}";
static char __pyx_k__B[] = "B";
static char __pyx_k__H[] = "H";
static char __pyx_k__L[] = "L";
static char __pyx_k__b[] = "b";
static char __pyx_k__f[] = "f";
static char __pyx_k__h[] = "h";
static char __pyx_k__l[] = "l";
static char __pyx_k__any[] = "any";
static char __pyx_k__buf[] = "buf";
static char __pyx_k__mem[] = "mem";
static char __pyx_k__out[] = "out";
static char __pyx_k__sys[] = "sys";
static char __pyx_k__CL_A[] = "CL_A";
static char __pyx_k__CL_R[] = "CL_R";
static char __pyx_k__copy[] = "copy";
static char __pyx_k__host[] = "host";
static char __pyx_k__item[] = "item";
static char __pyx_k__read[] = "read";
static char __pyx_k__size[] = "size";
static char __pyx_k__type[] = "type";
static char __pyx_k__view[] = "view";
static char __pyx_k__CL_RA[] = "CL_RA";
static char __pyx_k__CL_RG[] = "CL_RG";
static char __pyx_k__CL_Rx[] = "CL_Rx";
static char __pyx_k__Queue[] = "Queue";
static char __pyx_k__array[] = "array";
static char __pyx_k__c_int[] = "c_int";
static char __pyx_k__ctype[] = "ctype";
static char __pyx_k__dtype[] = "dtype";
static char __pyx_k__empty[] = "empty";
static char __pyx_k__items[] = "items";
static char __pyx_k__major[] = "major";
static char __pyx_k__order[] = "order";
static char __pyx_k__queue[] = "queue";
static char __pyx_k__range[] = "range";
static char __pyx_k__shape[] = "shape";
static char __pyx_k__value[] = "value";
static char __pyx_k__BUFFER[] = "BUFFER";
static char __pyx_k__CL_RGB[] = "CL_RGB";
static char __pyx_k__CL_RGx[] = "CL_RGx";
static char __pyx_k__ctypes[] = "ctypes";
static char __pyx_k__encode[] = "encode";
static char __pyx_k__format[] = "format";
static char __pyx_k__nbytes[] = "nbytes";
static char __pyx_k__opencl[] = "opencl";
static char __pyx_k__struct[] = "struct";
static char __pyx_k__CL_ARGB[] = "CL_ARGB";
static char __pyx_k__CL_BGRA[] = "CL_BGRA";
static char __pyx_k__CL_RGBA[] = "CL_RGBA";
static char __pyx_k__CL_RGBx[] = "CL_RGBx";
static char __pyx_k__IMAGE2D[] = "IMAGE2D";
static char __pyx_k__IMAGE3D[] = "IMAGE3D";
static char __pyx_k____new__[] = "__new__";
static char __pyx_k__c_float[] = "c_float";
static char __pyx_k__context[] = "context";
static char __pyx_k__indices[] = "indices";
static char __pyx_k__offset_[] = "offset_";
static char __pyx_k__strides[] = "strides";
static char __pyx_k__unicode[] = "unicode";
static char __pyx_k__wait_on[] = "wait_on";
static char __pyx_k__weakref[] = "weakref";
static char __pyx_k__CL_FLOAT[] = "CL_FLOAT";
static char __pyx_k__ImageMap[] = "ImageMap";
static char __pyx_k____main__[] = "__main__";
static char __pyx_k____test__[] = "__test__";
static char __pyx_k__blocking[] = "blocking";
static char __pyx_k__c_void_p[] = "c_void_p";
static char __pyx_k__callback[] = "callback";
static char __pyx_k__cl_types[] = "cl_types";
static char __pyx_k__cl_uint8[] = "cl_uint8";
static char __pyx_k__itemsize[] = "itemsize";
static char __pyx_k__mem_size[] = "mem_size";
static char __pyx_k__readable[] = "readable";
static char __pyx_k__readonly[] = "readonly";
static char __pyx_k__Exception[] = "Exception";
static char __pyx_k__TypeError[] = "TypeError";
static char __pyx_k__broadcast[] = "broadcast";
static char __pyx_k__enumerate[] = "enumerate";
static char __pyx_k__from_host[] = "from_host";
static char __pyx_k__is_string[] = "is_string";
static char __pyx_k__wirteable[] = "wirteable";
static char __pyx_k__writeable[] = "writeable";
static char __pyx_k__IndexError[] = "IndexError";
static char __pyx_k__ValueError[] = "ValueError";
static char __pyx_k__dst_offset[] = "dst_offset";
static char __pyx_k__from_ctype[] = "from_ctype";
static char __pyx_k__mem_layout[] = "mem_layout";
static char __pyx_k__src_offset[] = "src_offset";
static char __pyx_k____builtin__[] = "__builtin__";
static char __pyx_k__empty_image[] = "empty_image";
static char __pyx_k__image_depth[] = "image_depth";
static char __pyx_k__image_width[] = "image_width";
static char __pyx_k__struct_name[] = "struct_name";
static char __pyx_k__type_format[] = "type_format";
static char __pyx_k__CL_INTENSITY[] = "CL_INTENSITY";
static char __pyx_k__CL_LUMINANCE[] = "CL_LUMINANCE";
static char __pyx_k__image_format[] = "image_format";
static char __pyx_k__image_height[] = "image_height";
static char __pyx_k__version_info[] = "version_info";
static char __pyx_k__CL_HALF_FLOAT[] = "CL_HALF_FLOAT";
static char __pyx_k__CL_SNORM_INT8[] = "CL_SNORM_INT8";
static char __pyx_k__CL_UNORM_INT8[] = "CL_UNORM_INT8";
static char __pyx_k__MemoryViewMap[] = "MemoryViewMap";
static char __pyx_k___host_pointer[] = "_host_pointer";
static char __pyx_k___view_as_this[] = "_view_as_this";
static char __pyx_k__blocking_read[] = "blocking_read";
static char __pyx_k__channel_order[] = "channel_order";
static char __pyx_k__is_contiguous[] = "is_contiguous";
static char __pyx_k__mock_callback[] = "mock_callback";
static char __pyx_k__CHANNEL_DTYPES[] = "CHANNEL_DTYPES";
static char __pyx_k__CHANNEL_ORDERS[] = "CHANNEL_ORDERS";
static char __pyx_k__CL_SIGNED_INT8[] = "CL_SIGNED_INT8";
static char __pyx_k__CL_SNORM_INT16[] = "CL_SNORM_INT16";
static char __pyx_k__CL_UNORM_INT16[] = "CL_UNORM_INT16";
static char __pyx_k__NotImplemented[] = "NotImplemented";
static char __pyx_k__CL_SIGNED_INT16[] = "CL_SIGNED_INT16";
static char __pyx_k__CL_SIGNED_INT32[] = "CL_SIGNED_INT32";
static char __pyx_k__OpenCLException[] = "OpenCLException";
static char __pyx_k__CL_UNSIGNED_INT8[] = "CL_UNSIGNED_INT8";
static char __pyx_k__size_from_format[] = "size_from_format";
static char __pyx_k__CL_UNSIGNED_INT16[] = "CL_UNSIGNED_INT16";
static char __pyx_k__CL_UNSIGNED_INT32[] = "CL_UNSIGNED_INT32";
static char __pyx_k__channel_data_type[] = "channel_data_type";
static char __pyx_k__ctype_from_format[] = "ctype_from_format";
static char __pyx_k__supported_formats[] = "supported_formats";
static char __pyx_k__CL_UNORM_SHORT_555[] = "CL_UNORM_SHORT_555";
static char __pyx_k__CL_UNORM_SHORT_565[] = "CL_UNORM_SHORT_565";
static char __pyx_k___CHANNEL_CTYPE_MAP[] = "_CHANNEL_CTYPE_MAP";
static char __pyx_k__CL_UNORM_INT_101010[] = "CL_UNORM_INT_101010";
static char __pyx_k__NotImplementedError[] = "NotImplementedError";
static char __pyx_k__enqueue_copy_buffer[] = "enqueue_copy_buffer";
static char __pyx_k__enqueue_read_buffer[] = "enqueue_read_buffer";
static PyObject *__pyx_kp_s_1;
static PyObject *__pyx_n_s_10;
static PyObject *__pyx_kp_s_14;
static PyObject *__pyx_kp_s_16;
static PyObject *__pyx_kp_s_18;
static PyObject *__pyx_kp_s_19;
static PyObject *__pyx_kp_s_21;
static PyObject *__pyx_kp_s_23;
static PyObject *__pyx_n_s_26;
static PyObject *__pyx_kp_s_28;
static PyObject *__pyx_kp_s_3;
static PyObject *__pyx_n_s_32;
static PyObject *__pyx_kp_s_33;
static PyObject *__pyx_kp_s_38;
static PyObject *__pyx_n_s_40;
static PyObject *__pyx_kp_s_41;
static PyObject *__pyx_kp_s_42;
static PyObject *__pyx_kp_s_45;
static PyObject *__pyx_kp_s_47;
static PyObject *__pyx_kp_s_49;
static PyObject *__pyx_kp_s_5;
static PyObject *__pyx_kp_s_51;
static PyObject *__pyx_kp_s_52;
static PyObject *__pyx_kp_s_54;
static PyObject *__pyx_n_s_71;
static PyObject *__pyx_n_s_72;
static PyObject *__pyx_n_s_73;
static PyObject *__pyx_kp_s_74;
static PyObject *__pyx_kp_s_75;
static PyObject *__pyx_kp_s_76;
static PyObject *__pyx_kp_s_77;
static PyObject *__pyx_kp_s_78;
static PyObject *__pyx_kp_s_79;
static PyObject *__pyx_n_s__B;
static PyObject *__pyx_n_s__BUFFER;
static PyObject *__pyx_n_s__CHANNEL_DTYPES;
static PyObject *__pyx_n_s__CHANNEL_ORDERS;
static PyObject *__pyx_n_s__CL_A;
static PyObject *__pyx_n_s__CL_ARGB;
static PyObject *__pyx_n_s__CL_BGRA;
static PyObject *__pyx_n_s__CL_FLOAT;
static PyObject *__pyx_n_s__CL_HALF_FLOAT;
static PyObject *__pyx_n_s__CL_INTENSITY;
static PyObject *__pyx_n_s__CL_LUMINANCE;
static PyObject *__pyx_n_s__CL_R;
static PyObject *__pyx_n_s__CL_RA;
static PyObject *__pyx_n_s__CL_RG;
static PyObject *__pyx_n_s__CL_RGB;
static PyObject *__pyx_n_s__CL_RGBA;
static PyObject *__pyx_n_s__CL_RGBx;
static PyObject *__pyx_n_s__CL_RGx;
static PyObject *__pyx_n_s__CL_Rx;
static PyObject *__pyx_n_s__CL_SIGNED_INT16;
static PyObject *__pyx_n_s__CL_SIGNED_INT32;
static PyObject *__pyx_n_s__CL_SIGNED_INT8;
static PyObject *__pyx_n_s__CL_SNORM_INT16;
static PyObject *__pyx_n_s__CL_SNORM_INT8;
static PyObject *__pyx_n_s__CL_UNORM_INT16;
static PyObject *__pyx_n_s__CL_UNORM_INT8;
static PyObject *__pyx_n_s__CL_UNORM_INT_101010;
static PyObject *__pyx_n_s__CL_UNORM_SHORT_555;
static PyObject *__pyx_n_s__CL_UNORM_SHORT_565;
static PyObject *__pyx_n_s__CL_UNSIGNED_INT16;
static PyObject *__pyx_n_s__CL_UNSIGNED_INT32;
static PyObject *__pyx_n_s__CL_UNSIGNED_INT8;
static PyObject *__pyx_n_s__Exception;
static PyObject *__pyx_n_s__H;
static PyObject *__pyx_n_s__IMAGE2D;
static PyObject *__pyx_n_s__IMAGE3D;
static PyObject *__pyx_n_s__ImageMap;
static PyObject *__pyx_n_s__IndexError;
static PyObject *__pyx_n_s__L;
static PyObject *__pyx_n_s__MemoryViewMap;
static PyObject *__pyx_n_s__NotImplemented;
static PyObject *__pyx_n_s__NotImplementedError;
static PyObject *__pyx_n_s__OpenCLException;
static PyObject *__pyx_n_s__Queue;
static PyObject *__pyx_n_s__TypeError;
static PyObject *__pyx_n_s__ValueError;
static PyObject *__pyx_n_s___CHANNEL_CTYPE_MAP;
static PyObject *__pyx_n_s____builtin__;
static PyObject *__pyx_n_s____main__;
static PyObject *__pyx_n_s____new__;
static PyObject *__pyx_n_s____test__;
static PyObject *__pyx_n_s___host_pointer;
static PyObject *__pyx_n_s___view_as_this;
static PyObject *__pyx_n_s__any;
static PyObject *__pyx_n_s__array;
static PyObject *__pyx_n_s__b;
static PyObject *__pyx_n_s__blocking;
static PyObject *__pyx_n_s__blocking_read;
static PyObject *__pyx_n_s__broadcast;
static PyObject *__pyx_n_s__buf;
static PyObject *__pyx_n_s__c_float;
static PyObject *__pyx_n_s__c_int;
static PyObject *__pyx_n_s__c_void_p;
static PyObject *__pyx_n_s__callback;
static PyObject *__pyx_n_s__channel_data_type;
static PyObject *__pyx_n_s__channel_order;
static PyObject *__pyx_n_s__cl_types;
static PyObject *__pyx_n_s__cl_uint8;
static PyObject *__pyx_n_s__context;
static PyObject *__pyx_n_s__copy;
static PyObject *__pyx_n_s__ctype;
static PyObject *__pyx_n_s__ctype_from_format;
static PyObject *__pyx_n_s__ctypes;
static PyObject *__pyx_n_s__dst_offset;
static PyObject *__pyx_n_s__dtype;
static PyObject *__pyx_n_s__empty;
static PyObject *__pyx_n_s__empty_image;
static PyObject *__pyx_n_s__encode;
static PyObject *__pyx_n_s__enqueue_copy_buffer;
static PyObject *__pyx_n_s__enqueue_read_buffer;
static PyObject *__pyx_n_s__enumerate;
static PyObject *__pyx_n_s__f;
static PyObject *__pyx_n_s__format;
static PyObject *__pyx_n_s__from_ctype;
static PyObject *__pyx_n_s__from_host;
static PyObject *__pyx_n_s__h;
static PyObject *__pyx_n_s__host;
static PyObject *__pyx_n_s__image_depth;
static PyObject *__pyx_n_s__image_format;
static PyObject *__pyx_n_s__image_height;
static PyObject *__pyx_n_s__image_width;
static PyObject *__pyx_n_s__indices;
static PyObject *__pyx_n_s__is_contiguous;
static PyObject *__pyx_n_s__is_string;
static PyObject *__pyx_n_s__item;
static PyObject *__pyx_n_s__items;
static PyObject *__pyx_n_s__itemsize;
static PyObject *__pyx_n_s__l;
static PyObject *__pyx_n_s__major;
static PyObject *__pyx_n_s__mem;
static PyObject *__pyx_n_s__mem_layout;
static PyObject *__pyx_n_s__mem_size;
static PyObject *__pyx_n_s__mock_callback;
static PyObject *__pyx_n_s__nbytes;
static PyObject *__pyx_n_s__offset_;
static PyObject *__pyx_n_s__opencl;
static PyObject *__pyx_n_s__order;
static PyObject *__pyx_n_s__out;
static PyObject *__pyx_n_s__queue;
static PyObject *__pyx_n_s__range;
static PyObject *__pyx_n_s__read;
static PyObject *__pyx_n_s__readable;
static PyObject *__pyx_n_s__readonly;
static PyObject *__pyx_n_s__shape;
static PyObject *__pyx_n_s__size;
static PyObject *__pyx_n_s__size_from_format;
static PyObject *__pyx_n_s__src_offset;
static PyObject *__pyx_n_s__strides;
static PyObject *__pyx_n_s__struct;
static PyObject *__pyx_n_s__struct_name;
static PyObject *__pyx_n_s__supported_formats;
static PyObject *__pyx_n_s__sys;
static PyObject *__pyx_n_s__type;
static PyObject *__pyx_n_s__type_format;
static PyObject *__pyx_n_s__unicode;
static PyObject *__pyx_n_s__value;
static PyObject *__pyx_n_s__version_info;
static PyObject *__pyx_n_s__view;
static PyObject *__pyx_n_s__wait_on;
static PyObject *__pyx_n_s__weakref;
static PyObject *__pyx_n_s__wirteable;
static PyObject *__pyx_n_s__writeable;
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_neg_1;
static PyObject *__pyx_k_7;
static PyObject *__pyx_k_8;
static PyObject *__pyx_k_9;
static PyObject *__pyx_k_11;
static PyObject *__pyx_k_12;
static PyObject *__pyx_k_13;
static PyObject *__pyx_k_30;
static PyObject *__pyx_k_31;
static PyObject *__pyx_k_35;
static PyObject *__pyx_k_36;
static PyObject *__pyx_k_43;
static PyObject *__pyx_k_44;
static PyObject *__pyx_k_tuple_2;
static PyObject *__pyx_k_tuple_4;
static PyObject *__pyx_k_tuple_6;
static PyObject *__pyx_k_slice_22;
static PyObject *__pyx_k_tuple_15;
static PyObject *__pyx_k_tuple_17;
static PyObject *__pyx_k_tuple_20;
static PyObject *__pyx_k_tuple_24;
static PyObject *__pyx_k_tuple_25;
static PyObject *__pyx_k_tuple_27;
static PyObject *__pyx_k_tuple_29;
static PyObject *__pyx_k_tuple_34;
static PyObject *__pyx_k_tuple_37;
static PyObject *__pyx_k_tuple_39;
static PyObject *__pyx_k_tuple_46;
static PyObject *__pyx_k_tuple_48;
static PyObject *__pyx_k_tuple_50;
static PyObject *__pyx_k_tuple_53;
static PyObject *__pyx_k_tuple_55;

/* "opencl/cl_mem.pyx":39
 *     cdef object kwargs
 * 
 * cdef void pfn_notify_destroy_mem_object(cl_mem memobj, UserData user_data) with gil:             # <<<<<<<<<<<<<<
 *     '''
 *     Callback for memory destructor.
 */

static void __pyx_f_6opencl_6cl_mem_pfn_notify_destroy_mem_object(cl_mem __pyx_v_memobj, struct __pyx_obj_6opencl_6cl_mem_UserData *__pyx_v_user_data) {
  PyObject *__pyx_v_mem = NULL;
  PyObject *__pyx_v_function = NULL;
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
  #endif
  __Pyx_RefNannySetupContext("pfn_notify_destroy_mem_object");
  __Pyx_INCREF((PyObject *)__pyx_v_user_data);

  /* "opencl/cl_mem.pyx":44
 *     '''
 * 
 *     mem = CyMemoryObject_Create(memobj)             # <<<<<<<<<<<<<<
 * 
 *     function = user_data.function
 */
  __pyx_t_1 = __pyx_f_6opencl_6cl_mem_CyMemoryObject_Create(__pyx_v_memobj); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 44; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_mem = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":46
 *     mem = CyMemoryObject_Create(memobj)
 * 
 *     function = user_data.function             # <<<<<<<<<<<<<<
 *     args = user_data.args
 *     kwargs = user_data.kwargs
 */
  __Pyx_INCREF(__pyx_v_user_data->function);
  __pyx_v_function = __pyx_v_user_data->function;

  /* "opencl/cl_mem.pyx":47
 * 
 *     function = user_data.function
 *     args = user_data.args             # <<<<<<<<<<<<<<
 *     kwargs = user_data.kwargs
 * 
 */
  __Pyx_INCREF(__pyx_v_user_data->args);
  __pyx_v_args = __pyx_v_user_data->args;

  /* "opencl/cl_mem.pyx":48
 *     function = user_data.function
 *     args = user_data.args
 *     kwargs = user_data.kwargs             # <<<<<<<<<<<<<<
 * 
 *     function(mem, *args, **kwargs)
 */
  __Pyx_INCREF(__pyx_v_user_data->kwargs);
  __pyx_v_kwargs = __pyx_v_user_data->kwargs;

  /* "opencl/cl_mem.pyx":50
 *     kwargs = user_data.kwargs
 * 
 *     function(mem, *args, **kwargs)             # <<<<<<<<<<<<<<
 * 
 *     user_data.function = None
 */
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_mem);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_mem);
  __Pyx_GIVEREF(__pyx_v_mem);
  __pyx_t_2 = PySequence_Tuple(__pyx_v_args); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyEval_CallObjectWithKeywords(__pyx_v_function, ((PyObject *)__pyx_t_3), __pyx_v_kwargs); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":52
 *     function(mem, *args, **kwargs)
 * 
 *     user_data.function = None             # <<<<<<<<<<<<<<
 *     user_data.args = None
 *     user_data.kwargs = None
 */
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_user_data->function);
  __Pyx_DECREF(__pyx_v_user_data->function);
  __pyx_v_user_data->function = Py_None;

  /* "opencl/cl_mem.pyx":53
 * 
 *     user_data.function = None
 *     user_data.args = None             # <<<<<<<<<<<<<<
 *     user_data.kwargs = None
 * 
 */
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_user_data->args);
  __Pyx_DECREF(__pyx_v_user_data->args);
  __pyx_v_user_data->args = Py_None;

  /* "opencl/cl_mem.pyx":54
 *     user_data.function = None
 *     user_data.args = None
 *     user_data.kwargs = None             # <<<<<<<<<<<<<<
 * 
 *     Py_DECREF(user_data)
 */
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(__pyx_v_user_data->kwargs);
  __Pyx_DECREF(__pyx_v_user_data->kwargs);
  __pyx_v_user_data->kwargs = Py_None;

  /* "opencl/cl_mem.pyx":56
 *     user_data.kwargs = None
 * 
 *     Py_DECREF(user_data)             # <<<<<<<<<<<<<<
 * 
 *     return
 */
  Py_DECREF(((PyObject *)__pyx_v_user_data));

  /* "opencl/cl_mem.pyx":58
 *     Py_DECREF(user_data)
 * 
 *     return             # <<<<<<<<<<<<<<
 * 
 * cdef class MemoryObject:
 */
  goto __pyx_L0;

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_WriteUnraisable("opencl.cl_mem.pfn_notify_destroy_mem_object", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_mem);
  __Pyx_XDECREF(__pyx_v_function);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF((PyObject *)__pyx_v_user_data);
  __Pyx_RefNannyFinishContext();
  #ifdef WITH_THREAD
  PyGILState_Release(__pyx_gilstate_save);
  #endif
}

/* "opencl/cl_mem.pyx":72
 *     cdef cl_mem buffer_id
 * 
 *     def get_buffer_id(self):             # <<<<<<<<<<<<<<
 *         '''
 *         Return the pointer to the opencl memory object.
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_get_buffer_id(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_12MemoryObject_get_buffer_id[] = "\n        Return the pointer to the opencl memory object. \n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_get_buffer_id(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("get_buffer_id");

  /* "opencl/cl_mem.pyx":76
 *         Return the pointer to the opencl memory object.
 *         '''
 *         return ctypes.c_void_p(< size_t > self.buffer_id)             # <<<<<<<<<<<<<<
 * 
 *     def __cinit__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__ctypes); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__c_void_p); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_FromSize_t(((size_t)((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.get_buffer_id", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":78
 *         return ctypes.c_void_p(< size_t > self.buffer_id)
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.buffer_id = NULL
 * 
 */

static int __pyx_pf_6opencl_6cl_mem_12MemoryObject_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_12MemoryObject_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "opencl/cl_mem.pyx":79
 * 
 *     def __cinit__(self):
 *         self.buffer_id = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id = NULL;

  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":81
 *         self.buffer_id = NULL
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         if self.buffer_id != NULL:
 *             clReleaseMemObject(self.buffer_id)
 */

static void __pyx_pf_6opencl_6cl_mem_12MemoryObject_2__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_6opencl_6cl_mem_12MemoryObject_2__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("__dealloc__");

  /* "opencl/cl_mem.pyx":82
 * 
 *     def __dealloc__(self):
 *         if self.buffer_id != NULL:             # <<<<<<<<<<<<<<
 *             clReleaseMemObject(self.buffer_id)
 *         self.buffer_id = NULL
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id != NULL);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":83
 *     def __dealloc__(self):
 *         if self.buffer_id != NULL:
 *             clReleaseMemObject(self.buffer_id)             # <<<<<<<<<<<<<<
 *         self.buffer_id = NULL
 * 
 */
    clReleaseMemObject(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id);
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":84
 *         if self.buffer_id != NULL:
 *             clReleaseMemObject(self.buffer_id)
 *         self.buffer_id = NULL             # <<<<<<<<<<<<<<
 * 
 * 
 */
  ((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id = NULL;

  __Pyx_RefNannyFinishContext();
}

/* "opencl/cl_mem.pyx":87
 * 
 * 
 *     def add_destructor_callback(self, callback, *args, **kwargs):             # <<<<<<<<<<<<<<
 *         '''
 *         memobj.add_destructor_callback(callback, *args, **kwargs)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_3add_destructor_callback(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_12MemoryObject_3add_destructor_callback[] = "\n        memobj.add_destructor_callback(callback, *args, **kwargs)\n        \n        Registers a user callback function with a memory object.  Each call to \n        `add_destructor_callback` registers the specified user callback function on a \n        callback stack associated with memobj.  \n        \n        The registered user callback functions are called in the \n        reverse order in which they were registered.  The user callback functions are called and then the \n        memory object's resources are freed and the memory object is deleted.  This provides a \n        mechanism for the application (and libraries) using memobj to be notified when the memory \n        referenced by host_ptr, specified when the memory object is created and used as the storage bits \n        for the memory object, can be reused or freed.\n        \n        :param callback: function with the signature callback(memobj, *args, **kwargs) \n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_3add_destructor_callback(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_callback = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  cl_int __pyx_v_err_code;
  struct __pyx_obj_6opencl_6cl_mem_UserData *__pyx_v_user_data = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__callback,0};
  __Pyx_RefNannySetupContext("add_destructor_callback");
  __pyx_v_kwargs = PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  __Pyx_GOTREF(__pyx_v_kwargs);
  if (PyTuple_GET_SIZE(__pyx_args) > 1) {
    __pyx_v_args = PyTuple_GetSlice(__pyx_args, 1, PyTuple_GET_SIZE(__pyx_args));
    if (unlikely(!__pyx_v_args)) {
      __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
      __Pyx_RefNannyFinishContext();
      return NULL;
    }
    __Pyx_GOTREF(__pyx_v_args);
  } else {
    __pyx_v_args = __pyx_empty_tuple; __Pyx_INCREF(__pyx_empty_tuple);
  }
  {
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        default:
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__callback);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args > 0)) {
        const Py_ssize_t used_pos_args = (PyTuple_GET_SIZE(__pyx_args) < 1) ? PyTuple_GET_SIZE(__pyx_args) : 1;
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, used_pos_args, "add_destructor_callback") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) < 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
    }
    __pyx_v_callback = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("add_destructor_callback", 0, 1, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_DECREF(__pyx_v_args); __pyx_v_args = 0;
  __Pyx_DECREF(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.add_destructor_callback", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":104
 *         :param callback: function with the signature callback(memobj, *args, **kwargs)
 *         '''
 *         Py_INCREF(callback)             # <<<<<<<<<<<<<<
 * 
 * #        cdef void * user_data = < void *> callback
 */
  Py_INCREF(__pyx_v_callback);

  /* "opencl/cl_mem.pyx":110
 *         cdef cl_int err_code
 * 
 *         cdef UserData user_data = UserData()             # <<<<<<<<<<<<<<
 *         user_data.function = callback
 *         user_data.args = args
 */
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6opencl_6cl_mem_UserData)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_user_data = ((struct __pyx_obj_6opencl_6cl_mem_UserData *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":111
 * 
 *         cdef UserData user_data = UserData()
 *         user_data.function = callback             # <<<<<<<<<<<<<<
 *         user_data.args = args
 *         user_data.kwargs = kwargs
 */
  __Pyx_INCREF(__pyx_v_callback);
  __Pyx_GIVEREF(__pyx_v_callback);
  __Pyx_GOTREF(__pyx_v_user_data->function);
  __Pyx_DECREF(__pyx_v_user_data->function);
  __pyx_v_user_data->function = __pyx_v_callback;

  /* "opencl/cl_mem.pyx":112
 *         cdef UserData user_data = UserData()
 *         user_data.function = callback
 *         user_data.args = args             # <<<<<<<<<<<<<<
 *         user_data.kwargs = kwargs
 * 
 */
  __Pyx_INCREF(((PyObject *)__pyx_v_args));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_args));
  __Pyx_GOTREF(__pyx_v_user_data->args);
  __Pyx_DECREF(__pyx_v_user_data->args);
  __pyx_v_user_data->args = ((PyObject *)__pyx_v_args);

  /* "opencl/cl_mem.pyx":113
 *         user_data.function = callback
 *         user_data.args = args
 *         user_data.kwargs = kwargs             # <<<<<<<<<<<<<<
 * 
 *         Py_INCREF(user_data)
 */
  __Pyx_INCREF(((PyObject *)__pyx_v_kwargs));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_kwargs));
  __Pyx_GOTREF(__pyx_v_user_data->kwargs);
  __Pyx_DECREF(__pyx_v_user_data->kwargs);
  __pyx_v_user_data->kwargs = ((PyObject *)__pyx_v_kwargs);

  /* "opencl/cl_mem.pyx":115
 *         user_data.kwargs = kwargs
 * 
 *         Py_INCREF(user_data)             # <<<<<<<<<<<<<<
 * 
 *         err_code = clSetMemObjectDestructorCallback(self.buffer_id, < void *> & pfn_notify_destroy_mem_object, < void *> user_data)
 */
  Py_INCREF(((PyObject *)__pyx_v_user_data));

  /* "opencl/cl_mem.pyx":117
 *         Py_INCREF(user_data)
 * 
 *         err_code = clSetMemObjectDestructorCallback(self.buffer_id, < void *> & pfn_notify_destroy_mem_object, < void *> user_data)             # <<<<<<<<<<<<<<
 * 
 *         if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clSetMemObjectDestructorCallback(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, ((void *)(&__pyx_f_6opencl_6cl_mem_pfn_notify_destroy_mem_object)), ((void *)__pyx_v_user_data));

  /* "opencl/cl_mem.pyx":119
 *         err_code = clSetMemObjectDestructorCallback(self.buffer_id, < void *> & pfn_notify_destroy_mem_object, < void *> user_data)
 * 
 *         if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *             raise OpenCLException(err_code)
 * 
 */
  __pyx_t_2 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_2) {

    /* "opencl/cl_mem.pyx":120
 * 
 *         if err_code != CL_SUCCESS:
 *             raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *     property context:
 */
    __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.add_destructor_callback", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XDECREF(__pyx_v_kwargs);
  __Pyx_XDECREF((PyObject *)__pyx_v_user_data);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":126
 *         Return the context that this object was created with.
 *         '''
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_context param_value
 *             cdef cl_int err_code
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_7context___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_7context___get__(PyObject *__pyx_v_self) {
  cl_context __pyx_v_param_value;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":131
 * 
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_CONTEXT, sizeof(size_t),
 *                                           < void *> & param_value, NULL)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetMemObjectInfo(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, CL_MEM_CONTEXT, (sizeof(size_t)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":133
 *                                           < void *> & param_value, NULL)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":134
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             return CyContext_Create(param_value)
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 134; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":136
 *                 raise OpenCLException(err_code)
 * 
 *             return CyContext_Create(param_value)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __pyx_f_6opencl_7context_CyContext_Create(__pyx_v_param_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.context.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":144
 *         One of MemoryObject.BUFFER, MemoryObject.IMAGE2D or MemoryObject.IMAGE3D
 *         '''
 *         def __get__(self):             # <<<<<<<<<<<<<<
 * 
 *             cdef cl_mem_object_type param_value
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_4type___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_4type___get__(PyObject *__pyx_v_self) {
  cl_mem_object_type __pyx_v_param_value;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":150
 * 
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_TYPE, sizeof(cl_mem_object_type),
 *                                           < void *> & param_value, NULL)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetMemObjectInfo(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, CL_MEM_TYPE, (sizeof(cl_mem_object_type)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":152
 *                                           < void *> & param_value, NULL)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":153
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             return param_value
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":155
 *                 raise OpenCLException(err_code)
 * 
 *             return param_value             # <<<<<<<<<<<<<<
 * 
 *     property mem_size:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_param_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.type.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":161
 *         Return the size in bytes of this memory object.
 *         '''
 *         def __get__(self):             # <<<<<<<<<<<<<<
 * 
 *             cdef size_t param_value
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_8mem_size___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_8mem_size___get__(PyObject *__pyx_v_self) {
  size_t __pyx_v_param_value;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":167
 * 
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_SIZE, sizeof(size_t),
 *                                           < void *> & param_value, NULL)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetMemObjectInfo(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, CL_MEM_SIZE, (sizeof(size_t)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":169
 *                                           < void *> & param_value, NULL)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":170
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             return param_value
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":172
 *                 raise OpenCLException(err_code)
 * 
 *             return param_value             # <<<<<<<<<<<<<<
 * 
 *     property _refcount:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_param_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.mem_size.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":178
 *         Return the OpenCL internal refrence count of this object.
 *         '''
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_uint param_value
 *             cdef cl_int err_code
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_9_refcount___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_9_refcount___get__(PyObject *__pyx_v_self) {
  cl_uint __pyx_v_param_value;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":182
 *             cdef cl_int err_code
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_REFERENCE_COUNT, sizeof(cl_uint),
 *                                            < void *>& param_value, NULL)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetMemObjectInfo(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, CL_MEM_REFERENCE_COUNT, (sizeof(cl_uint)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":184
 *                                            < void *>& param_value, NULL)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":185
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             return param_value
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 185; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":187
 *                 raise OpenCLException(err_code)
 * 
 *             return param_value             # <<<<<<<<<<<<<<
 * 
 *     property _mapcount:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_to_py_uint32_t(__pyx_v_param_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 187; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject._refcount.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":190
 * 
 *     property _mapcount:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 * 
 *             cdef cl_uint param_value
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_9_mapcount___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_9_mapcount___get__(PyObject *__pyx_v_self) {
  cl_uint __pyx_v_param_value;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":195
 *             cdef cl_int err_code
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_MAP_COUNT, sizeof(cl_uint),
 *                                           < void *>& param_value, NULL)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetMemObjectInfo(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, CL_MEM_MAP_COUNT, (sizeof(cl_uint)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":197
 *                                           < void *>& param_value, NULL)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":198
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             return param_value
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 198; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":200
 *                 raise OpenCLException(err_code)
 * 
 *             return param_value             # <<<<<<<<<<<<<<
 * 
 * #    property base_offset:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_to_py_uint32_t(__pyx_v_param_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject._mapcount.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":219
 * #            return param_value
 * 
 *     cdef cl_mem _get_base(self):             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem param_value
 */

static cl_mem __pyx_f_6opencl_6cl_mem_12MemoryObject__get_base(struct __pyx_obj_6opencl_6cl_mem_MemoryObject *__pyx_v_self) {
  cl_mem __pyx_v_param_value;
  cl_mem __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("_get_base");

  /* "opencl/cl_mem.pyx":222
 * 
 *         cdef cl_mem param_value
 *         clGetMemObjectInfo(self.buffer_id, CL_MEM_ASSOCIATED_MEMOBJECT, sizeof(cl_mem), < void *>& param_value, NULL)             # <<<<<<<<<<<<<<
 *         return param_value
 * 
 */
  clGetMemObjectInfo(__pyx_v_self->buffer_id, CL_MEM_ASSOCIATED_MEMOBJECT, (sizeof(cl_mem)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":223
 *         cdef cl_mem param_value
 *         clGetMemObjectInfo(self.buffer_id, CL_MEM_ASSOCIATED_MEMOBJECT, sizeof(cl_mem), < void *>& param_value, NULL)
 *         return param_value             # <<<<<<<<<<<<<<
 * 
 *     property base:
 */
  __pyx_r = __pyx_v_param_value;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":229
 *         Return the original memobject if this is a sub-buffer.
 *         '''
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_mem param_value
 *             cdef cl_int err_code
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_4base___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_12MemoryObject_4base___get__(PyObject *__pyx_v_self) {
  cl_mem __pyx_v_param_value;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":233
 *             cdef cl_int err_code
 * 
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_ASSOCIATED_MEMOBJECT, sizeof(cl_mem), < void *>& param_value, NULL)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetMemObjectInfo(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self)->buffer_id, CL_MEM_ASSOCIATED_MEMOBJECT, (sizeof(cl_mem)), ((void *)(&__pyx_v_param_value)), NULL);

  /* "opencl/cl_mem.pyx":235
 *             err_code = clGetMemObjectInfo(self.buffer_id, CL_MEM_ASSOCIATED_MEMOBJECT, sizeof(cl_mem), < void *>& param_value, NULL)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":236
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             if param_value == NULL:
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":238
 *                 raise OpenCLException(err_code)
 * 
 *             if param_value == NULL:             # <<<<<<<<<<<<<<
 *                 return None
 *             else:
 */
  __pyx_t_1 = (__pyx_v_param_value == NULL);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":239
 * 
 *             if param_value == NULL:
 *                 return None             # <<<<<<<<<<<<<<
 *             else:
 *                 return CyMemoryObject_Create(param_value)
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":241
 *                 return None
 *             else:
 *                 return CyMemoryObject_Create(param_value)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_3 = __pyx_f_6opencl_6cl_mem_CyMemoryObject_Create(__pyx_v_param_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.MemoryObject.base.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":244
 * 
 * 
 * def mock_callback(mem, array):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_mock_callback(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6opencl_6cl_mem_mock_callback = {__Pyx_NAMESTR("mock_callback"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_mock_callback, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)};
static PyObject *__pyx_pf_6opencl_6cl_mem_mock_callback(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_mem = 0;
  PyObject *__pyx_v_array = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__mem,&__pyx_n_s__array,0};
  __Pyx_RefNannySetupContext("mock_callback");
  __pyx_self = __pyx_self;
  {
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__mem);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__array);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("mock_callback", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "mock_callback") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_mem = values[0];
    __pyx_v_array = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("mock_callback", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.mock_callback", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":257
 *     cdef object _ctype
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.buffer = NULL
 * 
 */

static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "opencl/cl_mem.pyx":258
 * 
 *     def __cinit__(self):
 *         self.buffer = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer = NULL;

  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":260
 *         self.buffer = NULL
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         if self.buffer == NULL:
 *             return
 */

static void __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_1__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_1__dealloc__(PyObject *__pyx_v_self) {
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("__dealloc__");

  /* "opencl/cl_mem.pyx":261
 * 
 *     def __dealloc__(self):
 *         if self.buffer == NULL:             # <<<<<<<<<<<<<<
 *             return
 * 
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer == NULL);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":262
 *     def __dealloc__(self):
 *         if self.buffer == NULL:
 *             return             # <<<<<<<<<<<<<<
 * 
 * #        if self.buffer.format != NULL: free(self.buffer.format)
 */
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":265
 * 
 * #        if self.buffer.format != NULL: free(self.buffer.format)
 *         if self.buffer.shape != NULL: free(self.buffer.shape)             # <<<<<<<<<<<<<<
 *         if self.buffer.strides != NULL: free(self.buffer.strides)
 * 
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->shape != NULL);
  if (__pyx_t_1) {
    free(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->shape);
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":266
 * #        if self.buffer.format != NULL: free(self.buffer.format)
 *         if self.buffer.shape != NULL: free(self.buffer.shape)
 *         if self.buffer.strides != NULL: free(self.buffer.strides)             # <<<<<<<<<<<<<<
 * 
 *         free(self.buffer)
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->strides != NULL);
  if (__pyx_t_1) {
    free(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->strides);
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":268
 *         if self.buffer.strides != NULL: free(self.buffer.strides)
 * 
 *         free(self.buffer)             # <<<<<<<<<<<<<<
 * 
 *         self.buffer = NULL
 */
  free(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer);

  /* "opencl/cl_mem.pyx":270
 *         free(self.buffer)
 * 
 *         self.buffer = NULL             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self):
 */
  ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer = NULL;

  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
}

/* "opencl/cl_mem.pyx":272
 *         self.buffer = NULL
 * 
 *     def __init__(self):             # <<<<<<<<<<<<<<
 *         raise TypeError("Can not initialize 'DeviceMemoryView' directly use 'opencl.empty'")
 * 
 */

static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_2__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_2__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__init__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__init__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__init__", 0))) return -1;

  /* "opencl/cl_mem.pyx":273
 * 
 *     def __init__(self):
 *         raise TypeError("Can not initialize 'DeviceMemoryView' directly use 'opencl.empty'")             # <<<<<<<<<<<<<<
 * 
 *     property array_info:
 */
  __pyx_t_1 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_Raise(__pyx_t_1, 0, 0, 0);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":276
 * 
 *     property array_info:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             layout = mem_layout(0, 0, 0, self.size, 0, 0, 0, 0)
 *             cdef int i
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10array_info___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10array_info___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_layout = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  long __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":277
 *     property array_info:
 *         def __get__(self):
 *             layout = mem_layout(0, 0, 0, self.size, 0, 0, 0, 0)             # <<<<<<<<<<<<<<
 *             cdef int i
 *             for i in range(self.buffer.ndim):
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__mem_layout); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__size); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 4, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 5, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 6, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 7, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_v_layout = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":279
 *             layout = mem_layout(0, 0, 0, self.size, 0, 0, 0, 0)
 *             cdef int i
 *             for i in range(self.buffer.ndim):             # <<<<<<<<<<<<<<
 *                 layout[i] = self.buffer.shape[i]
 *                 layout[4 + i] = self.buffer.strides[i] // self.itemsize
 */
  __pyx_t_4 = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim;
  for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;

    /* "opencl/cl_mem.pyx":280
 *             cdef int i
 *             for i in range(self.buffer.ndim):
 *                 layout[i] = self.buffer.shape[i]             # <<<<<<<<<<<<<<
 *                 layout[4 + i] = self.buffer.strides[i] // self.itemsize
 * 
 */
    __pyx_t_2 = PyInt_FromSsize_t((((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->shape[__pyx_v_i])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    if (__Pyx_SetItemInt(__pyx_v_layout, __pyx_v_i, __pyx_t_2, sizeof(int), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

    /* "opencl/cl_mem.pyx":281
 *             for i in range(self.buffer.ndim):
 *                 layout[i] = self.buffer.shape[i]
 *                 layout[4 + i] = self.buffer.strides[i] // self.itemsize             # <<<<<<<<<<<<<<
 * 
 * #            if self.context.devices[0].driver_version == '1.0': #FIXME this should be better
 */
    __pyx_t_2 = PyInt_FromSsize_t((((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->strides[__pyx_v_i])); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__itemsize); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = PyNumber_FloorDivide(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = (4 + __pyx_v_i);
    if (__Pyx_SetItemInt(__pyx_v_layout, __pyx_t_6, __pyx_t_1, sizeof(long), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 281; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "opencl/cl_mem.pyx":284
 * 
 * #            if self.context.devices[0].driver_version == '1.0': #FIXME this should be better
 *             layout[7] = self.offset_ // self.itemsize             # <<<<<<<<<<<<<<
 * 
 *             return layout
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__offset_); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__itemsize); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyNumber_FloorDivide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (__Pyx_SetItemInt(__pyx_v_layout, 7, __pyx_t_2, sizeof(long), PyInt_FromLong) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":286
 *             layout[7] = self.offset_ // self.itemsize
 * 
 *             return layout             # <<<<<<<<<<<<<<
 * 
 *     property offset_:
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_layout);
  __pyx_r = __pyx_v_layout;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.array_info.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_layout);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":290
 *     property offset_:
 *         'offset from base buffer'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return < size_t > self.buffer.buf
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7offset____get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7offset____get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":291
 *         'offset from base buffer'
 *         def __get__(self):
 *             return < size_t > self.buffer.buf             # <<<<<<<<<<<<<<
 * 
 *     property ndim:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_FromSize_t(((size_t)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->buf)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 291; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.offset_.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":295
 *     property ndim:
 *         'number of dimensions'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.buffer.ndim
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4ndim___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4ndim___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":296
 *         'number of dimensions'
 *         def __get__(self):
 *             return self.buffer.ndim             # <<<<<<<<<<<<<<
 * 
 *     property readonly:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 296; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.ndim.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":300
 *     property readonly:
 *         'Is this memory writable'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.buffer.readonly
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8readonly___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8readonly___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":301
 *         'Is this memory writable'
 *         def __get__(self):
 *             return self.buffer.readonly             # <<<<<<<<<<<<<<
 * 
 *     property itemsize:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyBool_FromLong(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->readonly); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.readonly.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":305
 *     property itemsize:
 *         'size of each element'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.buffer.itemsize
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8itemsize___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8itemsize___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":306
 *         'size of each element'
 *         def __get__(self):
 *             return self.buffer.itemsize             # <<<<<<<<<<<<<<
 * 
 *     property format:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyInt_FromSsize_t(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->itemsize); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.itemsize.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":310
 *     property format:
 *         'ctype format of the elements'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             if self.buffer.format != NULL:
 *                 return self.buffer.format.decode('UTF-8')
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6format___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6format___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  char *__pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":311
 *         'ctype format of the elements'
 *         def __get__(self):
 *             if self.buffer.format != NULL:             # <<<<<<<<<<<<<<
 *                 return self.buffer.format.decode('UTF-8')
 *             else:
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->format != NULL);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":312
 *         def __get__(self):
 *             if self.buffer.format != NULL:
 *                 return self.buffer.format.decode('UTF-8')             # <<<<<<<<<<<<<<
 *             else:
 *                 return "B"
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->format;
    __pyx_t_3 = ((PyObject *)PyUnicode_DecodeUTF8(__pyx_t_2, strlen(__pyx_t_2), NULL)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(((PyObject *)__pyx_t_3));
    __pyx_r = ((PyObject *)__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":314
 *                 return self.buffer.format.decode('UTF-8')
 *             else:
 *                 return "B"             # <<<<<<<<<<<<<<
 * 
 *     property shape:
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_n_s__B));
    __pyx_r = ((PyObject *)__pyx_n_s__B);
    goto __pyx_L0;
  }
  __pyx_L5:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.format.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":318
 *     property shape:
 *         'Shape of the array'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             shape = []
 *             for i in range(self.buffer.ndim):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5shape___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5shape___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_shape = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":319
 *         'Shape of the array'
 *         def __get__(self):
 *             shape = []             # <<<<<<<<<<<<<<
 *             for i in range(self.buffer.ndim):
 *                 shape.append(self.buffer.shape[i])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_shape = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":320
 *         def __get__(self):
 *             shape = []
 *             for i in range(self.buffer.ndim):             # <<<<<<<<<<<<<<
 *                 shape.append(self.buffer.shape[i])
 *             return tuple(shape)
 */
  __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;

    /* "opencl/cl_mem.pyx":321
 *             shape = []
 *             for i in range(self.buffer.ndim):
 *                 shape.append(self.buffer.shape[i])             # <<<<<<<<<<<<<<
 *             return tuple(shape)
 * 
 */
    if (unlikely(((PyObject *)__pyx_v_shape) == Py_None)) {
      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_1 = PyInt_FromSsize_t((((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->shape[__pyx_v_i])); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_Append(__pyx_v_shape, __pyx_t_1); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 321; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "opencl/cl_mem.pyx":322
 *             for i in range(self.buffer.ndim):
 *                 shape.append(self.buffer.shape[i])
 *             return tuple(shape)             # <<<<<<<<<<<<<<
 * 
 *     property strides:
 */
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(((PyObject *)__pyx_v_shape) == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
  }
  __pyx_t_1 = ((PyObject *)PyList_AsTuple(__pyx_v_shape)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.shape.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_shape);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":326
 *     property strides:
 *         'Strides of the array'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             strides = []
 *             for i in range(self.buffer.ndim):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7strides___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7strides___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_strides = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":327
 *         'Strides of the array'
 *         def __get__(self):
 *             strides = []             # <<<<<<<<<<<<<<
 *             for i in range(self.buffer.ndim):
 *                 strides.append(self.buffer.strides[i])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_strides = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":328
 *         def __get__(self):
 *             strides = []
 *             for i in range(self.buffer.ndim):             # <<<<<<<<<<<<<<
 *                 strides.append(self.buffer.strides[i])
 *             return tuple(strides)
 */
  __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;

    /* "opencl/cl_mem.pyx":329
 *             strides = []
 *             for i in range(self.buffer.ndim):
 *                 strides.append(self.buffer.strides[i])             # <<<<<<<<<<<<<<
 *             return tuple(strides)
 * 
 */
    if (unlikely(((PyObject *)__pyx_v_strides) == Py_None)) {
      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_1 = PyInt_FromSsize_t((((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->strides[__pyx_v_i])); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_Append(__pyx_v_strides, __pyx_t_1); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "opencl/cl_mem.pyx":330
 *             for i in range(self.buffer.ndim):
 *                 strides.append(self.buffer.strides[i])
 *             return tuple(strides)             # <<<<<<<<<<<<<<
 * 
 *     def reshape(self, shape):
 */
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(((PyObject *)__pyx_v_strides) == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
  }
  __pyx_t_1 = ((PyObject *)PyList_AsTuple(__pyx_v_strides)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.strides.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strides);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":332
 *             return tuple(strides)
 * 
 *     def reshape(self, shape):             # <<<<<<<<<<<<<<
 * 
 *         size = 1
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_3reshape(PyObject *__pyx_v_self, PyObject *__pyx_v_shape); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_3reshape(PyObject *__pyx_v_self, PyObject *__pyx_v_shape) {
  PyObject *__pyx_v_size = NULL;
  PyObject *__pyx_v_d = NULL;
  cl_mem __pyx_v_buffer_id;
  Py_buffer *__pyx_v_result_buffer;
  size_t __pyx_v_ndim;
  char *__pyx_v_fmt;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_item = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *(*__pyx_t_3)(PyObject *);
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  char *__pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  Py_ssize_t __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("reshape");

  /* "opencl/cl_mem.pyx":334
 *     def reshape(self, shape):
 * 
 *         size = 1             # <<<<<<<<<<<<<<
 *         for d in shape: size *= d
 * 
 */
  __Pyx_INCREF(__pyx_int_1);
  __pyx_v_size = __pyx_int_1;

  /* "opencl/cl_mem.pyx":335
 * 
 *         size = 1
 *         for d in shape: size *= d             # <<<<<<<<<<<<<<
 * 
 *         if size != self.size:
 */
  if (PyList_CheckExact(__pyx_v_shape) || PyTuple_CheckExact(__pyx_v_shape)) {
    __pyx_t_1 = __pyx_v_shape; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_shape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (PyList_CheckExact(__pyx_t_1)) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
      __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++;
    } else if (PyTuple_CheckExact(__pyx_t_1)) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
      __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_4); __pyx_t_2++;
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_4);
    }
    __Pyx_XDECREF(__pyx_v_d);
    __pyx_v_d = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_t_4 = PyNumber_InPlaceMultiply(__pyx_v_size, __pyx_v_d); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_v_size);
    __pyx_v_size = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":337
 *         for d in shape: size *= d
 * 
 *         if size != self.size:             # <<<<<<<<<<<<<<
 *             raise ValueError("total size of new array must be unchanged")
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyObject_RichCompare(__pyx_v_size, __pyx_t_1, Py_NE); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {

    /* "opencl/cl_mem.pyx":338
 * 
 *         if size != self.size:
 *             raise ValueError("total size of new array must be unchanged")             # <<<<<<<<<<<<<<
 * 
 *         if not self.is_contiguous:
 */
    __pyx_t_4 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_k_tuple_4), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":340
 *             raise ValueError("total size of new array must be unchanged")
 * 
 *         if not self.is_contiguous:             # <<<<<<<<<<<<<<
 *             raise Exception("array must be contiguous to reshape")
 * 
 */
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__is_contiguous); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = (!__pyx_t_5);
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":341
 * 
 *         if not self.is_contiguous:
 *             raise Exception("array must be contiguous to reshape")             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem buffer_id = self.buffer_id
 */
    __pyx_t_4 = PyObject_Call(__pyx_builtin_Exception, ((PyObject *)__pyx_k_tuple_6), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "opencl/cl_mem.pyx":343
 *             raise Exception("array must be contiguous to reshape")
 * 
 *         cdef cl_mem buffer_id = self.buffer_id             # <<<<<<<<<<<<<<
 * 
 *         cdef Py_buffer * result_buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 */
  __pyx_v_buffer_id = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->__pyx_base.buffer_id;

  /* "opencl/cl_mem.pyx":345
 *         cdef cl_mem buffer_id = self.buffer_id
 * 
 *         cdef Py_buffer * result_buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 * 
 *         result_buffer.buf = NULL
 */
  __pyx_v_result_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":347
 *         cdef Py_buffer * result_buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 * 
 *         result_buffer.buf = NULL             # <<<<<<<<<<<<<<
 *         cdef size_t ndim = len(shape)
 * 
 */
  __pyx_v_result_buffer->buf = NULL;

  /* "opencl/cl_mem.pyx":348
 * 
 *         result_buffer.buf = NULL
 *         cdef size_t ndim = len(shape)             # <<<<<<<<<<<<<<
 * 
 *         result_buffer.ndim = ndim
 */
  __pyx_t_2 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 348; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_ndim = __pyx_t_2;

  /* "opencl/cl_mem.pyx":350
 *         cdef size_t ndim = len(shape)
 * 
 *         result_buffer.ndim = ndim             # <<<<<<<<<<<<<<
 *         result_buffer.itemsize = self.itemsize
 * 
 */
  __pyx_v_result_buffer->ndim = __pyx_v_ndim;

  /* "opencl/cl_mem.pyx":351
 * 
 *         result_buffer.ndim = ndim
 *         result_buffer.itemsize = self.itemsize             # <<<<<<<<<<<<<<
 * 
 *         result_buffer.format = < char *> malloc(len(self.format) + 1)
 */
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__itemsize); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 351; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_result_buffer->itemsize = __pyx_t_2;

  /* "opencl/cl_mem.pyx":353
 *         result_buffer.itemsize = self.itemsize
 * 
 *         result_buffer.format = < char *> malloc(len(self.format) + 1)             # <<<<<<<<<<<<<<
 *         cdef char * fmt = self.format
 *         strcpy(result_buffer.format, fmt)
 */
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__format); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_2 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_2 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 353; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_result_buffer->format = ((char *)malloc((__pyx_t_2 + 1)));

  /* "opencl/cl_mem.pyx":354
 * 
 *         result_buffer.format = < char *> malloc(len(self.format) + 1)
 *         cdef char * fmt = self.format             # <<<<<<<<<<<<<<
 *         strcpy(result_buffer.format, fmt)
 * 
 */
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__format); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_7 = PyBytes_AsString(__pyx_t_4); if (unlikely((!__pyx_t_7) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 354; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_fmt = __pyx_t_7;

  /* "opencl/cl_mem.pyx":355
 *         result_buffer.format = < char *> malloc(len(self.format) + 1)
 *         cdef char * fmt = self.format
 *         strcpy(result_buffer.format, fmt)             # <<<<<<<<<<<<<<
 * 
 *         result_buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 */
  strcpy(__pyx_v_result_buffer->format, __pyx_v_fmt);

  /* "opencl/cl_mem.pyx":357
 *         strcpy(result_buffer.format, fmt)
 * 
 *         result_buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)             # <<<<<<<<<<<<<<
 *         result_buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 * 
 */
  __pyx_v_result_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_ndim)));

  /* "opencl/cl_mem.pyx":358
 * 
 *         result_buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 *         result_buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)             # <<<<<<<<<<<<<<
 * 
 *         for i, item in enumerate(shape):
 */
  __pyx_v_result_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_ndim)));

  /* "opencl/cl_mem.pyx":360
 *         result_buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 * 
 *         for i, item in enumerate(shape):             # <<<<<<<<<<<<<<
 *             result_buffer.shape[i] = item
 * 
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_t_4 = __pyx_int_0;
  if (PyList_CheckExact(__pyx_v_shape) || PyTuple_CheckExact(__pyx_v_shape)) {
    __pyx_t_1 = __pyx_v_shape; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_v_shape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  for (;;) {
    if (PyList_CheckExact(__pyx_t_1)) {
      if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
      __pyx_t_8 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_8); __pyx_t_2++;
    } else if (PyTuple_CheckExact(__pyx_t_1)) {
      if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
      __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_8); __pyx_t_2++;
    } else {
      __pyx_t_8 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_8)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF(__pyx_v_item);
    __pyx_v_item = __pyx_t_8;
    __pyx_t_8 = 0;
    __Pyx_INCREF(__pyx_t_4);
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_4;
    __pyx_t_8 = PyNumber_Add(__pyx_t_4, __pyx_int_1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_4);
    __pyx_t_4 = __pyx_t_8;
    __pyx_t_8 = 0;

    /* "opencl/cl_mem.pyx":361
 * 
 *         for i, item in enumerate(shape):
 *             result_buffer.shape[i] = item             # <<<<<<<<<<<<<<
 * 
 *         PyBuffer_FillContiguousStrides(result_buffer.ndim, result_buffer.shape, result_buffer.strides, result_buffer.itemsize, 'C')
 */
    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_v_item); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 361; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    (__pyx_v_result_buffer->shape[__pyx_t_10]) = __pyx_t_9;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "opencl/cl_mem.pyx":363
 *             result_buffer.shape[i] = item
 * 
 *         PyBuffer_FillContiguousStrides(result_buffer.ndim, result_buffer.shape, result_buffer.strides, result_buffer.itemsize, 'C')             # <<<<<<<<<<<<<<
 * 
 *         result_buffer.internal = NULL
 */
  PyBuffer_FillContiguousStrides(__pyx_v_result_buffer->ndim, __pyx_v_result_buffer->shape, __pyx_v_result_buffer->strides, __pyx_v_result_buffer->itemsize, 'C');

  /* "opencl/cl_mem.pyx":365
 *         PyBuffer_FillContiguousStrides(result_buffer.ndim, result_buffer.shape, result_buffer.strides, result_buffer.itemsize, 'C')
 * 
 *         result_buffer.internal = NULL             # <<<<<<<<<<<<<<
 *         result_buffer.suboffsets = NULL
 * 
 */
  __pyx_v_result_buffer->internal = NULL;

  /* "opencl/cl_mem.pyx":366
 * 
 *         result_buffer.internal = NULL
 *         result_buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *         return CyView_Create(buffer_id, result_buffer, self.ctype, 1)
 */
  __pyx_v_result_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":368
 *         result_buffer.suboffsets = NULL
 * 
 *         return CyView_Create(buffer_id, result_buffer, self.ctype, 1)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__ctype); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __pyx_f_6opencl_6cl_mem_CyView_Create(__pyx_v_buffer_id, __pyx_v_result_buffer, __pyx_t_4, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 368; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.reshape", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_size);
  __Pyx_XDECREF(__pyx_v_d);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_item);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":371
 * 
 * 
 *     def map(self, queue, blocking=True, readable=True, writeable=True):             # <<<<<<<<<<<<<<
 *         '''
 *         DeviceMemoryView.map(queue, blocking=True, readable=True, writeable=True)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4map(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_4map[] = "\n        DeviceMemoryView.map(queue, blocking=True, readable=True, writeable=True)\n        \n        enqueues a command to map a region of the buffer object given by buffer into the host address \n        space and returns a pointer to this mapped region.\n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4map(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_queue = 0;
  PyObject *__pyx_v_blocking = 0;
  PyObject *__pyx_v_readable = 0;
  PyObject *__pyx_v_writeable = 0;
  PyObject *__pyx_v_MemoryViewMap = NULL;
  cl_map_flags __pyx_v_flags;
  cl_bool __pyx_v_blocking_map;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  long __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__queue,&__pyx_n_s__blocking,&__pyx_n_s__readable,&__pyx_n_s__writeable,0};
  __Pyx_RefNannySetupContext("map");
  {
    PyObject* values[4] = {0,0,0,0};
    values[1] = __pyx_k_7;
    values[2] = __pyx_k_8;
    values[3] = __pyx_k_9;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__queue);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__blocking);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__readable);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__writeable);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "map") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_queue = values[0];
    __pyx_v_blocking = values[1];
    __pyx_v_readable = values[2];
    __pyx_v_writeable = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("map", 0, 1, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.map", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":379
 *         '''
 * 
 *         from opencl.queue import MemoryViewMap             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_map_flags flags = 0
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__MemoryViewMap));
  PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__MemoryViewMap));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__MemoryViewMap));
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s_10), ((PyObject *)__pyx_t_1), -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__MemoryViewMap); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 379; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_t_1);
  __pyx_v_MemoryViewMap = __pyx_t_1;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":381
 *         from opencl.queue import MemoryViewMap
 * 
 *         cdef cl_map_flags flags = 0             # <<<<<<<<<<<<<<
 * 
 *         if readable:
 */
  __pyx_v_flags = 0;

  /* "opencl/cl_mem.pyx":383
 *         cdef cl_map_flags flags = 0
 * 
 *         if readable:             # <<<<<<<<<<<<<<
 *             flags |= CL_MAP_READ
 *         if writeable:
 */
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_readable); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 383; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":384
 * 
 *         if readable:
 *             flags |= CL_MAP_READ             # <<<<<<<<<<<<<<
 *         if writeable:
 *             flags |= CL_MAP_WRITE
 */
    __pyx_v_flags = (__pyx_v_flags | CL_MAP_READ);
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":385
 *         if readable:
 *             flags |= CL_MAP_READ
 *         if writeable:             # <<<<<<<<<<<<<<
 *             flags |= CL_MAP_WRITE
 * 
 */
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_writeable); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 385; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":386
 *             flags |= CL_MAP_READ
 *         if writeable:
 *             flags |= CL_MAP_WRITE             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_bool blocking_map = 1 if blocking else 0
 */
    __pyx_v_flags = (__pyx_v_flags | CL_MAP_WRITE);
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":388
 *             flags |= CL_MAP_WRITE
 * 
 *         cdef cl_bool blocking_map = 1 if blocking else 0             # <<<<<<<<<<<<<<
 * 
 *         return MemoryViewMap(queue, self, blocking_map, flags)
 */
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_blocking); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 388; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_3) {
    __pyx_t_4 = 1;
  } else {
    __pyx_t_4 = 0;
  }
  __pyx_v_blocking_map = __pyx_t_4;

  /* "opencl/cl_mem.pyx":390
 *         cdef cl_bool blocking_map = 1 if blocking else 0
 * 
 *         return MemoryViewMap(queue, self, blocking_map, flags)             # <<<<<<<<<<<<<<
 * 
 *     @classmethod
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_to_py_uint32_t(__pyx_v_blocking_map); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyInt_to_py_uint64_t(__pyx_v_flags); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  __Pyx_INCREF(__pyx_v_queue);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_queue);
  __Pyx_GIVEREF(__pyx_v_queue);
  __Pyx_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_self);
  __Pyx_GIVEREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_v_MemoryViewMap, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 390; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.map", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_MemoryViewMap);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":393
 * 
 *     @classmethod
 *     def from_host(cls, context, host, copy=True, readable=True, writeable=True):             # <<<<<<<<<<<<<<
 *         '''
 *         DeviceMemoryView.from_host(context, host, copy=True, readable=True, writeable=True)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5from_host(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_5from_host[] = "\n        DeviceMemoryView.from_host(context, host, copy=True, readable=True, writeable=True)\n        \n        Create an OpenCL buffer from a Python memoryview object.\n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5from_host(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_context = 0;
  PyObject *__pyx_v_host = 0;
  PyObject *__pyx_v_copy = 0;
  PyObject *__pyx_v_readable = 0;
  PyObject *__pyx_v_writeable = 0;
  cl_context __pyx_v_ctx;
  Py_buffer __pyx_v_view;
  Py_buffer *__pyx_v_buffer;
  cl_mem __pyx_v_buffer_id;
  int __pyx_v_py_flags;
  cl_mem_flags __pyx_v_mem_flags;
  cl_int __pyx_v_err_code;
  char *__pyx_v_tmp;
  int __pyx_v_i;
  PyObject *__pyx_v_cy_buffer = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  size_t __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__context,&__pyx_n_s__host,&__pyx_n_s__copy,&__pyx_n_s__readable,&__pyx_n_s__writeable,0};
  __Pyx_RefNannySetupContext("from_host");
  {
    PyObject* values[5] = {0,0,0,0,0};
    values[2] = __pyx_k_11;
    values[3] = __pyx_k_12;
    values[4] = __pyx_k_13;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__context);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__host);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("from_host", 0, 2, 5, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__copy);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__readable);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__writeable);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "from_host") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_context = values[0];
    __pyx_v_host = values[1];
    __pyx_v_copy = values[2];
    __pyx_v_readable = values[3];
    __pyx_v_writeable = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("from_host", 0, 2, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.from_host", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF(__pyx_v_host);

  /* "opencl/cl_mem.pyx":399
 *         Create an OpenCL buffer from a Python memoryview object.
 *         '''
 *         if not CyContext_Check(context):             # <<<<<<<<<<<<<<
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 */
  __pyx_t_1 = (!__pyx_f_6opencl_7context_CyContext_Check(__pyx_v_context));
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":400
 *         '''
 *         if not CyContext_Check(context):
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *         if isinstance(host, int):
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_15), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":402
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 *         if isinstance(host, int):             # <<<<<<<<<<<<<<
 *             host = ctypes.c_int(host)
 *         elif isinstance(host, float):
 */
  __pyx_t_2 = ((PyObject *)((PyObject*)(&PyInt_Type)));
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_host, __pyx_t_2); 
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":403
 * 
 *         if isinstance(host, int):
 *             host = ctypes.c_int(host)             # <<<<<<<<<<<<<<
 *         elif isinstance(host, float):
 *             host = ctypes.c_float(host)
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__ctypes); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__c_int); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_v_host);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_host);
    __Pyx_GIVEREF(__pyx_v_host);
    __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_host);
    __pyx_v_host = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L7;
  }

  /* "opencl/cl_mem.pyx":404
 *         if isinstance(host, int):
 *             host = ctypes.c_int(host)
 *         elif isinstance(host, float):             # <<<<<<<<<<<<<<
 *             host = ctypes.c_float(host)
 * 
 */
  __pyx_t_4 = ((PyObject *)((PyObject*)(&PyFloat_Type)));
  __Pyx_INCREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_host, __pyx_t_4); 
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":405
 *             host = ctypes.c_int(host)
 *         elif isinstance(host, float):
 *             host = ctypes.c_float(host)             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_context ctx = CyContext_GetID(context)
 */
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__ctypes); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_2 = PyObject_GetAttr(__pyx_t_4, __pyx_n_s__c_float); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __Pyx_INCREF(__pyx_v_host);
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_host);
    __Pyx_GIVEREF(__pyx_v_host);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_host);
    __pyx_v_host = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":407
 *             host = ctypes.c_float(host)
 * 
 *         cdef cl_context ctx = CyContext_GetID(context)             # <<<<<<<<<<<<<<
 * 
 *         cdef Py_buffer view
 */
  __pyx_v_ctx = __pyx_f_6opencl_7context_CyContext_GetID(__pyx_v_context);

  /* "opencl/cl_mem.pyx":410
 * 
 *         cdef Py_buffer view
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 *         cdef cl_mem buffer_id = NULL
 * 
 */
  __pyx_v_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":411
 *         cdef Py_buffer view
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 *         cdef cl_mem buffer_id = NULL             # <<<<<<<<<<<<<<
 * 
 *         cdef int py_flags = PyBUF_SIMPLE | PyBUF_STRIDES | PyBUF_ND | PyBUF_FORMAT
 */
  __pyx_v_buffer_id = NULL;

  /* "opencl/cl_mem.pyx":413
 *         cdef cl_mem buffer_id = NULL
 * 
 *         cdef int py_flags = PyBUF_SIMPLE | PyBUF_STRIDES | PyBUF_ND | PyBUF_FORMAT             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem_flags mem_flags = 0
 */
  __pyx_v_py_flags = (((PyBUF_SIMPLE | PyBUF_STRIDES) | PyBUF_ND) | PyBUF_FORMAT);

  /* "opencl/cl_mem.pyx":415
 *         cdef int py_flags = PyBUF_SIMPLE | PyBUF_STRIDES | PyBUF_ND | PyBUF_FORMAT
 * 
 *         cdef cl_mem_flags mem_flags = 0             # <<<<<<<<<<<<<<
 *         if copy:
 *             mem_flags |= CL_MEM_COPY_HOST_PTR
 */
  __pyx_v_mem_flags = 0;

  /* "opencl/cl_mem.pyx":416
 * 
 *         cdef cl_mem_flags mem_flags = 0
 *         if copy:             # <<<<<<<<<<<<<<
 *             mem_flags |= CL_MEM_COPY_HOST_PTR
 *         else:
 */
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_copy); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 416; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":417
 *         cdef cl_mem_flags mem_flags = 0
 *         if copy:
 *             mem_flags |= CL_MEM_COPY_HOST_PTR             # <<<<<<<<<<<<<<
 *         else:
 *             mem_flags |= CL_MEM_USE_HOST_PTR
 */
    __pyx_v_mem_flags = (__pyx_v_mem_flags | CL_MEM_COPY_HOST_PTR);
    goto __pyx_L8;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":419
 *             mem_flags |= CL_MEM_COPY_HOST_PTR
 *         else:
 *             mem_flags |= CL_MEM_USE_HOST_PTR             # <<<<<<<<<<<<<<
 * 
 *         if readable and writeable:
 */
    __pyx_v_mem_flags = (__pyx_v_mem_flags | CL_MEM_USE_HOST_PTR);
  }
  __pyx_L8:;

  /* "opencl/cl_mem.pyx":421
 *             mem_flags |= CL_MEM_USE_HOST_PTR
 * 
 *         if readable and writeable:             # <<<<<<<<<<<<<<
 *             mem_flags |= CL_MEM_READ_WRITE
 *         elif readable:
 */
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_readable); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {
    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_writeable); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_6 = __pyx_t_5;
  } else {
    __pyx_t_6 = __pyx_t_1;
  }
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":422
 * 
 *         if readable and writeable:
 *             mem_flags |= CL_MEM_READ_WRITE             # <<<<<<<<<<<<<<
 *         elif readable:
 *             mem_flags |= CL_MEM_READ_ONLY
 */
    __pyx_v_mem_flags = (__pyx_v_mem_flags | CL_MEM_READ_WRITE);
    goto __pyx_L9;
  }

  /* "opencl/cl_mem.pyx":423
 *         if readable and writeable:
 *             mem_flags |= CL_MEM_READ_WRITE
 *         elif readable:             # <<<<<<<<<<<<<<
 *             mem_flags |= CL_MEM_READ_ONLY
 *         elif writeable:
 */
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_readable); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":424
 *             mem_flags |= CL_MEM_READ_WRITE
 *         elif readable:
 *             mem_flags |= CL_MEM_READ_ONLY             # <<<<<<<<<<<<<<
 *         elif writeable:
 *             mem_flags |= CL_MEM_WRITE_ONLY
 */
    __pyx_v_mem_flags = (__pyx_v_mem_flags | CL_MEM_READ_ONLY);
    goto __pyx_L9;
  }

  /* "opencl/cl_mem.pyx":425
 *         elif readable:
 *             mem_flags |= CL_MEM_READ_ONLY
 *         elif writeable:             # <<<<<<<<<<<<<<
 *             mem_flags |= CL_MEM_WRITE_ONLY
 *         else:
 */
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_writeable); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":426
 *             mem_flags |= CL_MEM_READ_ONLY
 *         elif writeable:
 *             mem_flags |= CL_MEM_WRITE_ONLY             # <<<<<<<<<<<<<<
 *         else:
 *             raise Exception("at least one of arguments 'readable' or 'writable' must be true")
 */
    __pyx_v_mem_flags = (__pyx_v_mem_flags | CL_MEM_WRITE_ONLY);
    goto __pyx_L9;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":428
 *             mem_flags |= CL_MEM_WRITE_ONLY
 *         else:
 *             raise Exception("at least one of arguments 'readable' or 'writable' must be true")             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_int err_code
 */
    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, ((PyObject *)__pyx_k_tuple_17), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L9:;

  /* "opencl/cl_mem.pyx":432
 *         cdef cl_int err_code
 *         cdef char * tmp
 *         if not PyObject_CheckBuffer(host):             # <<<<<<<<<<<<<<
 *             raise Exception("argument host must support the buffer protocol (got %r)" % host)
 * 
 */
  __pyx_t_6 = (!PyObject_CheckBuffer(__pyx_v_host));
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":433
 *         cdef char * tmp
 *         if not PyObject_CheckBuffer(host):
 *             raise Exception("argument host must support the buffer protocol (got %r)" % host)             # <<<<<<<<<<<<<<
 * 
 *         if PyObject_GetBuffer(host, & view, py_flags) < 0:
 */
    __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_18), __pyx_v_host); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L10;
  }
  __pyx_L10:;

  /* "opencl/cl_mem.pyx":435
 *             raise Exception("argument host must support the buffer protocol (got %r)" % host)
 * 
 *         if PyObject_GetBuffer(host, & view, py_flags) < 0:             # <<<<<<<<<<<<<<
 *             raise Exception("argument host must support the buffer protocol (got %r)" % host)
 * 
 */
  __pyx_t_6 = (PyObject_GetBuffer(__pyx_v_host, (&__pyx_v_view), __pyx_v_py_flags) < 0);
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":436
 * 
 *         if PyObject_GetBuffer(host, & view, py_flags) < 0:
 *             raise Exception("argument host must support the buffer protocol (got %r)" % host)             # <<<<<<<<<<<<<<
 * 
 *         if PyBuffer_IsContiguous(& view, 'C'):
 */
    __pyx_t_3 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_18), __pyx_v_host); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_t_3));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_3));
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_builtin_Exception, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 436; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "opencl/cl_mem.pyx":438
 *             raise Exception("argument host must support the buffer protocol (got %r)" % host)
 * 
 *         if PyBuffer_IsContiguous(& view, 'C'):             # <<<<<<<<<<<<<<
 * 
 *             buffer_id = clCreateBuffer(ctx, mem_flags, view.len, view.buf, & err_code)
 */
  __pyx_t_6 = PyBuffer_IsContiguous((&__pyx_v_view), 'C');
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":440
 *         if PyBuffer_IsContiguous(& view, 'C'):
 * 
 *             buffer_id = clCreateBuffer(ctx, mem_flags, view.len, view.buf, & err_code)             # <<<<<<<<<<<<<<
 * 
 *             PyBuffer_Release(& view)
 */
    __pyx_v_buffer_id = clCreateBuffer(__pyx_v_ctx, __pyx_v_mem_flags, __pyx_v_view.len, __pyx_v_view.buf, (&__pyx_v_err_code));

    /* "opencl/cl_mem.pyx":442
 *             buffer_id = clCreateBuffer(ctx, mem_flags, view.len, view.buf, & err_code)
 * 
 *             PyBuffer_Release(& view)             # <<<<<<<<<<<<<<
 * 
 *             if err_code != CL_SUCCESS:
 */
    PyBuffer_Release((&__pyx_v_view));

    /* "opencl/cl_mem.pyx":444
 *             PyBuffer_Release(& view)
 * 
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
    __pyx_t_6 = (__pyx_v_err_code != CL_SUCCESS);
    if (__pyx_t_6) {

      /* "opencl/cl_mem.pyx":445
 * 
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             tmp = < char *> view.format
 */
      __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_2));
      PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
      __Pyx_Raise(__pyx_t_4, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L13;
    }
    __pyx_L13:;

    /* "opencl/cl_mem.pyx":447
 *                 raise OpenCLException(err_code)
 * 
 *             tmp = < char *> view.format             # <<<<<<<<<<<<<<
 *             buffer.format = < char *> malloc(len(view.format) + 1)
 *             strcpy(buffer.format, view.format)
 */
    __pyx_v_tmp = ((char *)__pyx_v_view.format);

    /* "opencl/cl_mem.pyx":448
 * 
 *             tmp = < char *> view.format
 *             buffer.format = < char *> malloc(len(view.format) + 1)             # <<<<<<<<<<<<<<
 *             strcpy(buffer.format, view.format)
 *             buffer.readonly = 1
 */
    __pyx_t_7 = strlen(__pyx_v_view.format); 
    __pyx_v_buffer->format = ((char *)malloc((__pyx_t_7 + 1)));

    /* "opencl/cl_mem.pyx":449
 *             tmp = < char *> view.format
 *             buffer.format = < char *> malloc(len(view.format) + 1)
 *             strcpy(buffer.format, view.format)             # <<<<<<<<<<<<<<
 *             buffer.readonly = 1
 *             buffer.itemsize = view.itemsize
 */
    strcpy(__pyx_v_buffer->format, __pyx_v_view.format);

    /* "opencl/cl_mem.pyx":450
 *             buffer.format = < char *> malloc(len(view.format) + 1)
 *             strcpy(buffer.format, view.format)
 *             buffer.readonly = 1             # <<<<<<<<<<<<<<
 *             buffer.itemsize = view.itemsize
 *             buffer.ndim = view.ndim
 */
    __pyx_v_buffer->readonly = 1;

    /* "opencl/cl_mem.pyx":451
 *             strcpy(buffer.format, view.format)
 *             buffer.readonly = 1
 *             buffer.itemsize = view.itemsize             # <<<<<<<<<<<<<<
 *             buffer.ndim = view.ndim
 * 
 */
    __pyx_v_buffer->itemsize = __pyx_v_view.itemsize;

    /* "opencl/cl_mem.pyx":452
 *             buffer.readonly = 1
 *             buffer.itemsize = view.itemsize
 *             buffer.ndim = view.ndim             # <<<<<<<<<<<<<<
 * 
 *             buffer.buf = NULL
 */
    __pyx_v_buffer->ndim = __pyx_v_view.ndim;

    /* "opencl/cl_mem.pyx":454
 *             buffer.ndim = view.ndim
 * 
 *             buffer.buf = NULL             # <<<<<<<<<<<<<<
 *             buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)
 *             buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)
 */
    __pyx_v_buffer->buf = NULL;

    /* "opencl/cl_mem.pyx":455
 * 
 *             buffer.buf = NULL
 *             buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)             # <<<<<<<<<<<<<<
 *             buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)
 *             buffer.suboffsets = NULL
 */
    __pyx_v_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_view.ndim)));

    /* "opencl/cl_mem.pyx":456
 *             buffer.buf = NULL
 *             buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)
 *             buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)             # <<<<<<<<<<<<<<
 *             buffer.suboffsets = NULL
 * 
 */
    __pyx_v_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_view.ndim)));

    /* "opencl/cl_mem.pyx":457
 *             buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)
 *             buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * view.ndim)
 *             buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *             for i in range(view.ndim):
 */
    __pyx_v_buffer->suboffsets = NULL;

    /* "opencl/cl_mem.pyx":459
 *             buffer.suboffsets = NULL
 * 
 *             for i in range(view.ndim):             # <<<<<<<<<<<<<<
 *                 buffer.shape[i] = view.shape[i]
 *                 buffer.strides[i] = view.strides[i]
 */
    __pyx_t_8 = __pyx_v_view.ndim;
    for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
      __pyx_v_i = __pyx_t_9;

      /* "opencl/cl_mem.pyx":460
 * 
 *             for i in range(view.ndim):
 *                 buffer.shape[i] = view.shape[i]             # <<<<<<<<<<<<<<
 *                 buffer.strides[i] = view.strides[i]
 * 
 */
      (__pyx_v_buffer->shape[__pyx_v_i]) = (__pyx_v_view.shape[__pyx_v_i]);

      /* "opencl/cl_mem.pyx":461
 *             for i in range(view.ndim):
 *                 buffer.shape[i] = view.shape[i]
 *                 buffer.strides[i] = view.strides[i]             # <<<<<<<<<<<<<<
 * 
 *             cy_buffer = CyView_Create(buffer_id, buffer, None, 0)
 */
      (__pyx_v_buffer->strides[__pyx_v_i]) = (__pyx_v_view.strides[__pyx_v_i]);
    }

    /* "opencl/cl_mem.pyx":463
 *                 buffer.strides[i] = view.strides[i]
 * 
 *             cy_buffer = CyView_Create(buffer_id, buffer, None, 0)             # <<<<<<<<<<<<<<
 * #            cy_buffer._host_pointer = host
 * 
 */
    __pyx_t_4 = Py_None;
    __Pyx_INCREF(__pyx_t_4);
    __pyx_t_2 = __pyx_f_6opencl_6cl_mem_CyView_Create(__pyx_v_buffer_id, __pyx_v_buffer, __pyx_t_4, 0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_cy_buffer = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "opencl/cl_mem.pyx":466
 * #            cy_buffer._host_pointer = host
 * 
 *             if not copy:             # <<<<<<<<<<<<<<
 *                 # This will keep the referenced array around until we are done with
 *                 # the opencl memory
 */
    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_copy); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = (!__pyx_t_6);
    if (__pyx_t_1) {

      /* "opencl/cl_mem.pyx":473
 *                 #cy_buffer.add_destructor_callback(mock_callback, host)
 * 
 *                 cy_buffer._host_pointer = host             # <<<<<<<<<<<<<<
 * 
 *             return cy_buffer
 */
      if (PyObject_SetAttr(__pyx_v_cy_buffer, __pyx_n_s___host_pointer, __pyx_v_host) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      goto __pyx_L16;
    }
    __pyx_L16:;

    /* "opencl/cl_mem.pyx":475
 *                 cy_buffer._host_pointer = host
 * 
 *             return cy_buffer             # <<<<<<<<<<<<<<
 *         else:
 *             raise NotImplementedError("data must be contiguous")
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_cy_buffer);
    __pyx_r = __pyx_v_cy_buffer;
    goto __pyx_L0;
    goto __pyx_L12;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":477
 *             return cy_buffer
 *         else:
 *             raise NotImplementedError("data must be contiguous")             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_NotImplementedError, ((PyObject *)__pyx_k_tuple_20), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L12:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.from_host", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_cy_buffer);
  __Pyx_XDECREF(__pyx_v_host);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":480
 * 
 * 
 *     def __getitem__(self, args):             # <<<<<<<<<<<<<<
 * 
 *         if not isinstance(args, tuple):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_args); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6__getitem__(PyObject *__pyx_v_self, PyObject *__pyx_v_args) {
  PyObject *__pyx_v_ndim = NULL;
  PyObject *__pyx_v_shape = NULL;
  PyObject *__pyx_v_strides = NULL;
  size_t __pyx_v_offset;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_stop = NULL;
  PyObject *__pyx_v_step = NULL;
  PyObject *__pyx_v_modd = NULL;
  Py_buffer *__pyx_v_buffer;
  cl_mem __pyx_v_sub_buffer;
  cl_mem __pyx_v_base;
  size_t __pyx_v_mem_size;
  cl_buffer_region __pyx_v_buffer_create_info;
  PyObject *__pyx_v_new_view = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *__pyx_t_10 = NULL;
  PyObject *(*__pyx_t_11)(PyObject *);
  size_t __pyx_t_12;
  int __pyx_t_13;
  Py_ssize_t __pyx_t_14;
  Py_ssize_t __pyx_t_15;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__getitem__");
  __Pyx_INCREF(__pyx_v_args);

  /* "opencl/cl_mem.pyx":482
 *     def __getitem__(self, args):
 * 
 *         if not isinstance(args, tuple):             # <<<<<<<<<<<<<<
 *             args = (args,)
 * 
 */
  __pyx_t_1 = ((PyObject *)((PyObject*)(&PyTuple_Type)));
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_args, __pyx_t_1); 
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":483
 * 
 *         if not isinstance(args, tuple):
 *             args = (args,)             # <<<<<<<<<<<<<<
 * 
 *         if len(args) != self.buffer.ndim:
 */
    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __Pyx_INCREF(__pyx_v_args);
    PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_args);
    __Pyx_GIVEREF(__pyx_v_args);
    __Pyx_DECREF(__pyx_v_args);
    __pyx_v_args = ((PyObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":485
 *             args = (args,)
 * 
 *         if len(args) != self.buffer.ndim:             # <<<<<<<<<<<<<<
 *             raise IndexError("too many indices expected %i (got %i)" % (self.buffer.ndim, len(args)))
 * 
 */
  __pyx_t_4 = PyObject_Length(__pyx_v_args); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_3 = (__pyx_t_4 != ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":486
 * 
 *         if len(args) != self.buffer.ndim:
 *             raise IndexError("too many indices expected %i (got %i)" % (self.buffer.ndim, len(args)))             # <<<<<<<<<<<<<<
 * 
 *         ndim = self.buffer.ndim
 */
    __pyx_t_1 = PyInt_FromLong(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyObject_Length(__pyx_v_args); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    __pyx_t_5 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_21), ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_5));
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));
    PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_t_5));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_5));
    __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_Call(__pyx_builtin_IndexError, ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":488
 *             raise IndexError("too many indices expected %i (got %i)" % (self.buffer.ndim, len(args)))
 * 
 *         ndim = self.buffer.ndim             # <<<<<<<<<<<<<<
 *         shape = list(self.shape)
 *         strides = list(self.strides)
 */
  __pyx_t_5 = PyInt_FromLong(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_v_ndim = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":489
 * 
 *         ndim = self.buffer.ndim
 *         shape = list(self.shape)             # <<<<<<<<<<<<<<
 *         strides = list(self.strides)
 * 
 */
  __pyx_t_5 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__shape); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_6));
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_v_shape = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":490
 *         ndim = self.buffer.ndim
 *         shape = list(self.shape)
 *         strides = list(self.strides)             # <<<<<<<<<<<<<<
 * 
 *         cdef size_t offset = < size_t > self.buffer.buf
 */
  __pyx_t_5 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__strides); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_6));
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyObject_Call(((PyObject *)((PyObject*)(&PyList_Type))), ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_v_strides = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":492
 *         strides = list(self.strides)
 * 
 *         cdef size_t offset = < size_t > self.buffer.buf             # <<<<<<<<<<<<<<
 * 
 *         i = 0
 */
  __pyx_v_offset = ((size_t)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->buf);

  /* "opencl/cl_mem.pyx":494
 *         cdef size_t offset = < size_t > self.buffer.buf
 * 
 *         i = 0             # <<<<<<<<<<<<<<
 *         for arg in args:
 *             if isinstance(arg, slice):
 */
  __Pyx_INCREF(__pyx_int_0);
  __pyx_v_i = __pyx_int_0;

  /* "opencl/cl_mem.pyx":495
 * 
 *         i = 0
 *         for arg in args:             # <<<<<<<<<<<<<<
 *             if isinstance(arg, slice):
 *                 start, stop, step = arg.indices(shape[i])
 */
  if (PyList_CheckExact(__pyx_v_args) || PyTuple_CheckExact(__pyx_v_args)) {
    __pyx_t_5 = __pyx_v_args; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_v_args); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext;
  }
  for (;;) {
    if (PyList_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_6 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_6); __pyx_t_4++;
    } else {
      __pyx_t_6 = __pyx_t_7(__pyx_t_5);
      if (unlikely(!__pyx_t_6)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_6);
    }
    __Pyx_XDECREF(__pyx_v_arg);
    __pyx_v_arg = __pyx_t_6;
    __pyx_t_6 = 0;

    /* "opencl/cl_mem.pyx":496
 *         i = 0
 *         for arg in args:
 *             if isinstance(arg, slice):             # <<<<<<<<<<<<<<
 *                 start, stop, step = arg.indices(shape[i])
 *                 shape[i] = (stop - start) // step
 */
    __pyx_t_6 = ((PyObject *)((PyObject*)(&PySlice_Type)));
    __Pyx_INCREF(__pyx_t_6);
    __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg, __pyx_t_6); 
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_3) {

      /* "opencl/cl_mem.pyx":497
 *         for arg in args:
 *             if isinstance(arg, slice):
 *                 start, stop, step = arg.indices(shape[i])             # <<<<<<<<<<<<<<
 *                 shape[i] = (stop - start) // step
 *                 modd = (stop - start) % step
 */
      __pyx_t_6 = PyObject_GetAttr(__pyx_v_arg, __pyx_n_s__indices); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_1 = PyObject_GetItem(((PyObject *)__pyx_v_shape), __pyx_v_i); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_8));
      PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1);
      __Pyx_GIVEREF(__pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_Call(__pyx_t_6, ((PyObject *)__pyx_t_8), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
      if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        if (likely(PyTuple_CheckExact(sequence))) {
          if (unlikely(PyTuple_GET_SIZE(sequence) != 3)) {
            if (PyTuple_GET_SIZE(sequence) > 3) __Pyx_RaiseTooManyValuesError(3);
            else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          __pyx_t_8 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
          __pyx_t_9 = PyTuple_GET_ITEM(sequence, 2); 
        } else {
          if (unlikely(PyList_GET_SIZE(sequence) != 3)) {
            if (PyList_GET_SIZE(sequence) > 3) __Pyx_RaiseTooManyValuesError(3);
            else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          __pyx_t_8 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
          __pyx_t_9 = PyList_GET_ITEM(sequence, 2); 
        }
        __Pyx_INCREF(__pyx_t_8);
        __Pyx_INCREF(__pyx_t_6);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_10 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_10);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext;
        index = 0; __pyx_t_8 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L10_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_8);
        index = 1; __pyx_t_6 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_6)) goto __pyx_L10_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_6);
        index = 2; __pyx_t_9 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_9)) goto __pyx_L10_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_9);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L11_unpacking_done;
        __pyx_L10_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
        if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
        if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_L11_unpacking_done:;
      }
      __Pyx_XDECREF(__pyx_v_start);
      __pyx_v_start = __pyx_t_8;
      __pyx_t_8 = 0;
      __Pyx_XDECREF(__pyx_v_stop);
      __pyx_v_stop = __pyx_t_6;
      __pyx_t_6 = 0;
      __Pyx_XDECREF(__pyx_v_step);
      __pyx_v_step = __pyx_t_9;
      __pyx_t_9 = 0;

      /* "opencl/cl_mem.pyx":498
 *             if isinstance(arg, slice):
 *                 start, stop, step = arg.indices(shape[i])
 *                 shape[i] = (stop - start) // step             # <<<<<<<<<<<<<<
 *                 modd = (stop - start) % step
 *                 if modd != 0: shape[i] += 1
 */
      __pyx_t_1 = PyNumber_Subtract(__pyx_v_stop, __pyx_v_start); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_9 = PyNumber_FloorDivide(__pyx_t_1, __pyx_v_step); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (PyObject_SetItem(((PyObject *)__pyx_v_shape), __pyx_v_i, __pyx_t_9) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

      /* "opencl/cl_mem.pyx":499
 *                 start, stop, step = arg.indices(shape[i])
 *                 shape[i] = (stop - start) // step
 *                 modd = (stop - start) % step             # <<<<<<<<<<<<<<
 *                 if modd != 0: shape[i] += 1
 * 
 */
      __pyx_t_9 = PyNumber_Subtract(__pyx_v_stop, __pyx_v_start); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = PyNumber_Remainder(__pyx_t_9, __pyx_v_step); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __Pyx_XDECREF(__pyx_v_modd);
      __pyx_v_modd = __pyx_t_1;
      __pyx_t_1 = 0;

      /* "opencl/cl_mem.pyx":500
 *                 shape[i] = (stop - start) // step
 *                 modd = (stop - start) % step
 *                 if modd != 0: shape[i] += 1             # <<<<<<<<<<<<<<
 * 
 *                 offset += start * strides[i]
 */
      __pyx_t_1 = PyObject_RichCompare(__pyx_v_modd, __pyx_int_0, Py_NE); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_3) {
        __Pyx_INCREF(__pyx_v_i);
        __pyx_t_1 = __pyx_v_i;
        __pyx_t_9 = PyObject_GetItem(((PyObject *)__pyx_v_shape), __pyx_t_1); if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_t_9, __pyx_int_1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        if (PyObject_SetItem(((PyObject *)__pyx_v_shape), __pyx_t_1, __pyx_t_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L12;
      }
      __pyx_L12:;

      /* "opencl/cl_mem.pyx":502
 *                 if modd != 0: shape[i] += 1
 * 
 *                 offset += start * strides[i]             # <<<<<<<<<<<<<<
 *                 strides[i] = strides[i] * step
 * 
 */
      __pyx_t_1 = __Pyx_PyInt_FromSize_t(__pyx_v_offset); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_strides), __pyx_v_i); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_9 = PyNumber_Multiply(__pyx_v_start, __pyx_t_6); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_t_1, __pyx_t_9); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_12 = __Pyx_PyInt_AsSize_t(__pyx_t_6); if (unlikely((__pyx_t_12 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_offset = __pyx_t_12;

      /* "opencl/cl_mem.pyx":503
 * 
 *                 offset += start * strides[i]
 *                 strides[i] = strides[i] * step             # <<<<<<<<<<<<<<
 * 
 *                 i += 1
 */
      __pyx_t_6 = PyObject_GetItem(((PyObject *)__pyx_v_strides), __pyx_v_i); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_9 = PyNumber_Multiply(__pyx_t_6, __pyx_v_step); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      if (PyObject_SetItem(((PyObject *)__pyx_v_strides), __pyx_v_i, __pyx_t_9) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;

      /* "opencl/cl_mem.pyx":505
 *                 strides[i] = strides[i] * step
 * 
 *                 i += 1             # <<<<<<<<<<<<<<
 * 
 *             else:
 */
      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_v_i, __pyx_int_1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_v_i);
      __pyx_v_i = __pyx_t_9;
      __pyx_t_9 = 0;
      goto __pyx_L9;
    }
    /*else*/ {

      /* "opencl/cl_mem.pyx":508
 * 
 *             else:
 *                 if arg < 0:             # <<<<<<<<<<<<<<
 *                     arg = shape[i] + arg
 * 
 */
      __pyx_t_9 = PyObject_RichCompare(__pyx_v_arg, __pyx_int_0, Py_LT); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (__pyx_t_3) {

        /* "opencl/cl_mem.pyx":509
 *             else:
 *                 if arg < 0:
 *                     arg = shape[i] + arg             # <<<<<<<<<<<<<<
 * 
 *                 offset += arg * strides[i]
 */
        __pyx_t_9 = PyObject_GetItem(((PyObject *)__pyx_v_shape), __pyx_v_i); if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_6 = PyNumber_Add(__pyx_t_9, __pyx_v_arg); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_6);
        __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
        __Pyx_DECREF(__pyx_v_arg);
        __pyx_v_arg = __pyx_t_6;
        __pyx_t_6 = 0;
        goto __pyx_L13;
      }
      __pyx_L13:;

      /* "opencl/cl_mem.pyx":511
 *                     arg = shape[i] + arg
 * 
 *                 offset += arg * strides[i]             # <<<<<<<<<<<<<<
 *                 ndim -= 1
 *                 del strides[i]
 */
      __pyx_t_6 = __Pyx_PyInt_FromSize_t(__pyx_v_offset); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_6);
      __pyx_t_9 = PyObject_GetItem(((PyObject *)__pyx_v_strides), __pyx_v_i); if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_1 = PyNumber_Multiply(__pyx_v_arg, __pyx_t_9); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = PyNumber_InPlaceAdd(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_12 = __Pyx_PyInt_AsSize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_v_offset = __pyx_t_12;

      /* "opencl/cl_mem.pyx":512
 * 
 *                 offset += arg * strides[i]
 *                 ndim -= 1             # <<<<<<<<<<<<<<
 *                 del strides[i]
 *                 del shape[i]
 */
      __pyx_t_9 = PyNumber_InPlaceSubtract(__pyx_v_ndim, __pyx_int_1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_v_ndim);
      __pyx_v_ndim = __pyx_t_9;
      __pyx_t_9 = 0;
      if (unlikely(!__pyx_v_strides)) { __Pyx_RaiseUnboundLocalError("strides"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;} }if (unlikely(!__pyx_v_i)) { __Pyx_RaiseUnboundLocalError("i"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;} }if (PyObject_DelItem(((PyObject *)__pyx_v_strides), __pyx_v_i) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      if (unlikely(!__pyx_v_shape)) { __Pyx_RaiseUnboundLocalError("shape"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;} }if (unlikely(!__pyx_v_i)) { __Pyx_RaiseUnboundLocalError("i"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;} }if (PyObject_DelItem(((PyObject *)__pyx_v_shape), __pyx_v_i) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

      /* "opencl/cl_mem.pyx":514
 *                 ndim -= 1
 *                 del strides[i]
 *                 del shape[i]             # <<<<<<<<<<<<<<
 * 
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 */
    }
    __pyx_L9:;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":516
 *                 del shape[i]
 * 
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 *         buffer.buf = NULL
 *         buffer.format = self.buffer.format
 */
  __pyx_v_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":517
 * 
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 *         buffer.buf = NULL             # <<<<<<<<<<<<<<
 *         buffer.format = self.buffer.format
 *         buffer.readonly = self.readonly
 */
  __pyx_v_buffer->buf = NULL;

  /* "opencl/cl_mem.pyx":518
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 *         buffer.buf = NULL
 *         buffer.format = self.buffer.format             # <<<<<<<<<<<<<<
 *         buffer.readonly = self.readonly
 *         buffer.itemsize = self.buffer.itemsize
 */
  __pyx_v_buffer->format = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->format;

  /* "opencl/cl_mem.pyx":519
 *         buffer.buf = NULL
 *         buffer.format = self.buffer.format
 *         buffer.readonly = self.readonly             # <<<<<<<<<<<<<<
 *         buffer.itemsize = self.buffer.itemsize
 *         buffer.ndim = ndim
 */
  __pyx_t_5 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__readonly); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_buffer->readonly = __pyx_t_3;

  /* "opencl/cl_mem.pyx":520
 *         buffer.format = self.buffer.format
 *         buffer.readonly = self.readonly
 *         buffer.itemsize = self.buffer.itemsize             # <<<<<<<<<<<<<<
 *         buffer.ndim = ndim
 * 
 */
  __pyx_v_buffer->itemsize = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->itemsize;

  /* "opencl/cl_mem.pyx":521
 *         buffer.readonly = self.readonly
 *         buffer.itemsize = self.buffer.itemsize
 *         buffer.ndim = ndim             # <<<<<<<<<<<<<<
 * 
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 */
  __pyx_t_13 = __Pyx_PyInt_AsInt(__pyx_v_ndim); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_buffer->ndim = __pyx_t_13;

  /* "opencl/cl_mem.pyx":523
 *         buffer.ndim = ndim
 * 
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)             # <<<<<<<<<<<<<<
 *         buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 *         buffer.suboffsets = NULL
 */
  __pyx_t_5 = __Pyx_PyInt_FromSize_t((sizeof(Py_ssize_t))); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_v_ndim); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_9);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_12 = __Pyx_PyInt_AsSize_t(__pyx_t_9); if (unlikely((__pyx_t_12 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_buffer->shape = ((Py_ssize_t *)malloc(__pyx_t_12));

  /* "opencl/cl_mem.pyx":524
 * 
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 *         buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)             # <<<<<<<<<<<<<<
 *         buffer.suboffsets = NULL
 * 
 */
  __pyx_t_9 = __Pyx_PyInt_FromSize_t((sizeof(Py_ssize_t))); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_9);
  __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_v_ndim); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_12 = __Pyx_PyInt_AsSize_t(__pyx_t_5); if (unlikely((__pyx_t_12 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_buffer->strides = ((Py_ssize_t *)malloc(__pyx_t_12));

  /* "opencl/cl_mem.pyx":525
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 *         buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 *         buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *         for i in range(ndim):
 */
  __pyx_v_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":527
 *         buffer.suboffsets = NULL
 * 
 *         for i in range(ndim):             # <<<<<<<<<<<<<<
 *             buffer.shape[i] = shape[i]
 *             buffer.strides[i] = strides[i]
 */
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  __Pyx_INCREF(__pyx_v_ndim);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_ndim);
  __Pyx_GIVEREF(__pyx_v_ndim);
  __pyx_t_9 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_9);
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  if (PyList_CheckExact(__pyx_t_9) || PyTuple_CheckExact(__pyx_t_9)) {
    __pyx_t_5 = __pyx_t_9; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_9); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_9 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_9); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_9 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_9); __pyx_t_4++;
    } else {
      __pyx_t_9 = __pyx_t_7(__pyx_t_5);
      if (unlikely(!__pyx_t_9)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_9);
    }
    __Pyx_DECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_9;
    __pyx_t_9 = 0;

    /* "opencl/cl_mem.pyx":528
 * 
 *         for i in range(ndim):
 *             buffer.shape[i] = shape[i]             # <<<<<<<<<<<<<<
 *             buffer.strides[i] = strides[i]
 * 
 */
    __pyx_t_9 = PyObject_GetItem(((PyObject *)__pyx_v_shape), __pyx_v_i); if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_15 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    (__pyx_v_buffer->shape[__pyx_t_15]) = __pyx_t_14;

    /* "opencl/cl_mem.pyx":529
 *         for i in range(ndim):
 *             buffer.shape[i] = shape[i]
 *             buffer.strides[i] = strides[i]             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem sub_buffer = NULL
 */
    __pyx_t_9 = PyObject_GetItem(((PyObject *)__pyx_v_strides), __pyx_v_i); if (!__pyx_t_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_9); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_15 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    (__pyx_v_buffer->strides[__pyx_t_15]) = __pyx_t_14;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":531
 *             buffer.strides[i] = strides[i]
 * 
 *         cdef cl_mem sub_buffer = NULL             # <<<<<<<<<<<<<<
 *         cdef cl_mem base = self._get_base()
 * 
 */
  __pyx_v_sub_buffer = NULL;

  /* "opencl/cl_mem.pyx":532
 * 
 *         cdef cl_mem sub_buffer = NULL
 *         cdef cl_mem base = self._get_base()             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_int err_code
 */
  __pyx_v_base = ((struct __pyx_vtabstruct_6opencl_6cl_mem_DeviceMemoryView *)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->__pyx_base.__pyx_vtab)->__pyx_base._get_base(((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_self));

  /* "opencl/cl_mem.pyx":535
 * 
 *         cdef cl_int err_code
 *         cdef size_t mem_size = self.mem_size             # <<<<<<<<<<<<<<
 *         cdef cl_buffer_region buffer_create_info
 * 
 */
  __pyx_t_5 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__mem_size); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_12 = __Pyx_PyInt_AsSize_t(__pyx_t_5); if (unlikely((__pyx_t_12 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_mem_size = __pyx_t_12;

  /* "opencl/cl_mem.pyx":538
 *         cdef cl_buffer_region buffer_create_info
 * 
 *         if offset == 0:             # <<<<<<<<<<<<<<
 *             new_view =  CyView_Create(self.buffer_id, buffer, self.ctype, 1)
 *         else:
 */
  __pyx_t_3 = (__pyx_v_offset == 0);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":539
 * 
 *         if offset == 0:
 *             new_view =  CyView_Create(self.buffer_id, buffer, self.ctype, 1)             # <<<<<<<<<<<<<<
 *         else:
 * 
 */
    __pyx_t_5 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__ctype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_9 = __pyx_f_6opencl_6cl_mem_CyView_Create(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->__pyx_base.buffer_id, __pyx_v_buffer, __pyx_t_5, 1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_new_view = __pyx_t_9;
    __pyx_t_9 = 0;
    goto __pyx_L16;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":542
 *         else:
 * 
 *             if base == NULL:             # <<<<<<<<<<<<<<
 *                 base = self.buffer_id
 * 
 */
    __pyx_t_3 = (__pyx_v_base == NULL);
    if (__pyx_t_3) {

      /* "opencl/cl_mem.pyx":543
 * 
 *             if base == NULL:
 *                 base = self.buffer_id             # <<<<<<<<<<<<<<
 * 
 *             buffer_create_info.origin = offset
 */
      __pyx_v_base = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->__pyx_base.buffer_id;
      goto __pyx_L17;
    }
    __pyx_L17:;

    /* "opencl/cl_mem.pyx":545
 *                 base = self.buffer_id
 * 
 *             buffer_create_info.origin = offset             # <<<<<<<<<<<<<<
 *             buffer_create_info.size = mem_size - offset
 * 
 */
    __pyx_v_buffer_create_info.origin = __pyx_v_offset;

    /* "opencl/cl_mem.pyx":546
 * 
 *             buffer_create_info.origin = offset
 *             buffer_create_info.size = mem_size - offset             # <<<<<<<<<<<<<<
 * 
 * #        sub_buffer = clCreateSubBuffer(base, CL_MEM_READ_WRITE, CL_BUFFER_CREATE_TYPE_REGION, & buffer_create_info, & err_code)
 */
    __pyx_v_buffer_create_info.size = (__pyx_v_mem_size - __pyx_v_offset);

    /* "opencl/cl_mem.pyx":552
 * #            raise OpenCLException(err_code, msg='offset=%r; mem_size=%r; strides=%r; shape=%r' % (offset, mem_size, strides, shape))
 * 
 *             buffer.buf = < void *> offset             # <<<<<<<<<<<<<<
 * 
 *             new_view = CyView_Create(base, buffer, self.ctype, 1)
 */
    __pyx_v_buffer->buf = ((void *)__pyx_v_offset);

    /* "opencl/cl_mem.pyx":554
 *             buffer.buf = < void *> offset
 * 
 *             new_view = CyView_Create(base, buffer, self.ctype, 1)             # <<<<<<<<<<<<<<
 * 
 *         new_view._host_pointer = self._host_pointer
 */
    __pyx_t_9 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__ctype); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __pyx_t_5 = __pyx_f_6opencl_6cl_mem_CyView_Create(__pyx_v_base, __pyx_v_buffer, __pyx_t_9, 1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_v_new_view = __pyx_t_5;
    __pyx_t_5 = 0;
  }
  __pyx_L16:;

  /* "opencl/cl_mem.pyx":556
 *             new_view = CyView_Create(base, buffer, self.ctype, 1)
 * 
 *         new_view._host_pointer = self._host_pointer             # <<<<<<<<<<<<<<
 * 
 *         return new_view
 */
  if (PyObject_SetAttr(__pyx_v_new_view, __pyx_n_s___host_pointer, ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 556; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "opencl/cl_mem.pyx":558
 *         new_view._host_pointer = self._host_pointer
 * 
 *         return new_view             # <<<<<<<<<<<<<<
 *     property size:
 *         'Total number of elements'
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_new_view);
  __pyx_r = __pyx_v_new_view;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.__getitem__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ndim);
  __Pyx_XDECREF(__pyx_v_shape);
  __Pyx_XDECREF(__pyx_v_strides);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_arg);
  __Pyx_XDECREF(__pyx_v_start);
  __Pyx_XDECREF(__pyx_v_stop);
  __Pyx_XDECREF(__pyx_v_step);
  __Pyx_XDECREF(__pyx_v_modd);
  __Pyx_XDECREF(__pyx_v_new_view);
  __Pyx_XDECREF(__pyx_v_args);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":561
 *     property size:
 *         'Total number of elements'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             shape = self.shape
 *             size = 1
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4size___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4size___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_shape = NULL;
  PyObject *__pyx_v_size = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":562
 *         'Total number of elements'
 *         def __get__(self):
 *             shape = self.shape             # <<<<<<<<<<<<<<
 *             size = 1
 *             for i in range(self.buffer.ndim):
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__shape); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_shape = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":563
 *         def __get__(self):
 *             shape = self.shape
 *             size = 1             # <<<<<<<<<<<<<<
 *             for i in range(self.buffer.ndim):
 *                 size *= shape[i]
 */
  __Pyx_INCREF(__pyx_int_1);
  __pyx_v_size = __pyx_int_1;

  /* "opencl/cl_mem.pyx":564
 *             shape = self.shape
 *             size = 1
 *             for i in range(self.buffer.ndim):             # <<<<<<<<<<<<<<
 *                 size *= shape[i]
 *             return size
 */
  __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;

    /* "opencl/cl_mem.pyx":565
 *             size = 1
 *             for i in range(self.buffer.ndim):
 *                 size *= shape[i]             # <<<<<<<<<<<<<<
 *             return size
 * 
 */
    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_shape, __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyNumber_InPlaceMultiply(__pyx_v_size, __pyx_t_1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_v_size);
    __pyx_v_size = __pyx_t_4;
    __pyx_t_4 = 0;
  }

  /* "opencl/cl_mem.pyx":566
 *             for i in range(self.buffer.ndim):
 *                 size *= shape[i]
 *             return size             # <<<<<<<<<<<<<<
 * 
 *     property nbytes:
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_size);
  __pyx_r = __pyx_v_size;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.size.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_shape);
  __Pyx_XDECREF(__pyx_v_size);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":570
 *     property nbytes:
 *         'Total number of bytes'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.size * self.buffer.itemsize
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6nbytes___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6nbytes___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":571
 *         'Total number of bytes'
 *         def __get__(self):
 *             return self.size * self.buffer.itemsize             # <<<<<<<<<<<<<<
 * 
 *     def __len__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyInt_FromSsize_t(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->itemsize); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 571; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.nbytes.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":573
 *             return self.size * self.buffer.itemsize
 * 
 *     def __len__(self):             # <<<<<<<<<<<<<<
 *         return self.size
 * 
 */

static Py_ssize_t __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__len__");

  /* "opencl/cl_mem.pyx":574
 * 
 *     def __len__(self):
 *         return self.size             # <<<<<<<<<<<<<<
 * 
 *     property is_contiguous:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.__len__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":578
 *     property is_contiguous:
 *         'is this array C-contiguous'
 *         def __get__(self):             # <<<<<<<<<<<<<<
 * 
 *             strides = [self.buffer.itemsize]
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13is_contiguous___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13is_contiguous___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_strides = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_stride = NULL;
  PyObject *__pyx_v_size = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":580
 *         def __get__(self):
 * 
 *             strides = [self.buffer.itemsize]             # <<<<<<<<<<<<<<
 *             for i in range(self.buffer.ndim - 1):
 *                 stride = strides[i]
 */
  __pyx_t_1 = PyInt_FromSsize_t(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->itemsize); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 580; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_strides = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":581
 * 
 *             strides = [self.buffer.itemsize]
 *             for i in range(self.buffer.ndim - 1):             # <<<<<<<<<<<<<<
 *                 stride = strides[i]
 *                 size = self.shape[-i - 1]
 */
  __pyx_t_2 = PyInt_FromLong((((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->buffer->ndim - 1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_1)) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++;
    } else if (PyTuple_CheckExact(__pyx_t_1)) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++;
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "opencl/cl_mem.pyx":582
 *             strides = [self.buffer.itemsize]
 *             for i in range(self.buffer.ndim - 1):
 *                 stride = strides[i]             # <<<<<<<<<<<<<<
 *                 size = self.shape[-i - 1]
 *                 strides.append(stride * size)
 */
    __pyx_t_2 = PyObject_GetItem(((PyObject *)__pyx_v_strides), __pyx_v_i); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 582; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_XDECREF(__pyx_v_stride);
    __pyx_v_stride = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "opencl/cl_mem.pyx":583
 *             for i in range(self.buffer.ndim - 1):
 *                 stride = strides[i]
 *                 size = self.shape[-i - 1]             # <<<<<<<<<<<<<<
 *                 strides.append(stride * size)
 * 
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__shape); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = PyNumber_Negative(__pyx_v_i); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_int_1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_GetItem(__pyx_t_2, __pyx_t_6); if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_XDECREF(__pyx_v_size);
    __pyx_v_size = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "opencl/cl_mem.pyx":584
 *                 stride = strides[i]
 *                 size = self.shape[-i - 1]
 *                 strides.append(stride * size)             # <<<<<<<<<<<<<<
 * 
 *             return self.strides == tuple(strides[::-1])
 */
    if (unlikely(((PyObject *)__pyx_v_strides) == Py_None)) {
      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_5 = PyNumber_Multiply(__pyx_v_stride, __pyx_v_size); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = PyList_Append(__pyx_v_strides, __pyx_t_5); if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 584; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":586
 *                 strides.append(stride * size)
 * 
 *             return self.strides == tuple(strides[::-1])             # <<<<<<<<<<<<<<
 * 
 *     def copy(self, queue):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__strides); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyObject_GetItem(((PyObject *)__pyx_v_strides), __pyx_k_slice_22); if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  if (unlikely(((PyObject *)__pyx_t_5) == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
  }
  __pyx_t_6 = ((PyObject *)PyList_AsTuple(__pyx_t_5)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_6));
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  __pyx_t_5 = PyObject_RichCompare(__pyx_t_1, ((PyObject *)__pyx_t_6), Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.is_contiguous.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strides);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_stride);
  __Pyx_XDECREF(__pyx_v_size);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}
static PyObject *__pyx_gb_6opencl_6cl_mem_4copy_1generator(struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *__pyx_cur_scope, PyObject *__pyx_sent_value); /* proto */

/* "opencl/cl_mem.pyx":603
 *             queue.enqueue_copy_buffer(self, dest, src_offset=offset, dst_offset=0, size=self.nbytes, wait_on=())
 * 
 *         elif any(stride < 0 for stride in self.strides):             # <<<<<<<<<<<<<<
 *             raise NotImplementedError("stride < 0")
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_4copy_genexpr(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_4copy_genexpr(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("genexpr");
  __pyx_cur_scope = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *)__pyx_ptype_6opencl_6cl_mem___pyx_scope_struct_1_genexpr->tp_new(__pyx_ptype_6opencl_6cl_mem___pyx_scope_struct_1_genexpr, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_cur_scope);
  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)__pyx_self;
  __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
  __pyx_self = __pyx_self;
  __pyx_cur_scope->__pyx_base.resume_label = 0;
  __pyx_cur_scope->__pyx_base.body = (__pyx_generator_body_t) __pyx_gb_6opencl_6cl_mem_4copy_1generator;
  __Pyx_GIVEREF(__pyx_cur_scope);
  __Pyx_RefNannyFinishContext();
  return (PyObject *) __pyx_cur_scope;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_gb_6opencl_6cl_mem_4copy_1generator(struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *__pyx_cur_scope, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  PyObject *(*__pyx_t_4)(PyObject *);
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("None");
  switch (__pyx_cur_scope->__pyx_base.resume_label) {
    case 0: goto __pyx_L3_first_run;
    case 1: goto __pyx_L6_resume_from_yield;
    default: /* CPython raises the right error here */
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self)) { __Pyx_RaiseClosureNameError("self"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;} }__pyx_t_1 = PyObject_GetAttr(__pyx_cur_scope->__pyx_outer_scope->__pyx_v_self, __pyx_n_s__strides); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_2)) {
      if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++;
    } else if (PyTuple_CheckExact(__pyx_t_2)) {
      if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++;
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_stride);
    __Pyx_XDECREF(__pyx_cur_scope->__pyx_v_stride);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_cur_scope->__pyx_v_stride = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_RichCompare(__pyx_cur_scope->__pyx_v_stride, __pyx_int_0, Py_LT); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    __Pyx_XGIVEREF(__pyx_t_2);
    __pyx_cur_scope->__pyx_t_0 = __pyx_t_2;
    __pyx_cur_scope->__pyx_t_1 = __pyx_t_3;
    __pyx_cur_scope->__pyx_t_2 = __pyx_t_4;
    __Pyx_XGIVEREF(__pyx_r);
    __Pyx_RefNannyFinishContext();
    /* return from generator, yielding value */
    __pyx_cur_scope->__pyx_base.resume_label = 1;
    return __pyx_r;
    __pyx_L6_resume_from_yield:;
    __pyx_t_2 = __pyx_cur_scope->__pyx_t_0;
    __pyx_cur_scope->__pyx_t_0 = 0;
    __Pyx_XGOTREF(__pyx_t_2);
    __pyx_t_3 = __pyx_cur_scope->__pyx_t_1;
    __pyx_t_4 = __pyx_cur_scope->__pyx_t_2;
    if (unlikely(!__pyx_sent_value)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyErr_SetNone(PyExc_StopIteration); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_r);
  __pyx_cur_scope->__pyx_base.resume_label = -1;
  __Pyx_RefNannyFinishContext();
  return NULL;
}

/* "opencl/cl_mem.pyx":588
 *             return self.strides == tuple(strides[::-1])
 * 
 *     def copy(self, queue):             # <<<<<<<<<<<<<<
 *         '''
 *         Copy this buffer into a new object
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8copy(PyObject *__pyx_v_self, PyObject *__pyx_v_queue); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_8copy[] = "\n        Copy this buffer into a new object\n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8copy(PyObject *__pyx_v_self, PyObject *__pyx_v_queue) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *__pyx_cur_scope;
  size_t __pyx_v_src_row_pitch;
  size_t __pyx_v_src_slice_pitch;
  size_t __pyx_v_dst_row_pitch;
  size_t __pyx_v_dst_slice_pitch;
  PyObject *__pyx_v_dest = NULL;
  size_t __pyx_v_offset;
  PyObject *__pyx_v_region = NULL;
  PyObject *__pyx_v_src_origin = NULL;
  PyObject *__pyx_v_dst_origin = NULL;
  Py_ssize_t __pyx_v_shape2;
  Py_ssize_t __pyx_v_shape1;
  Py_ssize_t __pyx_v_shape0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("copy");
  __pyx_cur_scope = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)__pyx_ptype_6opencl_6cl_mem___pyx_scope_struct__copy->tp_new(__pyx_ptype_6opencl_6cl_mem___pyx_scope_struct__copy, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __Pyx_RefNannyFinishContext();
    return NULL;
  }
  __Pyx_GOTREF(__pyx_cur_scope);
  __Pyx_INCREF(__pyx_v_self);
  __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
  __Pyx_GIVEREF((PyObject *)__pyx_cur_scope->__pyx_v_self);

  /* "opencl/cl_mem.pyx":592
 *         Copy this buffer into a new object
 *         '''
 *         cdef size_t src_row_pitch = 0             # <<<<<<<<<<<<<<
 *         cdef size_t src_slice_pitch = 0
 *         cdef size_t dst_row_pitch = 0
 */
  __pyx_v_src_row_pitch = 0;

  /* "opencl/cl_mem.pyx":593
 *         '''
 *         cdef size_t src_row_pitch = 0
 *         cdef size_t src_slice_pitch = 0             # <<<<<<<<<<<<<<
 *         cdef size_t dst_row_pitch = 0
 *         cdef size_t dst_slice_pitch = 0
 */
  __pyx_v_src_slice_pitch = 0;

  /* "opencl/cl_mem.pyx":594
 *         cdef size_t src_row_pitch = 0
 *         cdef size_t src_slice_pitch = 0
 *         cdef size_t dst_row_pitch = 0             # <<<<<<<<<<<<<<
 *         cdef size_t dst_slice_pitch = 0
 * 
 */
  __pyx_v_dst_row_pitch = 0;

  /* "opencl/cl_mem.pyx":595
 *         cdef size_t src_slice_pitch = 0
 *         cdef size_t dst_row_pitch = 0
 *         cdef size_t dst_slice_pitch = 0             # <<<<<<<<<<<<<<
 * 
 *         dest = empty(self.context, self.shape, ctype=self.format)
 */
  __pyx_v_dst_slice_pitch = 0;

  /* "opencl/cl_mem.pyx":597
 *         cdef size_t dst_slice_pitch = 0
 * 
 *         dest = empty(self.context, self.shape, ctype=self.format)             # <<<<<<<<<<<<<<
 * 
 *         cdef size_t offset = < size_t > self.buffer.buf
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__empty); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s__context); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_GetAttr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s__shape); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __pyx_t_2 = PyObject_GetAttr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s__format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__ctype), __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_v_dest = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":599
 *         dest = empty(self.context, self.shape, ctype=self.format)
 * 
 *         cdef size_t offset = < size_t > self.buffer.buf             # <<<<<<<<<<<<<<
 *         if self.is_contiguous:
 *             queue.enqueue_copy_buffer(self, dest, src_offset=offset, dst_offset=0, size=self.nbytes, wait_on=())
 */
  __pyx_v_offset = ((size_t)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->buf);

  /* "opencl/cl_mem.pyx":600
 * 
 *         cdef size_t offset = < size_t > self.buffer.buf
 *         if self.is_contiguous:             # <<<<<<<<<<<<<<
 *             queue.enqueue_copy_buffer(self, dest, src_offset=offset, dst_offset=0, size=self.nbytes, wait_on=())
 * 
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s__is_contiguous); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {

    /* "opencl/cl_mem.pyx":601
 *         cdef size_t offset = < size_t > self.buffer.buf
 *         if self.is_contiguous:
 *             queue.enqueue_copy_buffer(self, dest, src_offset=offset, dst_offset=0, size=self.nbytes, wait_on=())             # <<<<<<<<<<<<<<
 * 
 *         elif any(stride < 0 for stride in self.strides):
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_queue, __pyx_n_s__enqueue_copy_buffer); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_cur_scope->__pyx_v_self);
    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
    __Pyx_INCREF(__pyx_v_dest);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_dest);
    __Pyx_GIVEREF(__pyx_v_dest);
    __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    __pyx_t_1 = __Pyx_PyInt_FromSize_t(__pyx_v_offset); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__src_offset), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__dst_offset), __pyx_int_0) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = PyObject_GetAttr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s__nbytes); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__size), __pyx_t_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    if (PyDict_SetItem(__pyx_t_4, ((PyObject *)__pyx_n_s__wait_on), ((PyObject *)__pyx_empty_tuple)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = PyEval_CallObjectWithKeywords(__pyx_t_2, ((PyObject *)__pyx_t_3), ((PyObject *)__pyx_t_4)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L5;
  }

  /* "opencl/cl_mem.pyx":603
 *             queue.enqueue_copy_buffer(self, dest, src_offset=offset, dst_offset=0, size=self.nbytes, wait_on=())
 * 
 *         elif any(stride < 0 for stride in self.strides):             # <<<<<<<<<<<<<<
 *             raise NotImplementedError("stride < 0")
 * 
 */
  __pyx_t_1 = __pyx_pf_6opencl_6cl_mem_4copy_genexpr(((PyObject*)__pyx_cur_scope), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_any, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {

    /* "opencl/cl_mem.pyx":604
 * 
 *         elif any(stride < 0 for stride in self.strides):
 *             raise NotImplementedError("stride < 0")             # <<<<<<<<<<<<<<
 * 
 *         elif self.buffer.ndim == 1:
 */
    __pyx_t_1 = PyObject_Call(__pyx_builtin_NotImplementedError, ((PyObject *)__pyx_k_tuple_24), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }

  /* "opencl/cl_mem.pyx":606
 *             raise NotImplementedError("stride < 0")
 * 
 *         elif self.buffer.ndim == 1:             # <<<<<<<<<<<<<<
 *             src_row_pitch = self.buffer.strides[0]
 *             src_slice_pitch = 0
 */
  __pyx_t_5 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->ndim == 1);
  if (__pyx_t_5) {

    /* "opencl/cl_mem.pyx":607
 * 
 *         elif self.buffer.ndim == 1:
 *             src_row_pitch = self.buffer.strides[0]             # <<<<<<<<<<<<<<
 *             src_slice_pitch = 0
 *             dst_row_pitch = 0
 */
    __pyx_v_src_row_pitch = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->strides[0]);

    /* "opencl/cl_mem.pyx":608
 *         elif self.buffer.ndim == 1:
 *             src_row_pitch = self.buffer.strides[0]
 *             src_slice_pitch = 0             # <<<<<<<<<<<<<<
 *             dst_row_pitch = 0
 *             dst_slice_pitch = 0
 */
    __pyx_v_src_slice_pitch = 0;

    /* "opencl/cl_mem.pyx":609
 *             src_row_pitch = self.buffer.strides[0]
 *             src_slice_pitch = 0
 *             dst_row_pitch = 0             # <<<<<<<<<<<<<<
 *             dst_slice_pitch = 0
 * 
 */
    __pyx_v_dst_row_pitch = 0;

    /* "opencl/cl_mem.pyx":610
 *             src_slice_pitch = 0
 *             dst_row_pitch = 0
 *             dst_slice_pitch = 0             # <<<<<<<<<<<<<<
 * 
 *             region = (dest.itemsize, dest.size, 1)
 */
    __pyx_v_dst_slice_pitch = 0;

    /* "opencl/cl_mem.pyx":612
 *             dst_slice_pitch = 0
 * 
 *             region = (dest.itemsize, dest.size, 1)             # <<<<<<<<<<<<<<
 *             src_origin = (offset, 0, 0)
 *             dst_origin = (0, 0, 0)
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_dest, __pyx_n_s__itemsize); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_dest, __pyx_n_s__size); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_int_1);
    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_1);
    __Pyx_GIVEREF(__pyx_int_1);
    __pyx_t_1 = 0;
    __pyx_t_4 = 0;
    __pyx_v_region = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "opencl/cl_mem.pyx":613
 * 
 *             region = (dest.itemsize, dest.size, 1)
 *             src_origin = (offset, 0, 0)             # <<<<<<<<<<<<<<
 *             dst_origin = (0, 0, 0)
 * 
 */
    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_offset); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    __pyx_t_3 = 0;
    __pyx_v_src_origin = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "opencl/cl_mem.pyx":614
 *             region = (dest.itemsize, dest.size, 1)
 *             src_origin = (offset, 0, 0)
 *             dst_origin = (0, 0, 0)             # <<<<<<<<<<<<<<
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 */
    __Pyx_INCREF(((PyObject *)__pyx_k_tuple_25));
    __pyx_v_dst_origin = __pyx_k_tuple_25;

    /* "opencl/cl_mem.pyx":616
 *             dst_origin = (0, 0, 0)
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,             # <<<<<<<<<<<<<<
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 */
    __pyx_t_4 = PyObject_GetAttr(__pyx_v_queue, __pyx_n_s_26); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);

    /* "opencl/cl_mem.pyx":617
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 *                                            src_row_pitch, src_slice_pitch,             # <<<<<<<<<<<<<<
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 *         elif self.buffer.ndim == 2:
 */
    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_src_row_pitch); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_1 = __Pyx_PyInt_FromSize_t(__pyx_v_src_slice_pitch); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);

    /* "opencl/cl_mem.pyx":618
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())             # <<<<<<<<<<<<<<
 *         elif self.buffer.ndim == 2:
 * 
 */
    __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_dst_row_pitch); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = __Pyx_PyInt_FromSize_t(__pyx_v_dst_slice_pitch); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyTuple_New(9); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_7));
    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_cur_scope->__pyx_v_self);
    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
    __Pyx_INCREF(__pyx_v_dest);
    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_dest);
    __Pyx_GIVEREF(__pyx_v_dest);
    __Pyx_INCREF(((PyObject *)__pyx_v_region));
    PyTuple_SET_ITEM(__pyx_t_7, 2, ((PyObject *)__pyx_v_region));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_region));
    __Pyx_INCREF(((PyObject *)__pyx_v_src_origin));
    PyTuple_SET_ITEM(__pyx_t_7, 3, ((PyObject *)__pyx_v_src_origin));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_src_origin));
    __Pyx_INCREF(((PyObject *)__pyx_v_dst_origin));
    PyTuple_SET_ITEM(__pyx_t_7, 4, ((PyObject *)__pyx_v_dst_origin));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_dst_origin));
    PyTuple_SET_ITEM(__pyx_t_7, 5, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_7, 6, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_7, 7, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_7, 8, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_3 = 0;
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_t_6 = 0;

    /* "opencl/cl_mem.pyx":616
 *             dst_origin = (0, 0, 0)
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,             # <<<<<<<<<<<<<<
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 */
    __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));

    /* "opencl/cl_mem.pyx":618
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())             # <<<<<<<<<<<<<<
 *         elif self.buffer.ndim == 2:
 * 
 */
    if (PyDict_SetItem(__pyx_t_6, ((PyObject *)__pyx_n_s__wait_on), ((PyObject *)__pyx_empty_tuple)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_4, ((PyObject *)__pyx_t_7), ((PyObject *)__pyx_t_6)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L5;
  }

  /* "opencl/cl_mem.pyx":619
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 *         elif self.buffer.ndim == 2:             # <<<<<<<<<<<<<<
 * 
 *             shape2 = self.buffer.itemsize
 */
  __pyx_t_5 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->ndim == 2);
  if (__pyx_t_5) {

    /* "opencl/cl_mem.pyx":621
 *         elif self.buffer.ndim == 2:
 * 
 *             shape2 = self.buffer.itemsize             # <<<<<<<<<<<<<<
 *             shape1 = self.buffer.shape[1]
 *             shape0 = self.buffer.shape[0]
 */
    __pyx_v_shape2 = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->itemsize;

    /* "opencl/cl_mem.pyx":622
 * 
 *             shape2 = self.buffer.itemsize
 *             shape1 = self.buffer.shape[1]             # <<<<<<<<<<<<<<
 *             shape0 = self.buffer.shape[0]
 * 
 */
    __pyx_v_shape1 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->shape[1]);

    /* "opencl/cl_mem.pyx":623
 *             shape2 = self.buffer.itemsize
 *             shape1 = self.buffer.shape[1]
 *             shape0 = self.buffer.shape[0]             # <<<<<<<<<<<<<<
 * 
 *             src_row_pitch = self.buffer.strides[1]
 */
    __pyx_v_shape0 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->shape[0]);

    /* "opencl/cl_mem.pyx":625
 *             shape0 = self.buffer.shape[0]
 * 
 *             src_row_pitch = self.buffer.strides[1]             # <<<<<<<<<<<<<<
 *             src_slice_pitch = self.buffer.strides[0]
 * 
 */
    __pyx_v_src_row_pitch = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->strides[1]);

    /* "opencl/cl_mem.pyx":626
 * 
 *             src_row_pitch = self.buffer.strides[1]
 *             src_slice_pitch = self.buffer.strides[0]             # <<<<<<<<<<<<<<
 * 
 *             region = shape2, shape1, shape0
 */
    __pyx_v_src_slice_pitch = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->strides[0]);

    /* "opencl/cl_mem.pyx":628
 *             src_slice_pitch = self.buffer.strides[0]
 * 
 *             region = shape2, shape1, shape0             # <<<<<<<<<<<<<<
 *             src_origin = (< size_t > self.buffer.buf, 0, 0)
 *             dst_origin = (0, 0, 0)
 */
    __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_shape2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_shape1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_shape0); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);
    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_7);
    __Pyx_GIVEREF(__pyx_t_7);
    __pyx_t_2 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_v_region = __pyx_t_4;
    __pyx_t_4 = 0;

    /* "opencl/cl_mem.pyx":629
 * 
 *             region = shape2, shape1, shape0
 *             src_origin = (< size_t > self.buffer.buf, 0, 0)             # <<<<<<<<<<<<<<
 *             dst_origin = (0, 0, 0)
 * 
 */
    __pyx_t_4 = __Pyx_PyInt_FromSize_t(((size_t)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_cur_scope->__pyx_v_self)->buffer->buf)); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_7));
    PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __Pyx_INCREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    __Pyx_INCREF(__pyx_int_0);
    PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_int_0);
    __Pyx_GIVEREF(__pyx_int_0);
    __pyx_t_4 = 0;
    __pyx_v_src_origin = __pyx_t_7;
    __pyx_t_7 = 0;

    /* "opencl/cl_mem.pyx":630
 *             region = shape2, shape1, shape0
 *             src_origin = (< size_t > self.buffer.buf, 0, 0)
 *             dst_origin = (0, 0, 0)             # <<<<<<<<<<<<<<
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 */
    __Pyx_INCREF(((PyObject *)__pyx_k_tuple_27));
    __pyx_v_dst_origin = __pyx_k_tuple_27;

    /* "opencl/cl_mem.pyx":632
 *             dst_origin = (0, 0, 0)
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,             # <<<<<<<<<<<<<<
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 */
    __pyx_t_7 = PyObject_GetAttr(__pyx_v_queue, __pyx_n_s_26); if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_7);

    /* "opencl/cl_mem.pyx":633
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 *                                            src_row_pitch, src_slice_pitch,             # <<<<<<<<<<<<<<
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 *         else:
 */
    __pyx_t_4 = __Pyx_PyInt_FromSize_t(__pyx_v_src_row_pitch); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_6 = __Pyx_PyInt_FromSize_t(__pyx_v_src_slice_pitch); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);

    /* "opencl/cl_mem.pyx":634
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())             # <<<<<<<<<<<<<<
 *         else:
 *             raise Exception()
 */
    __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_dst_row_pitch); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = __Pyx_PyInt_FromSize_t(__pyx_v_dst_slice_pitch); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_3 = PyTuple_New(9); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_cur_scope->__pyx_v_self);
    __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
    __Pyx_INCREF(__pyx_v_dest);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_dest);
    __Pyx_GIVEREF(__pyx_v_dest);
    __Pyx_INCREF(((PyObject *)__pyx_v_region));
    PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_region));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_region));
    __Pyx_INCREF(((PyObject *)__pyx_v_src_origin));
    PyTuple_SET_ITEM(__pyx_t_3, 3, ((PyObject *)__pyx_v_src_origin));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_src_origin));
    __Pyx_INCREF(((PyObject *)__pyx_v_dst_origin));
    PyTuple_SET_ITEM(__pyx_t_3, 4, ((PyObject *)__pyx_v_dst_origin));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_dst_origin));
    PyTuple_SET_ITEM(__pyx_t_3, 5, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_3, 6, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_3, 7, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    PyTuple_SET_ITEM(__pyx_t_3, 8, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_4 = 0;
    __pyx_t_6 = 0;
    __pyx_t_2 = 0;
    __pyx_t_1 = 0;

    /* "opencl/cl_mem.pyx":632
 *             dst_origin = (0, 0, 0)
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,             # <<<<<<<<<<<<<<
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 */
    __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));

    /* "opencl/cl_mem.pyx":634
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 *                                            src_row_pitch, src_slice_pitch,
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())             # <<<<<<<<<<<<<<
 *         else:
 *             raise Exception()
 */
    if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__wait_on), ((PyObject *)__pyx_empty_tuple)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_7, ((PyObject *)__pyx_t_3), ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":636
 *                                            dst_row_pitch, dst_slice_pitch, wait_on=())
 *         else:
 *             raise Exception()             # <<<<<<<<<<<<<<
 * 
 *         return dest
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_Exception, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":638
 *             raise Exception()
 * 
 *         return dest             # <<<<<<<<<<<<<<
 * 
 *     def __float__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_dest);
  __pyx_r = __pyx_v_dest;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.copy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_dest);
  __Pyx_XDECREF(__pyx_v_region);
  __Pyx_XDECREF(__pyx_v_src_origin);
  __Pyx_XDECREF(__pyx_v_dst_origin);
  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":640
 *         return dest
 * 
 *     def __float__(self):             # <<<<<<<<<<<<<<
 *         ctype = self.item()
 *         return float(ctype.value)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_9__float__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_9__float__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_ctype = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  double __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__float__");

  /* "opencl/cl_mem.pyx":641
 * 
 *     def __float__(self):
 *         ctype = self.item()             # <<<<<<<<<<<<<<
 *         return float(ctype.value)
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__item); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ctype = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":642
 *     def __float__(self):
 *         ctype = self.item()
 *         return float(ctype.value)             # <<<<<<<<<<<<<<
 * 
 *     def __int__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_ctype, __pyx_n_s__value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_AsDouble(__pyx_t_2); if (unlikely(__pyx_t_3 == ((double)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyFloat_FromDouble(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.__float__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ctype);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":644
 *         return float(ctype.value)
 * 
 *     def __int__(self):             # <<<<<<<<<<<<<<
 *         ctype = self.item()
 *         return int(ctype.value)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10__int__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10__int__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_ctype = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__int__");

  /* "opencl/cl_mem.pyx":645
 * 
 *     def __int__(self):
 *         ctype = self.item()             # <<<<<<<<<<<<<<
 *         return int(ctype.value)
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__item); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 645; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ctype = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":646
 *     def __int__(self):
 *         ctype = self.item()
 *         return int(ctype.value)             # <<<<<<<<<<<<<<
 * 
 *     def item(self, queue=None):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_ctype, __pyx_n_s__value); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(((PyObject *)((PyObject*)(&PyInt_Type))), ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 646; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.__int__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ctype);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":648
 *         return int(ctype.value)
 * 
 *     def item(self, queue=None):             # <<<<<<<<<<<<<<
 *         '''
 *         Return a python object if the size of this array is 1.
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_11item(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_11item[] = "\n        Return a python object if the size of this array is 1. \n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_11item(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_queue = 0;
  PyObject *__pyx_v_opencl = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__queue,0};
  __Pyx_RefNannySetupContext("item");
  {
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__queue);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "item") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_queue = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("item", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.item", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF(__pyx_v_queue);

  /* "opencl/cl_mem.pyx":652
 *         Return a python object if the size of this array is 1.
 *         '''
 *         if self.size != 1:             # <<<<<<<<<<<<<<
 *             raise ValueError('can only convert an array  of size 1 to a Python scalar')
 *         if queue is None:
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__size); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_1, Py_NE); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":653
 *         '''
 *         if self.size != 1:
 *             raise ValueError('can only convert an array  of size 1 to a Python scalar')             # <<<<<<<<<<<<<<
 *         if queue is None:
 *             import opencl
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_k_tuple_29), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":654
 *         if self.size != 1:
 *             raise ValueError('can only convert an array  of size 1 to a Python scalar')
 *         if queue is None:             # <<<<<<<<<<<<<<
 *             import opencl
 *             queue = opencl.Queue(self.context)
 */
  __pyx_t_3 = (__pyx_v_queue == Py_None);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":655
 *             raise ValueError('can only convert an array  of size 1 to a Python scalar')
 *         if queue is None:
 *             import opencl             # <<<<<<<<<<<<<<
 *             queue = opencl.Queue(self.context)
 * 
 */
    __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__opencl), 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_opencl = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "opencl/cl_mem.pyx":656
 *         if queue is None:
 *             import opencl
 *             queue = opencl.Queue(self.context)             # <<<<<<<<<<<<<<
 * 
 *         out = self.ctype()
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_opencl, __pyx_n_s__Queue); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__context); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_v_queue);
    __pyx_v_queue = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":658
 *             queue = opencl.Queue(self.context)
 * 
 *         out = self.ctype()             # <<<<<<<<<<<<<<
 *         self.read(queue, out, blocking=True)
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__ctype); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_out = __pyx_t_4;
  __pyx_t_4 = 0;

  /* "opencl/cl_mem.pyx":659
 * 
 *         out = self.ctype()
 *         self.read(queue, out, blocking=True)             # <<<<<<<<<<<<<<
 * 
 *         return out
 */
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__read); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_queue);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_queue);
  __Pyx_GIVEREF(__pyx_v_queue);
  __Pyx_INCREF(__pyx_v_out);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_out);
  __Pyx_GIVEREF(__pyx_v_out);
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __pyx_t_5 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  if (PyDict_SetItem(__pyx_t_2, ((PyObject *)__pyx_n_s__blocking), __pyx_t_5) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyEval_CallObjectWithKeywords(__pyx_t_4, ((PyObject *)__pyx_t_1), ((PyObject *)__pyx_t_2)); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":661
 *         self.read(queue, out, blocking=True)
 * 
 *         return out             # <<<<<<<<<<<<<<
 * 
 *     property ctype:
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.item", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_opencl);
  __Pyx_XDECREF(__pyx_v_out);
  __Pyx_XDECREF(__pyx_v_queue);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":664
 * 
 *     property ctype:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             if self._ctype is None:
 *                 self._ctype = ctype_from_format(self.format)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5ctype___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5ctype___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":665
 *     property ctype:
 *         def __get__(self):
 *             if self._ctype is None:             # <<<<<<<<<<<<<<
 *                 self._ctype = ctype_from_format(self.format)
 *             return self._ctype
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_ctype == Py_None);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":666
 *         def __get__(self):
 *             if self._ctype is None:
 *                 self._ctype = ctype_from_format(self.format)             # <<<<<<<<<<<<<<
 *             return self._ctype
 * 
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__ctype_from_format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__format); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_GIVEREF(__pyx_t_3);
    __Pyx_GOTREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_ctype);
    __Pyx_DECREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_ctype);
    ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_ctype = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":667
 *             if self._ctype is None:
 *                 self._ctype = ctype_from_format(self.format)
 *             return self._ctype             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_ctype);
  __pyx_r = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_ctype;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.ctype.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":670
 * 
 * 
 *     def read(self, queue, out, wait_on=(), blocking=False):             # <<<<<<<<<<<<<<
 *         '''
 *         buf.read(queue, out, wait_on=(), blocking=False)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_12read(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_12read[] = "\n        buf.read(queue, out, wait_on=(), blocking=False)\n        \n        Read this buffer into a memory view\n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_12read(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_queue = 0;
  PyObject *__pyx_v_out = 0;
  PyObject *__pyx_v_wait_on = 0;
  PyObject *__pyx_v_blocking = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__queue,&__pyx_n_s__out,&__pyx_n_s__wait_on,&__pyx_n_s__blocking,0};
  __Pyx_RefNannySetupContext("read");
  {
    PyObject* values[4] = {0,0,0,0};
    values[2] = ((PyObject *)__pyx_empty_tuple);
    values[3] = __pyx_k_30;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__queue);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__out);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("read", 0, 2, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__wait_on);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__blocking);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "read") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_queue = values[0];
    __pyx_v_out = values[1];
    __pyx_v_wait_on = values[2];
    __pyx_v_blocking = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("read", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.read", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":676
 *         Read this buffer into a memory view
 *         '''
 *         return queue.enqueue_read_buffer(self, out, self.offset_, self.nbytes, wait_on, blocking_read=blocking)             # <<<<<<<<<<<<<<
 * 
 *     def write(self, queue, buf, wait_on=(), blocking=False):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_queue, __pyx_n_s__enqueue_read_buffer); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__offset_); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__nbytes); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  __Pyx_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_self);
  __Pyx_GIVEREF(__pyx_v_self);
  __Pyx_INCREF(__pyx_v_out);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_out);
  __Pyx_GIVEREF(__pyx_v_out);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_v_wait_on);
  PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_wait_on);
  __Pyx_GIVEREF(__pyx_v_wait_on);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__blocking_read), __pyx_v_blocking) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 676; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.read", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":678
 *         return queue.enqueue_read_buffer(self, out, self.offset_, self.nbytes, wait_on, blocking_read=blocking)
 * 
 *     def write(self, queue, buf, wait_on=(), blocking=False):             # <<<<<<<<<<<<<<
 *         '''
 *         view.write(queue, buf, wait_on=(), blocking=False)
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13write(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_13write[] = "\n        view.write(queue, buf, wait_on=(), blocking=False)\n        \n        Write data from a memoryview to the device.\n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13write(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_queue = 0;
  PyObject *__pyx_v_buf = 0;
  PyObject *__pyx_v_wait_on = 0;
  PyObject *__pyx_v_blocking = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__queue,&__pyx_n_s__buf,&__pyx_n_s__wait_on,&__pyx_n_s__blocking,0};
  __Pyx_RefNannySetupContext("write");
  {
    PyObject* values[4] = {0,0,0,0};
    values[2] = ((PyObject *)__pyx_empty_tuple);
    values[3] = __pyx_k_31;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__queue);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__buf);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("write", 0, 2, 4, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__wait_on);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__blocking);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "write") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_queue = values[0];
    __pyx_v_buf = values[1];
    __pyx_v_wait_on = values[2];
    __pyx_v_blocking = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("write", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.write", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":684
 *         Write data from a memoryview to the device.
 *         '''
 *         return queue.enqueue_write_buffer(self, buf, self.offset_, self.nbytes, wait_on, blocking_read=blocking)             # <<<<<<<<<<<<<<
 * 
 *     def __releasebuffer__(self, Py_buffer * view):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_queue, __pyx_n_s_32); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__offset_); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__nbytes); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_4));
  __Pyx_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_self);
  __Pyx_GIVEREF(__pyx_v_self);
  __Pyx_INCREF(__pyx_v_buf);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_buf);
  __Pyx_GIVEREF(__pyx_v_buf);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __Pyx_INCREF(__pyx_v_wait_on);
  PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_v_wait_on);
  __Pyx_GIVEREF(__pyx_v_wait_on);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__blocking_read), __pyx_v_blocking) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_t_4), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView.write", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":686
 *         return queue.enqueue_write_buffer(self, buf, self.offset_, self.nbytes, wait_on, blocking_read=blocking)
 * 
 *     def __releasebuffer__(self, Py_buffer * view):             # <<<<<<<<<<<<<<
 *         pass
 * 
 */

static CYTHON_UNUSED void __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_14__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_view); /*proto*/
static CYTHON_UNUSED void __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_14__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_view) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__releasebuffer__");

  __Pyx_RefNannyFinishContext();
}

/* "opencl/cl_mem.pyx":690
 * 
 *     @classmethod
 *     def _view_as_this(cls, obj):             # <<<<<<<<<<<<<<
 *         '''
 *         view DeviceMemoryView obj as this class.
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_15_view_as_this(PyObject *__pyx_v_cls, PyObject *__pyx_v_obj); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_15_view_as_this[] = "\n        view DeviceMemoryView obj as this class.   \n        \n        Call this for subclasses of DeviceMemoryView.\n        ";
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_15_view_as_this(PyObject *__pyx_v_cls, PyObject *__pyx_v_obj) {
  Py_buffer __pyx_v_orig_buffer;
  Py_buffer *__pyx_v_buffer;
  cl_mem __pyx_v_buffer_id;
  char *__pyx_v_format;
  Py_ssize_t *__pyx_v_shape;
  Py_ssize_t *__pyx_v_strides;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("_view_as_this");

  /* "opencl/cl_mem.pyx":696
 *         Call this for subclasses of DeviceMemoryView.
 *         '''
 *         if not isinstance(obj, DeviceMemoryView):             # <<<<<<<<<<<<<<
 *             raise TypeError('can not create a new memory view from obj %r' % obj)
 * 
 */
  __pyx_t_1 = ((PyObject *)((PyObject*)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView));
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_obj, __pyx_t_1); 
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":697
 *         '''
 *         if not isinstance(obj, DeviceMemoryView):
 *             raise TypeError('can not create a new memory view from obj %r' % obj)             # <<<<<<<<<<<<<<
 * 
 *         cdef Py_buffer orig_buffer
 */
    __pyx_t_1 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_33), __pyx_v_obj); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_t_1));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
    __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 697; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":700
 * 
 *         cdef Py_buffer orig_buffer
 *         CyView_GetBuffer(obj, & orig_buffer)             # <<<<<<<<<<<<<<
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 *         memcpy(buffer, & orig_buffer, sizeof(Py_buffer))
 */
  __pyx_f_6opencl_6cl_mem_CyView_GetBuffer(__pyx_v_obj, (&__pyx_v_orig_buffer));

  /* "opencl/cl_mem.pyx":701
 *         cdef Py_buffer orig_buffer
 *         CyView_GetBuffer(obj, & orig_buffer)
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 *         memcpy(buffer, & orig_buffer, sizeof(Py_buffer))
 * 
 */
  __pyx_v_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":702
 *         CyView_GetBuffer(obj, & orig_buffer)
 *         cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 *         memcpy(buffer, & orig_buffer, sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem buffer_id = CyMemoryObject_GetID(obj)
 */
  memcpy(__pyx_v_buffer, (&__pyx_v_orig_buffer), (sizeof(Py_buffer)));

  /* "opencl/cl_mem.pyx":704
 *         memcpy(buffer, & orig_buffer, sizeof(Py_buffer))
 * 
 *         cdef cl_mem buffer_id = CyMemoryObject_GetID(obj)             # <<<<<<<<<<<<<<
 * 
 *         cdef char * format = buffer.format
 */
  __pyx_v_buffer_id = __pyx_f_6opencl_6cl_mem_CyMemoryObject_GetID(__pyx_v_obj);

  /* "opencl/cl_mem.pyx":706
 *         cdef cl_mem buffer_id = CyMemoryObject_GetID(obj)
 * 
 *         cdef char * format = buffer.format             # <<<<<<<<<<<<<<
 *         cdef Py_ssize_t * shape = buffer.shape
 *         cdef Py_ssize_t * strides = buffer.strides
 */
  __pyx_v_format = __pyx_v_buffer->format;

  /* "opencl/cl_mem.pyx":707
 * 
 *         cdef char * format = buffer.format
 *         cdef Py_ssize_t * shape = buffer.shape             # <<<<<<<<<<<<<<
 *         cdef Py_ssize_t * strides = buffer.strides
 * 
 */
  __pyx_v_shape = __pyx_v_buffer->shape;

  /* "opencl/cl_mem.pyx":708
 *         cdef char * format = buffer.format
 *         cdef Py_ssize_t * shape = buffer.shape
 *         cdef Py_ssize_t * strides = buffer.strides             # <<<<<<<<<<<<<<
 * 
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 */
  __pyx_v_strides = __pyx_v_buffer->strides;

  /* "opencl/cl_mem.pyx":710
 *         cdef Py_ssize_t * strides = buffer.strides
 * 
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *         buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *         buffer.suboffsets = NULL
 */
  __pyx_v_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":711
 * 
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *         buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *         buffer.suboffsets = NULL
 * 
 */
  __pyx_v_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":712
 *         buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *         buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *         buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_v_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":715
 * 
 * 
 *         buffer.buf = orig_buffer.buf             # <<<<<<<<<<<<<<
 * 
 *         strcpy(buffer.format, format)
 */
  __pyx_v_buffer->buf = __pyx_v_orig_buffer.buf;

  /* "opencl/cl_mem.pyx":717
 *         buffer.buf = orig_buffer.buf
 * 
 *         strcpy(buffer.format, format)             # <<<<<<<<<<<<<<
 * 
 *         for i in range(buffer.ndim):
 */
  strcpy(__pyx_v_buffer->format, __pyx_v_format);

  /* "opencl/cl_mem.pyx":719
 *         strcpy(buffer.format, format)
 * 
 *         for i in range(buffer.ndim):             # <<<<<<<<<<<<<<
 *             buffer.shape[i] = shape[i]
 *             buffer.strides[i] = strides[i]
 */
  __pyx_t_5 = __pyx_v_buffer->ndim;
  for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;

    /* "opencl/cl_mem.pyx":720
 * 
 *         for i in range(buffer.ndim):
 *             buffer.shape[i] = shape[i]             # <<<<<<<<<<<<<<
 *             buffer.strides[i] = strides[i]
 * 
 */
    (__pyx_v_buffer->shape[__pyx_v_i]) = (__pyx_v_shape[__pyx_v_i]);

    /* "opencl/cl_mem.pyx":721
 *         for i in range(buffer.ndim):
 *             buffer.shape[i] = shape[i]
 *             buffer.strides[i] = strides[i]             # <<<<<<<<<<<<<<
 * 
 *         return CyView_CreateSubclass(cls, buffer_id, buffer, obj.ctype, 1)
 */
    (__pyx_v_buffer->strides[__pyx_v_i]) = (__pyx_v_strides[__pyx_v_i]);
  }

  /* "opencl/cl_mem.pyx":723
 *             buffer.strides[i] = strides[i]
 * 
 *         return CyView_CreateSubclass(cls, buffer_id, buffer, obj.ctype, 1)             # <<<<<<<<<<<<<<
 * 
 * def is_string(obj):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_obj, __pyx_n_s__ctype); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __pyx_f_6opencl_6cl_mem_CyView_CreateSubclass(__pyx_v_cls, __pyx_v_buffer_id, __pyx_v_buffer, __pyx_t_1, 1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 723; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.DeviceMemoryView._view_as_this", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":254
 *     cdef Py_buffer * buffer
 *     cdef object __weakref__
 *     cdef public object _host_pointer             # <<<<<<<<<<<<<<
 *     cdef object _ctype
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__get__");
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer);
  __pyx_r = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer_1__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__set__");
  __Pyx_INCREF(__pyx_v_value);
  __Pyx_GIVEREF(__pyx_v_value);
  __Pyx_GOTREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer);
  __Pyx_DECREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer);
  ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer = __pyx_v_value;

  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer_2__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer_2__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__del__");
  __Pyx_INCREF(Py_None);
  __Pyx_GIVEREF(Py_None);
  __Pyx_GOTREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer);
  __Pyx_DECREF(((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer);
  ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_self)->_host_pointer = Py_None;

  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":725
 *         return CyView_CreateSubclass(cls, buffer_id, buffer, obj.ctype, 1)
 * 
 * def is_string(obj):             # <<<<<<<<<<<<<<
 * 
 *     if sys.version_info.major < 3:
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_1is_string(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_6opencl_6cl_mem_1is_string = {__Pyx_NAMESTR("is_string"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_1is_string, METH_O, __Pyx_DOCSTR(0)};
static PyObject *__pyx_pf_6opencl_6cl_mem_1is_string(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_v_builtins = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("is_string");
  __pyx_self = __pyx_self;

  /* "opencl/cl_mem.pyx":727
 * def is_string(obj):
 * 
 *     if sys.version_info.major < 3:             # <<<<<<<<<<<<<<
 *         import __builtin__ as builtins
 *         return isinstance(obj, (str, builtins.unicode))
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__sys); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__version_info); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__major); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_3, Py_LT); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 727; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":728
 * 
 *     if sys.version_info.major < 3:
 *         import __builtin__ as builtins             # <<<<<<<<<<<<<<
 *         return isinstance(obj, (str, builtins.unicode))
 *     else:
 */
    __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s____builtin__), 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 728; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_v_builtins = __pyx_t_2;
    __pyx_t_2 = 0;

    /* "opencl/cl_mem.pyx":729
 *     if sys.version_info.major < 3:
 *         import __builtin__ as builtins
 *         return isinstance(obj, (str, builtins.unicode))             # <<<<<<<<<<<<<<
 *     else:
 *         return isinstance(obj, (str,))
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_builtins, __pyx_n_s__unicode); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_1));
    __Pyx_INCREF(((PyObject *)((PyObject*)(&PyString_Type))));
    PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)((PyObject*)(&PyString_Type))));
    __Pyx_GIVEREF(((PyObject *)((PyObject*)(&PyString_Type))));
    PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_3 = PyObject_IsInstance(__pyx_v_obj, ((PyObject *)__pyx_t_1)); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyBool_FromLong(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":731
 *         return isinstance(obj, (str, builtins.unicode))
 *     else:
 *         return isinstance(obj, (str,))             # <<<<<<<<<<<<<<
 * 
 * def empty(context, shape, ctype='B'):
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_v_obj);
    __pyx_t_1 = __pyx_v_obj;
    __pyx_t_3 = PyString_Check(__pyx_t_1); 
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __Pyx_PyBool_FromLong(__pyx_t_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
  __pyx_L5:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("opencl.cl_mem.is_string", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_builtins);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":733
 *         return isinstance(obj, (str,))
 * 
 * def empty(context, shape, ctype='B'):             # <<<<<<<<<<<<<<
 *     '''
 *     empty(context, shape, ctype='B') -> view
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_2empty(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_2empty[] = "\n    empty(context, shape, ctype='B') -> view\n    \n    Create an empty buffer.\n    ";
static PyMethodDef __pyx_mdef_6opencl_6cl_mem_2empty = {__Pyx_NAMESTR("empty"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_2empty, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_2empty)};
static PyObject *__pyx_pf_6opencl_6cl_mem_2empty(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_context = 0;
  PyObject *__pyx_v_shape = 0;
  PyObject *__pyx_v_ctype = 0;
  cl_context __pyx_v_ctx;
  cl_mem_flags __pyx_v_flags;
  cl_int __pyx_v_err_code;
  PyObject *__pyx_v_format = NULL;
  size_t __pyx_v_itemsize;
  size_t __pyx_v_size;
  PyObject *__pyx_v_i = NULL;
  cl_mem __pyx_v_buffer_id;
  Py_buffer *__pyx_v_buffer;
  char *__pyx_v_tmp;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  size_t __pyx_t_5;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  char *__pyx_t_8;
  Py_ssize_t __pyx_t_9;
  Py_ssize_t __pyx_t_10;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__context,&__pyx_n_s__shape,&__pyx_n_s__ctype,0};
  __Pyx_RefNannySetupContext("empty");
  __pyx_self = __pyx_self;
  {
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)__pyx_n_s__B);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__context);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__shape);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("empty", 0, 2, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__ctype);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "empty") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_context = values[0];
    __pyx_v_shape = values[1];
    __pyx_v_ctype = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("empty", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.empty", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __Pyx_INCREF(__pyx_v_ctype);

  /* "opencl/cl_mem.pyx":739
 *     Create an empty buffer.
 *     '''
 *     if not CyContext_Check(context):             # <<<<<<<<<<<<<<
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 */
  __pyx_t_1 = (!__pyx_f_6opencl_7context_CyContext_Check(__pyx_v_context));
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":740
 *     '''
 *     if not CyContext_Check(context):
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_context ctx = CyContext_GetID(context)
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_34), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":742
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 *     cdef cl_context ctx = CyContext_GetID(context)             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_mem_flags flags = CL_MEM_READ_WRITE
 */
  __pyx_v_ctx = __pyx_f_6opencl_7context_CyContext_GetID(__pyx_v_context);

  /* "opencl/cl_mem.pyx":744
 *     cdef cl_context ctx = CyContext_GetID(context)
 * 
 *     cdef cl_mem_flags flags = CL_MEM_READ_WRITE             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_int err_code
 */
  __pyx_v_flags = CL_MEM_READ_WRITE;

  /* "opencl/cl_mem.pyx":748
 *     cdef cl_int err_code
 * 
 *     if is_string(ctype):             # <<<<<<<<<<<<<<
 *         format = ctype
 *         ctype = ctype_from_format(format)
 */
  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__is_string); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_INCREF(__pyx_v_ctype);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_ctype);
  __Pyx_GIVEREF(__pyx_v_ctype);
  __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":749
 * 
 *     if is_string(ctype):
 *         format = ctype             # <<<<<<<<<<<<<<
 *         ctype = ctype_from_format(format)
 *     else:
 */
    __Pyx_INCREF(__pyx_v_ctype);
    __pyx_v_format = __pyx_v_ctype;

    /* "opencl/cl_mem.pyx":750
 *     if is_string(ctype):
 *         format = ctype
 *         ctype = ctype_from_format(format)             # <<<<<<<<<<<<<<
 *     else:
 *         format = type_format(ctype)
 */
    __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__ctype_from_format); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(__pyx_v_format);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_format);
    __Pyx_GIVEREF(__pyx_v_format);
    __pyx_t_2 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 750; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_v_ctype);
    __pyx_v_ctype = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L7;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":752
 *         ctype = ctype_from_format(format)
 *     else:
 *         format = type_format(ctype)             # <<<<<<<<<<<<<<
 * 
 *     cdef size_t itemsize = size_from_format(format)
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__type_format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(__pyx_v_ctype);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_ctype);
    __Pyx_GIVEREF(__pyx_v_ctype);
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __pyx_v_format = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":754
 *         format = type_format(ctype)
 * 
 *     cdef size_t itemsize = size_from_format(format)             # <<<<<<<<<<<<<<
 *     cdef size_t size = itemsize
 *     for i in shape:
 */
  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__size_from_format); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_INCREF(__pyx_v_format);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_format);
  __Pyx_GIVEREF(__pyx_v_format);
  __pyx_t_2 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyInt_AsSize_t(__pyx_t_2); if (unlikely((__pyx_t_5 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 754; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_itemsize = __pyx_t_5;

  /* "opencl/cl_mem.pyx":755
 * 
 *     cdef size_t itemsize = size_from_format(format)
 *     cdef size_t size = itemsize             # <<<<<<<<<<<<<<
 *     for i in shape:
 *         size *= i
 */
  __pyx_v_size = __pyx_v_itemsize;

  /* "opencl/cl_mem.pyx":756
 *     cdef size_t itemsize = size_from_format(format)
 *     cdef size_t size = itemsize
 *     for i in shape:             # <<<<<<<<<<<<<<
 *         size *= i
 * 
 */
  if (PyList_CheckExact(__pyx_v_shape) || PyTuple_CheckExact(__pyx_v_shape)) {
    __pyx_t_2 = __pyx_v_shape; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_shape); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  for (;;) {
    if (PyList_CheckExact(__pyx_t_2)) {
      if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++;
    } else if (PyTuple_CheckExact(__pyx_t_2)) {
      if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++;
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 756; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "opencl/cl_mem.pyx":757
 *     cdef size_t size = itemsize
 *     for i in shape:
 *         size *= i             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_mem buffer_id = clCreateBuffer(ctx, flags, size, NULL, & err_code)
 */
    __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_size); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyNumber_InPlaceMultiply(__pyx_t_3, __pyx_v_i); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyInt_AsSize_t(__pyx_t_4); if (unlikely((__pyx_t_5 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 757; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_size = __pyx_t_5;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":759
 *         size *= i
 * 
 *     cdef cl_mem buffer_id = clCreateBuffer(ctx, flags, size, NULL, & err_code)             # <<<<<<<<<<<<<<
 * 
 *     if err_code != CL_SUCCESS:
 */
  __pyx_v_buffer_id = clCreateBuffer(__pyx_v_ctx, __pyx_v_flags, __pyx_v_size, NULL, (&__pyx_v_err_code));

  /* "opencl/cl_mem.pyx":761
 *     cdef cl_mem buffer_id = clCreateBuffer(ctx, flags, size, NULL, & err_code)
 * 
 *     if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *         raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":762
 * 
 *     if err_code != CL_SUCCESS:
 *         raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_4 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    __Pyx_Raise(__pyx_t_4, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 762; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L10;
  }
  __pyx_L10:;

  /* "opencl/cl_mem.pyx":764
 *         raise OpenCLException(err_code)
 * 
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 * 
 *     buffer.format = < char *> malloc(len(format) + 1)
 */
  __pyx_v_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":766
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 * 
 *     buffer.format = < char *> malloc(len(format) + 1)             # <<<<<<<<<<<<<<
 * 
 *     if is_string(format):
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_format); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 766; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_buffer->format = ((char *)malloc((__pyx_t_6 + 1)));

  /* "opencl/cl_mem.pyx":768
 *     buffer.format = < char *> malloc(len(format) + 1)
 * 
 *     if is_string(format):             # <<<<<<<<<<<<<<
 *         format = format.encode()
 * 
 */
  __pyx_t_4 = __Pyx_GetName(__pyx_m, __pyx_n_s__is_string); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_INCREF(__pyx_v_format);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_format);
  __Pyx_GIVEREF(__pyx_v_format);
  __pyx_t_2 = PyObject_Call(__pyx_t_4, ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 768; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":769
 * 
 *     if is_string(format):
 *         format = format.encode()             # <<<<<<<<<<<<<<
 * 
 *     cdef char * tmp = < char *> format
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_format, __pyx_n_s__encode); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 769; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_format);
    __pyx_v_format = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "opencl/cl_mem.pyx":771
 *         format = format.encode()
 * 
 *     cdef char * tmp = < char *> format             # <<<<<<<<<<<<<<
 *     strcpy(buffer.format, tmp)
 *     buffer.buf = NULL
 */
  __pyx_t_8 = PyBytes_AsString(__pyx_v_format); if (unlikely((!__pyx_t_8) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 771; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_tmp = ((char *)__pyx_t_8);

  /* "opencl/cl_mem.pyx":772
 * 
 *     cdef char * tmp = < char *> format
 *     strcpy(buffer.format, tmp)             # <<<<<<<<<<<<<<
 *     buffer.buf = NULL
 *     buffer.readonly = 0
 */
  strcpy(__pyx_v_buffer->format, __pyx_v_tmp);

  /* "opencl/cl_mem.pyx":773
 *     cdef char * tmp = < char *> format
 *     strcpy(buffer.format, tmp)
 *     buffer.buf = NULL             # <<<<<<<<<<<<<<
 *     buffer.readonly = 0
 *     buffer.itemsize = itemsize
 */
  __pyx_v_buffer->buf = NULL;

  /* "opencl/cl_mem.pyx":774
 *     strcpy(buffer.format, tmp)
 *     buffer.buf = NULL
 *     buffer.readonly = 0             # <<<<<<<<<<<<<<
 *     buffer.itemsize = itemsize
 *     buffer.ndim = len(shape)
 */
  __pyx_v_buffer->readonly = 0;

  /* "opencl/cl_mem.pyx":775
 *     buffer.buf = NULL
 *     buffer.readonly = 0
 *     buffer.itemsize = itemsize             # <<<<<<<<<<<<<<
 *     buffer.ndim = len(shape)
 * 
 */
  __pyx_v_buffer->itemsize = __pyx_v_itemsize;

  /* "opencl/cl_mem.pyx":776
 *     buffer.readonly = 0
 *     buffer.itemsize = itemsize
 *     buffer.ndim = len(shape)             # <<<<<<<<<<<<<<
 * 
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 */
  __pyx_t_6 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_6 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_buffer->ndim = __pyx_t_6;

  /* "opencl/cl_mem.pyx":778
 *     buffer.ndim = len(shape)
 * 
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.suboffsets = NULL
 */
  __pyx_v_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":779
 * 
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *     buffer.suboffsets = NULL
 * 
 */
  __pyx_v_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":780
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *     for i in range(buffer.ndim):
 */
  __pyx_v_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":782
 *     buffer.suboffsets = NULL
 * 
 *     for i in range(buffer.ndim):             # <<<<<<<<<<<<<<
 *         buffer.shape[i] = shape[i]
 * 
 */
  __pyx_t_3 = PyInt_FromLong(__pyx_v_buffer->ndim); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_2)) {
      if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++;
    } else if (PyTuple_CheckExact(__pyx_t_2)) {
      if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_3); __pyx_t_6++;
    } else {
      __pyx_t_3 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_3;
    __pyx_t_3 = 0;

    /* "opencl/cl_mem.pyx":783
 * 
 *     for i in range(buffer.ndim):
 *         buffer.shape[i] = shape[i]             # <<<<<<<<<<<<<<
 * 
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')
 */
    __pyx_t_3 = PyObject_GetItem(__pyx_v_shape, __pyx_v_i); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_10 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_10 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 783; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    (__pyx_v_buffer->shape[__pyx_t_10]) = __pyx_t_9;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":785
 *         buffer.shape[i] = shape[i]
 * 
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')             # <<<<<<<<<<<<<<
 * 
 *     return CyView_Create(buffer_id, buffer, ctype, 0)
 */
  PyBuffer_FillContiguousStrides(__pyx_v_buffer->ndim, __pyx_v_buffer->shape, __pyx_v_buffer->strides, __pyx_v_buffer->itemsize, 'C');

  /* "opencl/cl_mem.pyx":787
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')
 * 
 *     return CyView_Create(buffer_id, buffer, ctype, 0)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __pyx_f_6opencl_6cl_mem_CyView_Create(__pyx_v_buffer_id, __pyx_v_buffer, __pyx_v_ctype, 0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.empty", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_format);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XDECREF(__pyx_v_ctype);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":865
 * 
 *     @classmethod
 *     def supported_formats(cls, context, readable=True, wirteable=True):             # <<<<<<<<<<<<<<
 * 
 *         if not CyContext_Check(context):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_supported_formats(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_supported_formats(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_context = 0;
  PyObject *__pyx_v_readable = 0;
  PyObject *__pyx_v_wirteable = 0;
  cl_mem_flags __pyx_v_flags;
  cl_context __pyx_v_ctx;
  cl_int __pyx_v_err_code;
  cl_image_format *__pyx_v_image_formats;
  cl_uint __pyx_v_num_image_formats;
  cl_mem_object_type __pyx_v_image_type;
  PyObject *__pyx_v_image_format_list = NULL;
  struct __pyx_obj_6opencl_6cl_mem_ImageFormat *__pyx_v_fmt = 0;
  cl_uint __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  cl_uint __pyx_t_7;
  cl_uint __pyx_t_8;
  int __pyx_t_9;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__context,&__pyx_n_s__readable,&__pyx_n_s__wirteable,0};
  __Pyx_RefNannySetupContext("supported_formats");
  {
    PyObject* values[3] = {0,0,0};
    values[1] = __pyx_k_35;
    values[2] = __pyx_k_36;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__context);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__readable);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__wirteable);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "supported_formats") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_context = values[0];
    __pyx_v_readable = values[1];
    __pyx_v_wirteable = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("supported_formats", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.supported_formats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":867
 *     def supported_formats(cls, context, readable=True, wirteable=True):
 * 
 *         if not CyContext_Check(context):             # <<<<<<<<<<<<<<
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 */
  __pyx_t_1 = (!__pyx_f_6opencl_7context_CyContext_Check(__pyx_v_context));
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":868
 * 
 *         if not CyContext_Check(context):
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem_flags flags
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_37), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":872
 *         cdef cl_mem_flags flags
 * 
 *         if readable and wirteable:             # <<<<<<<<<<<<<<
 *             flags = CL_MEM_READ_WRITE
 *         elif not (readable ^ wirteable):
 */
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_readable); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 872; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {
    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_wirteable); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 872; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_4 = __pyx_t_3;
  } else {
    __pyx_t_4 = __pyx_t_1;
  }
  if (__pyx_t_4) {

    /* "opencl/cl_mem.pyx":873
 * 
 *         if readable and wirteable:
 *             flags = CL_MEM_READ_WRITE             # <<<<<<<<<<<<<<
 *         elif not (readable ^ wirteable):
 *             raise TypeError("al least one of readable or wirteable must be True")
 */
    __pyx_v_flags = CL_MEM_READ_WRITE;
    goto __pyx_L7;
  }

  /* "opencl/cl_mem.pyx":874
 *         if readable and wirteable:
 *             flags = CL_MEM_READ_WRITE
 *         elif not (readable ^ wirteable):             # <<<<<<<<<<<<<<
 *             raise TypeError("al least one of readable or wirteable must be True")
 *         elif readable:
 */
  __pyx_t_2 = PyNumber_Xor(__pyx_v_readable, __pyx_v_wirteable); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 874; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = (!__pyx_t_4);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":875
 *             flags = CL_MEM_READ_WRITE
 *         elif not (readable ^ wirteable):
 *             raise TypeError("al least one of readable or wirteable must be True")             # <<<<<<<<<<<<<<
 *         elif readable:
 *             flags = CL_MEM_READ_ONLY
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_39), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }

  /* "opencl/cl_mem.pyx":876
 *         elif not (readable ^ wirteable):
 *             raise TypeError("al least one of readable or wirteable must be True")
 *         elif readable:             # <<<<<<<<<<<<<<
 *             flags = CL_MEM_READ_ONLY
 *         else:
 */
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_v_readable); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":877
 *             raise TypeError("al least one of readable or wirteable must be True")
 *         elif readable:
 *             flags = CL_MEM_READ_ONLY             # <<<<<<<<<<<<<<
 *         else:
 *             flags = CL_MEM_WRITE_ONLY
 */
    __pyx_v_flags = CL_MEM_READ_ONLY;
    goto __pyx_L7;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":879
 *             flags = CL_MEM_READ_ONLY
 *         else:
 *             flags = CL_MEM_WRITE_ONLY             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_context ctx = CyContext_GetID(context)
 */
    __pyx_v_flags = CL_MEM_WRITE_ONLY;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":881
 *             flags = CL_MEM_WRITE_ONLY
 * 
 *         cdef cl_context ctx = CyContext_GetID(context)             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_int err_code
 */
  __pyx_v_ctx = __pyx_f_6opencl_7context_CyContext_GetID(__pyx_v_context);

  /* "opencl/cl_mem.pyx":886
 *         cdef cl_image_format * image_formats
 *         cdef cl_uint num_image_formats
 *         cdef cl_mem_object_type image_type = CL_MEM_OBJECT_IMAGE2D             # <<<<<<<<<<<<<<
 * 
 *         err_code = clGetSupportedImageFormats(ctx, flags, image_type, 0, NULL, & num_image_formats)
 */
  __pyx_v_image_type = CL_MEM_OBJECT_IMAGE2D;

  /* "opencl/cl_mem.pyx":888
 *         cdef cl_mem_object_type image_type = CL_MEM_OBJECT_IMAGE2D
 * 
 *         err_code = clGetSupportedImageFormats(ctx, flags, image_type, 0, NULL, & num_image_formats)             # <<<<<<<<<<<<<<
 * 
 *         if err_code != CL_SUCCESS:
 */
  __pyx_v_err_code = clGetSupportedImageFormats(__pyx_v_ctx, __pyx_v_flags, __pyx_v_image_type, 0, NULL, (&__pyx_v_num_image_formats));

  /* "opencl/cl_mem.pyx":890
 *         err_code = clGetSupportedImageFormats(ctx, flags, image_type, 0, NULL, & num_image_formats)
 * 
 *         if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *             raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":891
 * 
 *         if err_code != CL_SUCCESS:
 *             raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *         image_formats = < cl_image_format *> malloc(sizeof(cl_image_format) * num_image_formats)
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));
    PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 891; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "opencl/cl_mem.pyx":893
 *             raise OpenCLException(err_code)
 * 
 *         image_formats = < cl_image_format *> malloc(sizeof(cl_image_format) * num_image_formats)             # <<<<<<<<<<<<<<
 * 
 *         err_code = clGetSupportedImageFormats(ctx, flags, image_type, num_image_formats, image_formats, NULL)
 */
  __pyx_v_image_formats = ((cl_image_format *)malloc(((sizeof(cl_image_format)) * __pyx_v_num_image_formats)));

  /* "opencl/cl_mem.pyx":895
 *         image_formats = < cl_image_format *> malloc(sizeof(cl_image_format) * num_image_formats)
 * 
 *         err_code = clGetSupportedImageFormats(ctx, flags, image_type, num_image_formats, image_formats, NULL)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_v_err_code = clGetSupportedImageFormats(__pyx_v_ctx, __pyx_v_flags, __pyx_v_image_type, __pyx_v_num_image_formats, __pyx_v_image_formats, NULL);

  /* "opencl/cl_mem.pyx":898
 * 
 * 
 *         if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *             free(image_formats)
 *             raise OpenCLException(err_code)
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":899
 * 
 *         if err_code != CL_SUCCESS:
 *             free(image_formats)             # <<<<<<<<<<<<<<
 *             raise OpenCLException(err_code)
 * 
 */
    free(__pyx_v_image_formats);

    /* "opencl/cl_mem.pyx":900
 *         if err_code != CL_SUCCESS:
 *             free(image_formats)
 *             raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_5 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_t_5, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L9;
  }
  __pyx_L9:;

  /* "opencl/cl_mem.pyx":903
 * 
 * 
 *         image_format_list = []             # <<<<<<<<<<<<<<
 * 
 *         cdef ImageFormat fmt
 */
  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 903; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_6));
  __pyx_v_image_format_list = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "opencl/cl_mem.pyx":906
 * 
 *         cdef ImageFormat fmt
 *         for i in range(num_image_formats):             # <<<<<<<<<<<<<<
 *             fmt = CyImageFormat_New(image_formats[i])
 *             image_format_list.append(fmt)
 */
  __pyx_t_7 = __pyx_v_num_image_formats;
  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;

    /* "opencl/cl_mem.pyx":907
 *         cdef ImageFormat fmt
 *         for i in range(num_image_formats):
 *             fmt = CyImageFormat_New(image_formats[i])             # <<<<<<<<<<<<<<
 *             image_format_list.append(fmt)
 * 
 */
    __pyx_t_6 = __pyx_f_6opencl_6cl_mem_CyImageFormat_New((__pyx_v_image_formats[__pyx_v_i])); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_6opencl_6cl_mem_ImageFormat))))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 907; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_XDECREF(((PyObject *)__pyx_v_fmt));
    __pyx_v_fmt = ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_t_6);
    __pyx_t_6 = 0;

    /* "opencl/cl_mem.pyx":908
 *         for i in range(num_image_formats):
 *             fmt = CyImageFormat_New(image_formats[i])
 *             image_format_list.append(fmt)             # <<<<<<<<<<<<<<
 * 
 *         free(image_formats)
 */
    if (unlikely(((PyObject *)__pyx_v_image_format_list) == Py_None)) {
      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 908; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_9 = PyList_Append(__pyx_v_image_format_list, ((PyObject *)__pyx_v_fmt)); if (unlikely(__pyx_t_9 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 908; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "opencl/cl_mem.pyx":910
 *             image_format_list.append(fmt)
 * 
 *         free(image_formats)             # <<<<<<<<<<<<<<
 * 
 *         return image_format_list
 */
  free(__pyx_v_image_formats);

  /* "opencl/cl_mem.pyx":912
 *         free(image_formats)
 * 
 *         return image_format_list             # <<<<<<<<<<<<<<
 * 
 *     @classmethod
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_image_format_list));
  __pyx_r = ((PyObject *)__pyx_v_image_format_list);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.supported_formats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_image_format_list);
  __Pyx_XDECREF((PyObject *)__pyx_v_fmt);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":915
 * 
 *     @classmethod
 *     def from_ctype(cls, format):             # <<<<<<<<<<<<<<
 * 
 *         cdef ImageFormat fmt
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_1from_ctype(PyObject *__pyx_v_cls, PyObject *__pyx_v_format); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_1from_ctype(PyObject *__pyx_v_cls, PyObject *__pyx_v_format) {
  struct __pyx_obj_6opencl_6cl_mem_ImageFormat *__pyx_v_fmt = 0;
  PyObject *__pyx_v_cl_order = NULL;
  PyObject *__pyx_v_order = NULL;
  PyObject *__pyx_v_cl_dtype = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_expected_format = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  Py_ssize_t __pyx_t_6;
  PyObject *(*__pyx_t_7)(PyObject *);
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  PyObject *(*__pyx_t_10)(PyObject *);
  Py_ssize_t __pyx_t_11;
  PyObject *(*__pyx_t_12)(PyObject *);
  PyObject *__pyx_t_13 = NULL;
  cl_channel_type __pyx_t_14;
  cl_channel_order __pyx_t_15;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("from_ctype");
  __Pyx_INCREF(__pyx_v_format);

  /* "opencl/cl_mem.pyx":919
 *         cdef ImageFormat fmt
 * 
 *         if not is_string(format):             # <<<<<<<<<<<<<<
 *             format = type_format(format)
 * 
 */
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__is_string); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_format);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_format);
  __Pyx_GIVEREF(__pyx_v_format);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 919; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = (!__pyx_t_4);
  if (__pyx_t_5) {

    /* "opencl/cl_mem.pyx":920
 * 
 *         if not is_string(format):
 *             format = type_format(format)             # <<<<<<<<<<<<<<
 * 
 *         for cl_order, order in cls._CHANNEL_ORDER_CTYPE_MAP.items():
 */
    __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__type_format); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_v_format);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_format);
    __Pyx_GIVEREF(__pyx_v_format);
    __pyx_t_1 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 920; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_DECREF(__pyx_v_format);
    __pyx_v_format = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":922
 *             format = type_format(format)
 * 
 *         for cl_order, order in cls._CHANNEL_ORDER_CTYPE_MAP.items():             # <<<<<<<<<<<<<<
 *             for cl_dtype, dtype in cls._CHANNEL_CTYPE_MAP.items():
 *                 expected_format = order % dict(dtype=dtype)
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_cls, __pyx_n_s_40); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__items); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_2)) {
      if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++;
    } else if (PyTuple_CheckExact(__pyx_t_2)) {
      if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++;
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      if (likely(PyTuple_CheckExact(sequence))) {
        if (unlikely(PyTuple_GET_SIZE(sequence) != 2)) {
          if (PyTuple_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
          else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_8 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        if (unlikely(PyList_GET_SIZE(sequence) != 2)) {
          if (PyList_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
          else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_8 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_3);
      index = 1; __pyx_t_8 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_8)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_8);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_9), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
      if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 922; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_L9_unpacking_done:;
    }
    __Pyx_XDECREF(__pyx_v_cl_order);
    __pyx_v_cl_order = __pyx_t_3;
    __pyx_t_3 = 0;
    __Pyx_XDECREF(__pyx_v_order);
    __pyx_v_order = __pyx_t_8;
    __pyx_t_8 = 0;

    /* "opencl/cl_mem.pyx":923
 * 
 *         for cl_order, order in cls._CHANNEL_ORDER_CTYPE_MAP.items():
 *             for cl_dtype, dtype in cls._CHANNEL_CTYPE_MAP.items():             # <<<<<<<<<<<<<<
 *                 expected_format = order % dict(dtype=dtype)
 * 
 */
    __pyx_t_1 = PyObject_GetAttr(__pyx_v_cls, __pyx_n_s___CHANNEL_CTYPE_MAP); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_8 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__items); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = PyObject_Call(__pyx_t_8, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
    if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
      __pyx_t_8 = __pyx_t_1; __Pyx_INCREF(__pyx_t_8); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
    } else {
      __pyx_t_11 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_12 = Py_TYPE(__pyx_t_8)->tp_iternext;
    }
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (PyList_CheckExact(__pyx_t_8)) {
        if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_8)) break;
        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_11); __Pyx_INCREF(__pyx_t_1); __pyx_t_11++;
      } else if (PyTuple_CheckExact(__pyx_t_8)) {
        if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_11); __Pyx_INCREF(__pyx_t_1); __pyx_t_11++;
      } else {
        __pyx_t_1 = __pyx_t_12(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          if (PyErr_Occurred()) {
            if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
            else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          break;
        }
        __Pyx_GOTREF(__pyx_t_1);
      }
      if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
        PyObject* sequence = __pyx_t_1;
        if (likely(PyTuple_CheckExact(sequence))) {
          if (unlikely(PyTuple_GET_SIZE(sequence) != 2)) {
            if (PyTuple_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
            else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
          __pyx_t_9 = PyTuple_GET_ITEM(sequence, 1); 
        } else {
          if (unlikely(PyList_GET_SIZE(sequence) != 2)) {
            if (PyList_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
            else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
            {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
          }
          __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
          __pyx_t_9 = PyList_GET_ITEM(sequence, 1); 
        }
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_9);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_13 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_13);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_10 = Py_TYPE(__pyx_t_13)->tp_iternext;
        index = 0; __pyx_t_3 = __pyx_t_10(__pyx_t_13); if (unlikely(!__pyx_t_3)) goto __pyx_L12_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_3);
        index = 1; __pyx_t_9 = __pyx_t_10(__pyx_t_13); if (unlikely(!__pyx_t_9)) goto __pyx_L12_unpacking_failed;
        __Pyx_GOTREF(__pyx_t_9);
        if (__Pyx_IternextUnpackEndCheck(__pyx_t_10(__pyx_t_13), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
        goto __pyx_L13_unpacking_done;
        __pyx_L12_unpacking_failed:;
        __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
        if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
        if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 923; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_L13_unpacking_done:;
      }
      __Pyx_XDECREF(__pyx_v_cl_dtype);
      __pyx_v_cl_dtype = __pyx_t_3;
      __pyx_t_3 = 0;
      __Pyx_XDECREF(__pyx_v_dtype);
      __pyx_v_dtype = __pyx_t_9;
      __pyx_t_9 = 0;

      /* "opencl/cl_mem.pyx":924
 *         for cl_order, order in cls._CHANNEL_ORDER_CTYPE_MAP.items():
 *             for cl_dtype, dtype in cls._CHANNEL_CTYPE_MAP.items():
 *                 expected_format = order % dict(dtype=dtype)             # <<<<<<<<<<<<<<
 * 
 *                 if format == expected_format:
 */
      __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(((PyObject *)__pyx_t_1));
      if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_v_dtype) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_9 = PyNumber_Remainder(__pyx_v_order, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 924; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
      __Pyx_XDECREF(__pyx_v_expected_format);
      __pyx_v_expected_format = __pyx_t_9;
      __pyx_t_9 = 0;

      /* "opencl/cl_mem.pyx":926
 *                 expected_format = order % dict(dtype=dtype)
 * 
 *                 if format == expected_format:             # <<<<<<<<<<<<<<
 *                     fmt = ImageFormat.__new__(ImageFormat)
 *                     fmt.cl_format.image_channel_data_type = cl_dtype
 */
      __pyx_t_9 = PyObject_RichCompare(__pyx_v_format, __pyx_v_expected_format, Py_EQ); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 926; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_5 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 926; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (__pyx_t_5) {

        /* "opencl/cl_mem.pyx":927
 * 
 *                 if format == expected_format:
 *                     fmt = ImageFormat.__new__(ImageFormat)             # <<<<<<<<<<<<<<
 *                     fmt.cl_format.image_channel_data_type = cl_dtype
 *                     fmt.cl_format.image_channel_order = cl_order
 */
        __pyx_t_9 = __Pyx_tp_new(((PyObject*)__pyx_ptype_6opencl_6cl_mem_ImageFormat)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 927; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        if (!(likely(__Pyx_TypeTest(__pyx_t_9, __pyx_ptype_6opencl_6cl_mem_ImageFormat)))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 927; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_v_fmt = ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_t_9);
        __pyx_t_9 = 0;

        /* "opencl/cl_mem.pyx":928
 *                 if format == expected_format:
 *                     fmt = ImageFormat.__new__(ImageFormat)
 *                     fmt.cl_format.image_channel_data_type = cl_dtype             # <<<<<<<<<<<<<<
 *                     fmt.cl_format.image_channel_order = cl_order
 *                     return fmt
 */
        __pyx_t_14 = __Pyx_PyInt_from_py_uint32_t(__pyx_v_cl_dtype); if (unlikely((__pyx_t_14 == (cl_channel_type)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 928; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_v_fmt->cl_format.image_channel_data_type = __pyx_t_14;

        /* "opencl/cl_mem.pyx":929
 *                     fmt = ImageFormat.__new__(ImageFormat)
 *                     fmt.cl_format.image_channel_data_type = cl_dtype
 *                     fmt.cl_format.image_channel_order = cl_order             # <<<<<<<<<<<<<<
 *                     return fmt
 *         else:
 */
        __pyx_t_15 = __Pyx_PyInt_from_py_uint32_t(__pyx_v_cl_order); if (unlikely((__pyx_t_15 == (cl_channel_order)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 929; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_v_fmt->cl_format.image_channel_order = __pyx_t_15;

        /* "opencl/cl_mem.pyx":930
 *                     fmt.cl_format.image_channel_data_type = cl_dtype
 *                     fmt.cl_format.image_channel_order = cl_order
 *                     return fmt             # <<<<<<<<<<<<<<
 *         else:
 *             raise TypeError("Could not create opencl image format from ctype format specifier (got %r)" % (format,))
 */
        __Pyx_XDECREF(__pyx_r);
        __Pyx_INCREF(((PyObject *)__pyx_v_fmt));
        __pyx_r = ((PyObject *)__pyx_v_fmt);
        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        goto __pyx_L0;
        goto __pyx_L14;
      }
      __pyx_L14:;
    }
    __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":932
 *                     return fmt
 *         else:
 *             raise TypeError("Could not create opencl image format from ctype format specifier (got %r)" % (format,))             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self, str order, str dtype):
 */
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_8));
    __Pyx_INCREF(__pyx_v_format);
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_format);
    __Pyx_GIVEREF(__pyx_v_format);
    __pyx_t_9 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_41), ((PyObject *)__pyx_t_8)); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_9));
    __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_8));
    PyTuple_SET_ITEM(__pyx_t_8, 0, ((PyObject *)__pyx_t_9));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_9));
    __pyx_t_9 = 0;
    __pyx_t_9 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_8), NULL); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_9);
    __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __Pyx_Raise(__pyx_t_9, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 932; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_XDECREF(__pyx_t_13);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.from_ctype", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_fmt);
  __Pyx_XDECREF(__pyx_v_cl_order);
  __Pyx_XDECREF(__pyx_v_order);
  __Pyx_XDECREF(__pyx_v_cl_dtype);
  __Pyx_XDECREF(__pyx_v_dtype);
  __Pyx_XDECREF(__pyx_v_expected_format);
  __Pyx_XDECREF(__pyx_v_format);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":934
 *             raise TypeError("Could not create opencl image format from ctype format specifier (got %r)" % (format,))
 * 
 *     def __init__(self, str order, str dtype):             # <<<<<<<<<<<<<<
 * 
 *         order_lookup = dict([(value, key) for key, value in self.CHANNEL_ORDERS.items()])
 */

static int __pyx_pf_6opencl_6cl_mem_11ImageFormat_2__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_11ImageFormat_2__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_order = 0;
  PyObject *__pyx_v_dtype = 0;
  PyObject *__pyx_v_order_lookup = NULL;
  PyObject *__pyx_v_dtype_lookup = NULL;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_value = NULL;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  Py_ssize_t __pyx_t_4;
  PyObject *(*__pyx_t_5)(PyObject *);
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyObject *__pyx_t_8 = NULL;
  PyObject *(*__pyx_t_9)(PyObject *);
  cl_channel_order __pyx_t_10;
  cl_channel_type __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__order,&__pyx_n_s__dtype,0};
  __Pyx_RefNannySetupContext("__init__");
  {
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__order);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__dtype);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_order = ((PyObject*)values[0]);
    __pyx_v_dtype = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_order), (&PyString_Type), 1, "order", 1))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dtype), (&PyString_Type), 1, "dtype", 1))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 934; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "opencl/cl_mem.pyx":936
 *     def __init__(self, str order, str dtype):
 * 
 *         order_lookup = dict([(value, key) for key, value in self.CHANNEL_ORDERS.items()])             # <<<<<<<<<<<<<<
 *         self.cl_format.image_channel_order = order_lookup[order]
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__CHANNEL_ORDERS); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__items); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_Call(__pyx_t_3, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyList_CheckExact(__pyx_t_2) || PyTuple_CheckExact(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_3)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_3)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
      __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_2); __pyx_t_4++;
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_2);
    }
    if ((likely(PyTuple_CheckExact(__pyx_t_2))) || (PyList_CheckExact(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      if (likely(PyTuple_CheckExact(sequence))) {
        if (unlikely(PyTuple_GET_SIZE(sequence) != 2)) {
          if (PyTuple_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
          else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_7 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        if (unlikely(PyList_GET_SIZE(sequence) != 2)) {
          if (PyList_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
          else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_7 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext;
      index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_6)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_6);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L8_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_7);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_8), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
      if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_L9_unpacking_done:;
    }
    __Pyx_XDECREF(__pyx_v_key);
    __pyx_v_key = __pyx_t_6;
    __pyx_t_6 = 0;
    __Pyx_XDECREF(__pyx_v_value);
    __pyx_v_value = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    __Pyx_INCREF(__pyx_v_value);
    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_value);
    __Pyx_GIVEREF(__pyx_v_value);
    __Pyx_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    if (unlikely(PyList_Append(__pyx_t_1, (PyObject*)__pyx_t_2))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_t_1));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyDict_Type))), ((PyObject *)__pyx_t_3), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 936; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_v_order_lookup = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":937
 * 
 *         order_lookup = dict([(value, key) for key, value in self.CHANNEL_ORDERS.items()])
 *         self.cl_format.image_channel_order = order_lookup[order]             # <<<<<<<<<<<<<<
 * 
 *         dtype_lookup = dict([(value, key) for key, value in self.CHANNEL_DTYPES.items()])
 */
  __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_order_lookup), ((PyObject *)__pyx_v_order)); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 937; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_10 = __Pyx_PyInt_from_py_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_10 == (cl_channel_order)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 937; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_order = __pyx_t_10;

  /* "opencl/cl_mem.pyx":939
 *         self.cl_format.image_channel_order = order_lookup[order]
 * 
 *         dtype_lookup = dict([(value, key) for key, value in self.CHANNEL_DTYPES.items()])             # <<<<<<<<<<<<<<
 *         self.cl_format.image_channel_data_type = dtype_lookup[dtype]
 * 
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__CHANNEL_DTYPES); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__items); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyList_CheckExact(__pyx_t_3) || PyTuple_CheckExact(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; __Pyx_INCREF(__pyx_t_2); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_5 = Py_TYPE(__pyx_t_2)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_2)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_3 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_2)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
      __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_4); __Pyx_INCREF(__pyx_t_3); __pyx_t_4++;
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_3);
    }
    if ((likely(PyTuple_CheckExact(__pyx_t_3))) || (PyList_CheckExact(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      if (likely(PyTuple_CheckExact(sequence))) {
        if (unlikely(PyTuple_GET_SIZE(sequence) != 2)) {
          if (PyTuple_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
          else __Pyx_RaiseNeedMoreValuesError(PyTuple_GET_SIZE(sequence));
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
        __pyx_t_6 = PyTuple_GET_ITEM(sequence, 1); 
      } else {
        if (unlikely(PyList_GET_SIZE(sequence) != 2)) {
          if (PyList_GET_SIZE(sequence) > 2) __Pyx_RaiseTooManyValuesError(2);
          else __Pyx_RaiseNeedMoreValuesError(PyList_GET_SIZE(sequence));
          {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
        __pyx_t_6 = PyList_GET_ITEM(sequence, 1); 
      }
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext;
      index = 0; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L12_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_7);
      index = 1; __pyx_t_6 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_6)) goto __pyx_L12_unpacking_failed;
      __Pyx_GOTREF(__pyx_t_6);
      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_8), 2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L13_unpacking_done;
      __pyx_L12_unpacking_failed:;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      if (PyErr_Occurred() && PyErr_ExceptionMatches(PyExc_StopIteration)) PyErr_Clear();
      if (!PyErr_Occurred()) __Pyx_RaiseNeedMoreValuesError(index);
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_L13_unpacking_done:;
    }
    __Pyx_XDECREF(__pyx_v_key);
    __pyx_v_key = __pyx_t_7;
    __pyx_t_7 = 0;
    __Pyx_XDECREF(__pyx_v_value);
    __pyx_v_value = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(__pyx_v_value);
    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_value);
    __Pyx_GIVEREF(__pyx_v_value);
    __Pyx_INCREF(__pyx_v_key);
    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_key);
    __Pyx_GIVEREF(__pyx_v_key);
    if (unlikely(PyList_Append(__pyx_t_1, (PyObject*)__pyx_t_3))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(((PyObject *)__pyx_t_1));
  PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_1));
  __Pyx_GIVEREF(((PyObject *)__pyx_t_1));
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)(&PyDict_Type))), ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 939; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_v_dtype_lookup = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":940
 * 
 *         dtype_lookup = dict([(value, key) for key, value in self.CHANNEL_DTYPES.items()])
 *         self.cl_format.image_channel_data_type = dtype_lookup[dtype]             # <<<<<<<<<<<<<<
 * 
 *     property format:
 */
  __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject *)__pyx_v_dtype_lookup), ((PyObject *)__pyx_v_dtype)); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_11 = __Pyx_PyInt_from_py_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_11 == (cl_channel_type)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 940; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_data_type = __pyx_t_11;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_order_lookup);
  __Pyx_XDECREF(__pyx_v_dtype_lookup);
  __Pyx_XDECREF(__pyx_v_key);
  __Pyx_XDECREF(__pyx_v_value);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":943
 * 
 *     property format:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             type_format = self._CHANNEL_CTYPE_MAP[self.cl_format.image_channel_data_type]
 *             type_struct = self._CHANNEL_ORDER_CTYPE_MAP[self.cl_format.image_channel_order]
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_6format___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_6format___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_type_format = NULL;
  PyObject *__pyx_v_type_struct = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":944
 *     property format:
 *         def __get__(self):
 *             type_format = self._CHANNEL_CTYPE_MAP[self.cl_format.image_channel_data_type]             # <<<<<<<<<<<<<<
 *             type_struct = self._CHANNEL_ORDER_CTYPE_MAP[self.cl_format.image_channel_order]
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s___CHANNEL_CTYPE_MAP); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 944; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_data_type, sizeof(cl_channel_type)+1, __Pyx_PyInt_to_py_uint32_t); if (!__pyx_t_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 944; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_type_format = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":945
 *         def __get__(self):
 *             type_format = self._CHANNEL_CTYPE_MAP[self.cl_format.image_channel_data_type]
 *             type_struct = self._CHANNEL_ORDER_CTYPE_MAP[self.cl_format.image_channel_order]             # <<<<<<<<<<<<<<
 * 
 *             return type_struct % dict(dtype=type_format)
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s_40); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_order, sizeof(cl_channel_order)+1, __Pyx_PyInt_to_py_uint32_t); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 945; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_type_struct = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":947
 *             type_struct = self._CHANNEL_ORDER_CTYPE_MAP[self.cl_format.image_channel_order]
 * 
 *             return type_struct % dict(dtype=type_format)             # <<<<<<<<<<<<<<
 * 
 *     property ctype:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 947; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  if (PyDict_SetItem(__pyx_t_1, ((PyObject *)__pyx_n_s__dtype), __pyx_v_type_format) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 947; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_2 = PyNumber_Remainder(__pyx_v_type_struct, ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 947; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.format.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_type_format);
  __Pyx_XDECREF(__pyx_v_type_struct);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":950
 * 
 *     property ctype:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             format = self.format
 *             return ctype_from_format(format, struct_name=self.CHANNEL_ORDERS[self.channel_order])
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_5ctype___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_5ctype___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_format = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":951
 *     property ctype:
 *         def __get__(self):
 *             format = self.format             # <<<<<<<<<<<<<<
 *             return ctype_from_format(format, struct_name=self.CHANNEL_ORDERS[self.channel_order])
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__format); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 951; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_format = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":952
 *         def __get__(self):
 *             format = self.format
 *             return ctype_from_format(format, struct_name=self.CHANNEL_ORDERS[self.channel_order])             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_GetName(__pyx_m, __pyx_n_s__ctype_from_format); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_format);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_format);
  __Pyx_GIVEREF(__pyx_v_format);
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __pyx_t_4 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__CHANNEL_ORDERS); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__channel_order); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyObject_GetItem(__pyx_t_4, __pyx_t_5); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, ((PyObject *)__pyx_n_s__struct_name), __pyx_t_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyEval_CallObjectWithKeywords(__pyx_t_1, ((PyObject *)__pyx_t_2), ((PyObject *)__pyx_t_3)); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 952; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.ctype.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_format);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":956
 * 
 *     property channel_order:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.cl_format.image_channel_order
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_13channel_order___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_13channel_order___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":957
 *     property channel_order:
 *         def __get__(self):
 *             return self.cl_format.image_channel_order             # <<<<<<<<<<<<<<
 * 
 *     property channel_data_type:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_to_py_uint32_t(((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_order); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 957; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.channel_order.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":960
 * 
 *     property channel_data_type:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self.cl_format.image_channel_data_type
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_17channel_data_type___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_17channel_data_type___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":961
 *     property channel_data_type:
 *         def __get__(self):
 *             return self.cl_format.image_channel_data_type             # <<<<<<<<<<<<<<
 * 
 *     def __repr__(self):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = __Pyx_PyInt_to_py_uint32_t(((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_data_type); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 961; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.channel_data_type.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":963
 *             return self.cl_format.image_channel_data_type
 * 
 *     def __repr__(self):             # <<<<<<<<<<<<<<
 *         order = self.CHANNEL_ORDERS[self.channel_order]
 *         dtype = self.CHANNEL_DTYPES[self.channel_data_type]
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_order = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__repr__");

  /* "opencl/cl_mem.pyx":964
 * 
 *     def __repr__(self):
 *         order = self.CHANNEL_ORDERS[self.channel_order]             # <<<<<<<<<<<<<<
 *         dtype = self.CHANNEL_DTYPES[self.channel_data_type]
 * 
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__CHANNEL_ORDERS); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__channel_order); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyObject_GetItem(__pyx_t_1, __pyx_t_2); if (!__pyx_t_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 964; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_order = __pyx_t_3;
  __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":965
 *     def __repr__(self):
 *         order = self.CHANNEL_ORDERS[self.channel_order]
 *         dtype = self.CHANNEL_DTYPES[self.channel_data_type]             # <<<<<<<<<<<<<<
 * 
 *         return "<ImageFormat channel_order=%r channel_data_type=%r>" % (order, dtype)
 */
  __pyx_t_3 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__CHANNEL_DTYPES); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 965; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_self, __pyx_n_s__channel_data_type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 965; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyObject_GetItem(__pyx_t_3, __pyx_t_2); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 965; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_dtype = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":967
 *         dtype = self.CHANNEL_DTYPES[self.channel_data_type]
 * 
 *         return "<ImageFormat channel_order=%r channel_data_type=%r>" % (order, dtype)             # <<<<<<<<<<<<<<
 * 
 *     def __richcmp__(ImageFormat self, other, op):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 967; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_order);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_order);
  __Pyx_GIVEREF(__pyx_v_order);
  __Pyx_INCREF(__pyx_v_dtype);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_dtype);
  __Pyx_GIVEREF(__pyx_v_dtype);
  __pyx_t_2 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_42), ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 967; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_r = ((PyObject *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_order);
  __Pyx_XDECREF(__pyx_v_dtype);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":969
 *         return "<ImageFormat channel_order=%r channel_data_type=%r>" % (order, dtype)
 * 
 *     def __richcmp__(ImageFormat self, other, op):             # <<<<<<<<<<<<<<
 * 
 *         if not ImageFormat_Check(other):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_4__richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_11ImageFormat_4__richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op) {
  PyObject *__pyx_v_op = 0;
  cl_image_format __pyx_v_cl_format;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__richcmp__");
  __pyx_v_op = PyInt_FromLong(__pyx_arg_op); if (unlikely(!__pyx_v_op)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __Pyx_GOTREF(__pyx_v_op);
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_self), __pyx_ptype_6opencl_6cl_mem_ImageFormat, 1, "self", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 969; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "opencl/cl_mem.pyx":971
 *     def __richcmp__(ImageFormat self, other, op):
 * 
 *         if not ImageFormat_Check(other):             # <<<<<<<<<<<<<<
 *             return False
 * 
 */
  __pyx_t_1 = (!__pyx_f_6opencl_6cl_mem_ImageFormat_Check(__pyx_v_other));
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":972
 * 
 *         if not ImageFormat_Check(other):
 *             return False             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_image_format cl_format = ImageFormat_Get(other)
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 972; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":974
 *             return False
 * 
 *         cdef cl_image_format cl_format = ImageFormat_Get(other)             # <<<<<<<<<<<<<<
 * 
 *         if op == 2: # ==
 */
  __pyx_v_cl_format = __pyx_f_6opencl_6cl_mem_ImageFormat_Get(__pyx_v_other);

  /* "opencl/cl_mem.pyx":976
 *         cdef cl_image_format cl_format = ImageFormat_Get(other)
 * 
 *         if op == 2: # ==             # <<<<<<<<<<<<<<
 *             return ((self.cl_format.image_channel_data_type == cl_format.image_channel_data_type) and
 *                     self.cl_format.image_channel_order == cl_format.image_channel_order)
 */
  __pyx_t_2 = PyObject_RichCompare(__pyx_v_op, __pyx_int_2, Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 976; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 976; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":977
 * 
 *         if op == 2: # ==
 *             return ((self.cl_format.image_channel_data_type == cl_format.image_channel_data_type) and             # <<<<<<<<<<<<<<
 *                     self.cl_format.image_channel_order == cl_format.image_channel_order)
 *         else:
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_data_type == __pyx_v_cl_format.image_channel_data_type);
    if (__pyx_t_1) {

      /* "opencl/cl_mem.pyx":978
 *         if op == 2: # ==
 *             return ((self.cl_format.image_channel_data_type == cl_format.image_channel_data_type) and
 *                     self.cl_format.image_channel_order == cl_format.image_channel_order)             # <<<<<<<<<<<<<<
 *         else:
 *             return NotImplemented
 */
      __pyx_t_3 = (((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_self)->cl_format.image_channel_order == __pyx_v_cl_format.image_channel_order);
      __pyx_t_4 = __pyx_t_3;
    } else {
      __pyx_t_4 = __pyx_t_1;
    }
    __pyx_t_2 = __Pyx_PyBool_FromLong(__pyx_t_4); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 977; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":980
 *                     self.cl_format.image_channel_order == cl_format.image_channel_order)
 *         else:
 *             return NotImplemented             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(__pyx_builtin_NotImplemented);
    __pyx_r = __pyx_builtin_NotImplemented;
    goto __pyx_L0;
  }
  __pyx_L6:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_AddTraceback("opencl.cl_mem.ImageFormat.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_op);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":987
 *     cdef object __weakref__
 * 
 *     def __cinit__(self):             # <<<<<<<<<<<<<<
 *         self.buffer = NULL
 * 
 */

static int __pyx_pf_6opencl_6cl_mem_5Image___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_6opencl_6cl_mem_5Image___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__cinit__");
  if (unlikely(PyTuple_GET_SIZE(__pyx_args) > 0)) {
    __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 0, 0, PyTuple_GET_SIZE(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) && unlikely(PyDict_Size(__pyx_kwds) > 0) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 0))) return -1;

  /* "opencl/cl_mem.pyx":988
 * 
 *     def __cinit__(self):
 *         self.buffer = NULL             # <<<<<<<<<<<<<<
 * 
 *     property image_format:
 */
  ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer = NULL;

  __pyx_r = 0;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":991
 * 
 *     property image_format:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_int err_code
 * 
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_12image_format___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_12image_format___get__(PyObject *__pyx_v_self) {
  cl_int __pyx_v_err_code;
  cl_image_format __pyx_v_image_format;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":995
 * 
 *             cdef cl_image_format image_format
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_FORMAT, sizeof(cl_image_format), & image_format, NULL)             # <<<<<<<<<<<<<<
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 */
  __pyx_v_err_code = clGetImageInfo(((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->__pyx_base.buffer_id, CL_IMAGE_FORMAT, (sizeof(cl_image_format)), (&__pyx_v_image_format), NULL);

  /* "opencl/cl_mem.pyx":996
 *             cdef cl_image_format image_format
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_FORMAT, sizeof(cl_image_format), & image_format, NULL)
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":997
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_FORMAT, sizeof(cl_image_format), & image_format, NULL)
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *             return CyImageFormat_New(image_format)
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 997; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":999
 *                 raise OpenCLException(err_code)
 * 
 *             return CyImageFormat_New(image_format)             # <<<<<<<<<<<<<<
 * 
 *     property image_width:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __pyx_f_6opencl_6cl_mem_CyImageFormat_New(__pyx_v_image_format); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 999; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.Image.image_format.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1002
 * 
 *     property image_width:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_int err_code
 *             cdef size_t value
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_11image_width___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_11image_width___get__(PyObject *__pyx_v_self) {
  cl_int __pyx_v_err_code;
  size_t __pyx_v_value;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":1005
 *             cdef cl_int err_code
 *             cdef size_t value
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_WIDTH, sizeof(size_t), & value, NULL)             # <<<<<<<<<<<<<<
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 */
  __pyx_v_err_code = clGetImageInfo(((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->__pyx_base.buffer_id, CL_IMAGE_WIDTH, (sizeof(size_t)), (&__pyx_v_value), NULL);

  /* "opencl/cl_mem.pyx":1006
 *             cdef size_t value
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_WIDTH, sizeof(size_t), & value, NULL)
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 *             return value
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1007
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_WIDTH, sizeof(size_t), & value, NULL)
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 *             return value
 * 
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1007; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":1008
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 *             return value             # <<<<<<<<<<<<<<
 * 
 *     property image_height:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1008; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.Image.image_width.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1011
 * 
 *     property image_height:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_int err_code
 *             cdef size_t value
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_12image_height___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_12image_height___get__(PyObject *__pyx_v_self) {
  cl_int __pyx_v_err_code;
  size_t __pyx_v_value;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":1014
 *             cdef cl_int err_code
 *             cdef size_t value
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_HEIGHT, sizeof(size_t), & value, NULL)             # <<<<<<<<<<<<<<
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 */
  __pyx_v_err_code = clGetImageInfo(((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->__pyx_base.buffer_id, CL_IMAGE_HEIGHT, (sizeof(size_t)), (&__pyx_v_value), NULL);

  /* "opencl/cl_mem.pyx":1015
 *             cdef size_t value
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_HEIGHT, sizeof(size_t), & value, NULL)
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 *             return value
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1016
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_HEIGHT, sizeof(size_t), & value, NULL)
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 *             return value
 * 
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1016; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":1017
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 *             return value             # <<<<<<<<<<<<<<
 * 
 *     property image_depth:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1017; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.Image.image_height.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1020
 * 
 *     property image_depth:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             cdef cl_int err_code
 *             cdef size_t value
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_11image_depth___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_11image_depth___get__(PyObject *__pyx_v_self) {
  cl_int __pyx_v_err_code;
  size_t __pyx_v_value;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":1023
 *             cdef cl_int err_code
 *             cdef size_t value
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_DEPTH, sizeof(size_t), & value, NULL)             # <<<<<<<<<<<<<<
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 */
  __pyx_v_err_code = clGetImageInfo(((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->__pyx_base.buffer_id, CL_IMAGE_DEPTH, (sizeof(size_t)), (&__pyx_v_value), NULL);

  /* "opencl/cl_mem.pyx":1024
 *             cdef size_t value
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_DEPTH, sizeof(size_t), & value, NULL)
 *             if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *                 raise OpenCLException(err_code)
 *             return value
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1025
 *             err_code = clGetImageInfo(self.buffer_id, CL_IMAGE_DEPTH, sizeof(size_t), & value, NULL)
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 *             return value
 * 
 */
    __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_3 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_4));
    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_4), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_4)); __pyx_t_4 = 0;
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1025; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "opencl/cl_mem.pyx":1026
 *             if err_code != CL_SUCCESS:
 *                 raise OpenCLException(err_code)
 *             return value             # <<<<<<<<<<<<<<
 * 
 *     property format:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_3 = __Pyx_PyInt_FromSize_t(__pyx_v_value); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1026; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("opencl.cl_mem.Image.image_depth.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1029
 * 
 *     property format:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             if self.buffer.format != NULL:
 *                 return self.buffer.format.decode('UTF-8')
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_6format___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_6format___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  char *__pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":1030
 *     property format:
 *         def __get__(self):
 *             if self.buffer.format != NULL:             # <<<<<<<<<<<<<<
 *                 return self.buffer.format.decode('UTF-8')
 *             else:
 */
  __pyx_t_1 = (((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer->format != NULL);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1031
 *         def __get__(self):
 *             if self.buffer.format != NULL:
 *                 return self.buffer.format.decode('UTF-8')             # <<<<<<<<<<<<<<
 *             else:
 *                 return "B"
 */
    __Pyx_XDECREF(__pyx_r);
    __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer->format;
    __pyx_t_3 = ((PyObject *)PyUnicode_DecodeUTF8(__pyx_t_2, strlen(__pyx_t_2), NULL)); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1031; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_3));
    __Pyx_INCREF(((PyObject *)__pyx_t_3));
    __pyx_r = ((PyObject *)__pyx_t_3);
    __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":1033
 *                 return self.buffer.format.decode('UTF-8')
 *             else:
 *                 return "B"             # <<<<<<<<<<<<<<
 * 
 *     property shape:
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_n_s__B));
    __pyx_r = ((PyObject *)__pyx_n_s__B);
    goto __pyx_L0;
  }
  __pyx_L5:;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.Image.format.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1036
 * 
 *     property shape:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             shape = []
 *             for i in range(self.buffer.ndim):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_5shape___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_5shape___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_shape = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":1037
 *     property shape:
 *         def __get__(self):
 *             shape = []             # <<<<<<<<<<<<<<
 *             for i in range(self.buffer.ndim):
 *                 shape.append(self.buffer.shape[i])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1037; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_shape = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1038
 *         def __get__(self):
 *             shape = []
 *             for i in range(self.buffer.ndim):             # <<<<<<<<<<<<<<
 *                 shape.append(self.buffer.shape[i])
 *             return tuple(shape)
 */
  __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer->ndim;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;

    /* "opencl/cl_mem.pyx":1039
 *             shape = []
 *             for i in range(self.buffer.ndim):
 *                 shape.append(self.buffer.shape[i])             # <<<<<<<<<<<<<<
 *             return tuple(shape)
 * 
 */
    if (unlikely(((PyObject *)__pyx_v_shape) == Py_None)) {
      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1039; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_1 = PyInt_FromSsize_t((((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer->shape[__pyx_v_i])); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1039; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_Append(__pyx_v_shape, __pyx_t_1); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1039; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "opencl/cl_mem.pyx":1040
 *             for i in range(self.buffer.ndim):
 *                 shape.append(self.buffer.shape[i])
 *             return tuple(shape)             # <<<<<<<<<<<<<<
 * 
 *     property strides:
 */
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(((PyObject *)__pyx_v_shape) == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1040; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
  }
  __pyx_t_1 = ((PyObject *)PyList_AsTuple(__pyx_v_shape)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1040; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.Image.shape.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_shape);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1043
 * 
 *     property strides:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             strides = []
 *             for i in range(self.buffer.ndim):
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_7strides___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_7strides___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_v_strides = NULL;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  int __pyx_t_4;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("__get__");

  /* "opencl/cl_mem.pyx":1044
 *     property strides:
 *         def __get__(self):
 *             strides = []             # <<<<<<<<<<<<<<
 *             for i in range(self.buffer.ndim):
 *                 strides.append(self.buffer.strides[i])
 */
  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1044; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_v_strides = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1045
 *         def __get__(self):
 *             strides = []
 *             for i in range(self.buffer.ndim):             # <<<<<<<<<<<<<<
 *                 strides.append(self.buffer.strides[i])
 *             return tuple(strides)
 */
  __pyx_t_2 = ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer->ndim;
  for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;

    /* "opencl/cl_mem.pyx":1046
 *             strides = []
 *             for i in range(self.buffer.ndim):
 *                 strides.append(self.buffer.strides[i])             # <<<<<<<<<<<<<<
 *             return tuple(strides)
 * 
 */
    if (unlikely(((PyObject *)__pyx_v_strides) == Py_None)) {
      PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1046; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
    }
    __pyx_t_1 = PyInt_FromSsize_t((((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_self)->buffer->strides[__pyx_v_i])); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_4 = PyList_Append(__pyx_v_strides, __pyx_t_1); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1046; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }

  /* "opencl/cl_mem.pyx":1047
 *             for i in range(self.buffer.ndim):
 *                 strides.append(self.buffer.strides[i])
 *             return tuple(strides)             # <<<<<<<<<<<<<<
 * 
 *     def map(self, queue, blocking=True, readonly=False):
 */
  __Pyx_XDECREF(__pyx_r);
  if (unlikely(((PyObject *)__pyx_v_strides) == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1047; __pyx_clineno = __LINE__; goto __pyx_L1_error;} 
  }
  __pyx_t_1 = ((PyObject *)PyList_AsTuple(__pyx_v_strides)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1047; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __pyx_r = ((PyObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.Image.strides.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_strides);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1049
 *             return tuple(strides)
 * 
 *     def map(self, queue, blocking=True, readonly=False):             # <<<<<<<<<<<<<<
 * 
 *         from opencl.queue import ImageMap
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_1map(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_6opencl_6cl_mem_5Image_1map(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_queue = 0;
  PyObject *__pyx_v_blocking = 0;
  PyObject *__pyx_v_readonly = 0;
  PyObject *__pyx_v_ImageMap = NULL;
  cl_map_flags __pyx_v_flags;
  cl_bool __pyx_v_blocking_map;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  int __pyx_t_3;
  int __pyx_t_4;
  long __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__queue,&__pyx_n_s__blocking,&__pyx_n_s__readonly,0};
  __Pyx_RefNannySetupContext("map");
  {
    PyObject* values[3] = {0,0,0};
    values[1] = __pyx_k_43;
    values[2] = __pyx_k_44;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__queue);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__blocking);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args > 0) {
          PyObject* value = PyDict_GetItem(__pyx_kwds, __pyx_n_s__readonly);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "map") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1049; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else {
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_queue = values[0];
    __pyx_v_blocking = values[1];
    __pyx_v_readonly = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("map", 0, 1, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1049; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.Image.map", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":1051
 *     def map(self, queue, blocking=True, readonly=False):
 * 
 *         from opencl.queue import ImageMap             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_map_flags flags = CL_MAP_READ
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__ImageMap));
  PyList_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_n_s__ImageMap));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__ImageMap));
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s_10), ((PyObject *)__pyx_t_1), -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__ImageMap); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_t_1);
  __pyx_v_ImageMap = __pyx_t_1;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":1053
 *         from opencl.queue import ImageMap
 * 
 *         cdef cl_map_flags flags = CL_MAP_READ             # <<<<<<<<<<<<<<
 * 
 *         if not readonly:
 */
  __pyx_v_flags = CL_MAP_READ;

  /* "opencl/cl_mem.pyx":1055
 *         cdef cl_map_flags flags = CL_MAP_READ
 * 
 *         if not readonly:             # <<<<<<<<<<<<<<
 *             flags |= CL_MAP_WRITE
 * 
 */
  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_readonly); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_4 = (!__pyx_t_3);
  if (__pyx_t_4) {

    /* "opencl/cl_mem.pyx":1056
 * 
 *         if not readonly:
 *             flags |= CL_MAP_WRITE             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_bool blocking_map = 1 if blocking else 0
 */
    __pyx_v_flags = (__pyx_v_flags | CL_MAP_WRITE);
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":1058
 *             flags |= CL_MAP_WRITE
 * 
 *         cdef cl_bool blocking_map = 1 if blocking else 0             # <<<<<<<<<<<<<<
 * 
 *         return ImageMap(queue, self, blocking_map, flags)
 */
  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_blocking); if (unlikely(__pyx_t_4 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1058; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_t_4) {
    __pyx_t_5 = 1;
  } else {
    __pyx_t_5 = 0;
  }
  __pyx_v_blocking_map = __pyx_t_5;

  /* "opencl/cl_mem.pyx":1060
 *         cdef cl_bool blocking_map = 1 if blocking else 0
 * 
 *         return ImageMap(queue, self, blocking_map, flags)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_2 = __Pyx_PyInt_to_py_uint32_t(__pyx_v_blocking_map); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1060; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyInt_to_py_uint64_t(__pyx_v_flags); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1060; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyTuple_New(4); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1060; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_6));
  __Pyx_INCREF(__pyx_v_queue);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_queue);
  __Pyx_GIVEREF(__pyx_v_queue);
  __Pyx_INCREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_self);
  __Pyx_GIVEREF(__pyx_v_self);
  PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_6, 3, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_v_ImageMap, ((PyObject *)__pyx_t_6), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1060; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_6)); __pyx_t_6 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("opencl.cl_mem.Image.map", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_ImageMap);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1063
 * 
 * 
 * def broadcast(DeviceMemoryView view, shape):             # <<<<<<<<<<<<<<
 *     if not isinstance(view, DeviceMemoryView):
 *         raise TypeError("argument 'view' must be a valid opencl.DeviceMemoryView object")
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_3broadcast(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6opencl_6cl_mem_3broadcast = {__Pyx_NAMESTR("broadcast"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_3broadcast, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)};
static PyObject *__pyx_pf_6opencl_6cl_mem_3broadcast(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *__pyx_v_view = 0;
  PyObject *__pyx_v_shape = 0;
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *__pyx_v_clview = 0;
  Py_buffer *__pyx_v_result_buffer;
  Py_buffer __pyx_v_buffer;
  cl_mem __pyx_v_memobj;
  size_t __pyx_v_ndim;
  size_t __pyx_v_noff;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  int __pyx_t_3;
  Py_ssize_t __pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  PyObject *(*__pyx_t_6)(PyObject *);
  Py_ssize_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  PyObject *__pyx_t_9 = NULL;
  size_t __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__view,&__pyx_n_s__shape,0};
  __Pyx_RefNannySetupContext("broadcast");
  __pyx_self = __pyx_self;
  {
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__view);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__shape);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("broadcast", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "broadcast") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
    }
    __pyx_v_view = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)values[0]);
    __pyx_v_shape = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("broadcast", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.broadcast", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_view), __pyx_ptype_6opencl_6cl_mem_DeviceMemoryView, 1, "view", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "opencl/cl_mem.pyx":1064
 * 
 * def broadcast(DeviceMemoryView view, shape):
 *     if not isinstance(view, DeviceMemoryView):             # <<<<<<<<<<<<<<
 *         raise TypeError("argument 'view' must be a valid opencl.DeviceMemoryView object")
 * 
 */
  __pyx_t_1 = ((PyObject *)((PyObject*)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView));
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_TypeCheck(((PyObject *)__pyx_v_view), __pyx_t_1); 
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (!__pyx_t_2);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":1065
 * def broadcast(DeviceMemoryView view, shape):
 *     if not isinstance(view, DeviceMemoryView):
 *         raise TypeError("argument 'view' must be a valid opencl.DeviceMemoryView object")             # <<<<<<<<<<<<<<
 * 
 *     cdef DeviceMemoryView clview = < DeviceMemoryView > view
 */
    __pyx_t_1 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_46), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":1067
 *         raise TypeError("argument 'view' must be a valid opencl.DeviceMemoryView object")
 * 
 *     cdef DeviceMemoryView clview = < DeviceMemoryView > view             # <<<<<<<<<<<<<<
 * 
 *     cdef Py_buffer * result_buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 */
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_view)));
  __pyx_v_clview = __pyx_v_view;

  /* "opencl/cl_mem.pyx":1069
 *     cdef DeviceMemoryView clview = < DeviceMemoryView > view
 * 
 *     cdef Py_buffer * result_buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 *     cdef Py_buffer buffer
 * 
 */
  __pyx_v_result_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":1072
 *     cdef Py_buffer buffer
 * 
 *     CyView_GetBuffer(clview, & buffer)             # <<<<<<<<<<<<<<
 *     cdef cl_mem memobj = CyMemoryObject_GetID(clview)
 * 
 */
  __pyx_f_6opencl_6cl_mem_CyView_GetBuffer(((PyObject *)__pyx_v_clview), (&__pyx_v_buffer));

  /* "opencl/cl_mem.pyx":1073
 * 
 *     CyView_GetBuffer(clview, & buffer)
 *     cdef cl_mem memobj = CyMemoryObject_GetID(clview)             # <<<<<<<<<<<<<<
 * 
 *     cdef size_t ndim = len(shape)
 */
  __pyx_v_memobj = __pyx_f_6opencl_6cl_mem_CyMemoryObject_GetID(((PyObject *)__pyx_v_clview));

  /* "opencl/cl_mem.pyx":1075
 *     cdef cl_mem memobj = CyMemoryObject_GetID(clview)
 * 
 *     cdef size_t ndim = len(shape)             # <<<<<<<<<<<<<<
 * 
 *     if ndim < buffer.ndim:
 */
  __pyx_t_4 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_4 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1075; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_ndim = __pyx_t_4;

  /* "opencl/cl_mem.pyx":1077
 *     cdef size_t ndim = len(shape)
 * 
 *     if ndim < buffer.ndim:             # <<<<<<<<<<<<<<
 *         raise TypeError("ndim of arguement shape must be >= view.ndim")
 * 
 */
  __pyx_t_3 = (__pyx_v_ndim < __pyx_v_buffer.ndim);
  if (__pyx_t_3) {

    /* "opencl/cl_mem.pyx":1078
 * 
 *     if ndim < buffer.ndim:
 *         raise TypeError("ndim of arguement shape must be >= view.ndim")             # <<<<<<<<<<<<<<
 * 
 *     cdef size_t noff = ndim - buffer.ndim
 */
    __pyx_t_1 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_48), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_Raise(__pyx_t_1, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":1080
 *         raise TypeError("ndim of arguement shape must be >= view.ndim")
 * 
 *     cdef size_t noff = ndim - buffer.ndim             # <<<<<<<<<<<<<<
 * 
 *     for i in range(buffer.ndim):
 */
  __pyx_v_noff = (__pyx_v_ndim - __pyx_v_buffer.ndim);

  /* "opencl/cl_mem.pyx":1082
 *     cdef size_t noff = ndim - buffer.ndim
 * 
 *     for i in range(buffer.ndim):             # <<<<<<<<<<<<<<
 *         if  buffer.shape[i] > 1:
 *             if shape[noff + i] != buffer.shape[i]:
 */
  __pyx_t_1 = PyInt_FromLong(__pyx_v_buffer.ndim); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  if (PyList_CheckExact(__pyx_t_1) || PyTuple_CheckExact(__pyx_t_1)) {
    __pyx_t_5 = __pyx_t_1; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_1); __pyx_t_4++;
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_5);
      if (unlikely(!__pyx_t_1)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1082; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_1);
    }
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = 0;

    /* "opencl/cl_mem.pyx":1083
 * 
 *     for i in range(buffer.ndim):
 *         if  buffer.shape[i] > 1:             # <<<<<<<<<<<<<<
 *             if shape[noff + i] != buffer.shape[i]:
 *                 raise TypeError("Can not broadcast dim %i from %i to %i" % (i, buffer.shape[i], shape[noff + i]))
 */
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((__pyx_v_buffer.shape[__pyx_t_7]) > 1);
    if (__pyx_t_3) {

      /* "opencl/cl_mem.pyx":1084
 *     for i in range(buffer.ndim):
 *         if  buffer.shape[i] > 1:
 *             if shape[noff + i] != buffer.shape[i]:             # <<<<<<<<<<<<<<
 *                 raise TypeError("Can not broadcast dim %i from %i to %i" % (i, buffer.shape[i], shape[noff + i]))
 * 
 */
      __pyx_t_1 = __Pyx_PyInt_FromSize_t(__pyx_v_noff); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __pyx_t_8 = PyNumber_Add(__pyx_t_1, __pyx_v_i); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_8);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = PyObject_GetItem(__pyx_v_shape, __pyx_t_8); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_8 = PyInt_FromSsize_t((__pyx_v_buffer.shape[__pyx_t_7])); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_9 = PyObject_RichCompare(__pyx_t_1, __pyx_t_8, Py_NE); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_9);
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_9); if (unlikely(__pyx_t_3 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1084; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
      if (__pyx_t_3) {

        /* "opencl/cl_mem.pyx":1085
 *         if  buffer.shape[i] > 1:
 *             if shape[noff + i] != buffer.shape[i]:
 *                 raise TypeError("Can not broadcast dim %i from %i to %i" % (i, buffer.shape[i], shape[noff + i]))             # <<<<<<<<<<<<<<
 * 
 *     result_buffer.buf = buffer.buf
 */
        __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_t_9 = PyInt_FromSsize_t((__pyx_v_buffer.shape[__pyx_t_7])); if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_9);
        __pyx_t_8 = __Pyx_PyInt_FromSize_t(__pyx_v_noff); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __pyx_t_1 = PyNumber_Add(__pyx_t_8, __pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_1);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = PyObject_GetItem(__pyx_v_shape, __pyx_t_1); if (!__pyx_t_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_1));
        __Pyx_INCREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_i);
        __Pyx_GIVEREF(__pyx_v_i);
        PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_9);
        __Pyx_GIVEREF(__pyx_t_9);
        PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_8);
        __Pyx_GIVEREF(__pyx_t_8);
        __pyx_t_9 = 0;
        __pyx_t_8 = 0;
        __pyx_t_8 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_49), ((PyObject *)__pyx_t_1)); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_8));
        __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(((PyObject *)__pyx_t_1));
        PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_t_8));
        __Pyx_GIVEREF(((PyObject *)__pyx_t_8));
        __pyx_t_8 = 0;
        __pyx_t_8 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __Pyx_GOTREF(__pyx_t_8);
        __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
        __Pyx_Raise(__pyx_t_8, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
        {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1085; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        goto __pyx_L11;
      }
      __pyx_L11:;
      goto __pyx_L10;
    }
    __pyx_L10:;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":1087
 *                 raise TypeError("Can not broadcast dim %i from %i to %i" % (i, buffer.shape[i], shape[noff + i]))
 * 
 *     result_buffer.buf = buffer.buf             # <<<<<<<<<<<<<<
 *     result_buffer.ndim = ndim
 *     result_buffer.itemsize = buffer.itemsize
 */
  __pyx_v_result_buffer->buf = __pyx_v_buffer.buf;

  /* "opencl/cl_mem.pyx":1088
 * 
 *     result_buffer.buf = buffer.buf
 *     result_buffer.ndim = ndim             # <<<<<<<<<<<<<<
 *     result_buffer.itemsize = buffer.itemsize
 * 
 */
  __pyx_v_result_buffer->ndim = __pyx_v_ndim;

  /* "opencl/cl_mem.pyx":1089
 *     result_buffer.buf = buffer.buf
 *     result_buffer.ndim = ndim
 *     result_buffer.itemsize = buffer.itemsize             # <<<<<<<<<<<<<<
 * 
 *     result_buffer.format = < char *> malloc(len(buffer.format) + 1)
 */
  __pyx_v_result_buffer->itemsize = __pyx_v_buffer.itemsize;

  /* "opencl/cl_mem.pyx":1091
 *     result_buffer.itemsize = buffer.itemsize
 * 
 *     result_buffer.format = < char *> malloc(len(buffer.format) + 1)             # <<<<<<<<<<<<<<
 *     strcpy(result_buffer.format, buffer.format)
 * 
 */
  __pyx_t_10 = strlen(__pyx_v_buffer.format); 
  __pyx_v_result_buffer->format = ((char *)malloc((__pyx_t_10 + 1)));

  /* "opencl/cl_mem.pyx":1092
 * 
 *     result_buffer.format = < char *> malloc(len(buffer.format) + 1)
 *     strcpy(result_buffer.format, buffer.format)             # <<<<<<<<<<<<<<
 * 
 *     result_buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 */
  strcpy(__pyx_v_result_buffer->format, __pyx_v_buffer.format);

  /* "opencl/cl_mem.pyx":1094
 *     strcpy(result_buffer.format, buffer.format)
 * 
 *     result_buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)             # <<<<<<<<<<<<<<
 *     result_buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 * 
 */
  __pyx_v_result_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_ndim)));

  /* "opencl/cl_mem.pyx":1095
 * 
 *     result_buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 *     result_buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)             # <<<<<<<<<<<<<<
 * 
 *     result_buffer.internal = NULL
 */
  __pyx_v_result_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_ndim)));

  /* "opencl/cl_mem.pyx":1097
 *     result_buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * ndim)
 * 
 *     result_buffer.internal = NULL             # <<<<<<<<<<<<<<
 *     result_buffer.suboffsets = NULL
 * 
 */
  __pyx_v_result_buffer->internal = NULL;

  /* "opencl/cl_mem.pyx":1098
 * 
 *     result_buffer.internal = NULL
 *     result_buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *     for i in range(ndim):
 */
  __pyx_v_result_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":1100
 *     result_buffer.suboffsets = NULL
 * 
 *     for i in range(ndim):             # <<<<<<<<<<<<<<
 *         result_buffer.shape[i] = shape[i]
 *         result_buffer.strides[i] = 0
 */
  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_ndim); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_8));
  PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_8), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
  if (PyList_CheckExact(__pyx_t_5) || PyTuple_CheckExact(__pyx_t_5)) {
    __pyx_t_8 = __pyx_t_5; __Pyx_INCREF(__pyx_t_8); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __pyx_t_6 = Py_TYPE(__pyx_t_8)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_8)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_8)) break;
      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_8)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
      __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++;
    } else {
      __pyx_t_5 = __pyx_t_6(__pyx_t_8);
      if (unlikely(!__pyx_t_5)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_5);
    }
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_5;
    __pyx_t_5 = 0;

    /* "opencl/cl_mem.pyx":1101
 * 
 *     for i in range(ndim):
 *         result_buffer.shape[i] = shape[i]             # <<<<<<<<<<<<<<
 *         result_buffer.strides[i] = 0
 * 
 */
    __pyx_t_5 = PyObject_GetItem(__pyx_v_shape, __pyx_v_i); if (!__pyx_t_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    (__pyx_v_result_buffer->shape[__pyx_t_11]) = __pyx_t_7;

    /* "opencl/cl_mem.pyx":1102
 *     for i in range(ndim):
 *         result_buffer.shape[i] = shape[i]
 *         result_buffer.strides[i] = 0             # <<<<<<<<<<<<<<
 * 
 *     for i in range(buffer.ndim):
 */
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    (__pyx_v_result_buffer->strides[__pyx_t_7]) = 0;
  }
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;

  /* "opencl/cl_mem.pyx":1104
 *         result_buffer.strides[i] = 0
 * 
 *     for i in range(buffer.ndim):             # <<<<<<<<<<<<<<
 *         if  buffer.shape[i] > 1:
 *             result_buffer.strides[noff + i] = buffer.strides[i]
 */
  __pyx_t_8 = PyInt_FromLong(__pyx_v_buffer.ndim); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_5));
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_8);
  __Pyx_GIVEREF(__pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = PyObject_Call(__pyx_builtin_range, ((PyObject *)__pyx_t_5), NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_8);
  __Pyx_DECREF(((PyObject *)__pyx_t_5)); __pyx_t_5 = 0;
  if (PyList_CheckExact(__pyx_t_8) || PyTuple_CheckExact(__pyx_t_8)) {
    __pyx_t_5 = __pyx_t_8; __Pyx_INCREF(__pyx_t_5); __pyx_t_4 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
  }
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  for (;;) {
    if (PyList_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_8 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_8); __pyx_t_4++;
    } else if (PyTuple_CheckExact(__pyx_t_5)) {
      if (__pyx_t_4 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
      __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_4); __Pyx_INCREF(__pyx_t_8); __pyx_t_4++;
    } else {
      __pyx_t_8 = __pyx_t_6(__pyx_t_5);
      if (unlikely(!__pyx_t_8)) {
        if (PyErr_Occurred()) {
          if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) PyErr_Clear();
          else {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        }
        break;
      }
      __Pyx_GOTREF(__pyx_t_8);
    }
    __Pyx_XDECREF(__pyx_v_i);
    __pyx_v_i = __pyx_t_8;
    __pyx_t_8 = 0;

    /* "opencl/cl_mem.pyx":1105
 * 
 *     for i in range(buffer.ndim):
 *         if  buffer.shape[i] > 1:             # <<<<<<<<<<<<<<
 *             result_buffer.strides[noff + i] = buffer.strides[i]
 * 
 */
    __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_3 = ((__pyx_v_buffer.shape[__pyx_t_7]) > 1);
    if (__pyx_t_3) {

      /* "opencl/cl_mem.pyx":1106
 *     for i in range(buffer.ndim):
 *         if  buffer.shape[i] > 1:
 *             result_buffer.strides[noff + i] = buffer.strides[i]             # <<<<<<<<<<<<<<
 * 
 *     return CyView_Create(memobj, result_buffer, view.ctype, 1)
 */
      __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_v_i); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_8 = __Pyx_PyInt_FromSize_t(__pyx_v_noff); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_8);
      __pyx_t_1 = PyNumber_Add(__pyx_t_8, __pyx_v_i); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_result_buffer->strides[__pyx_t_11]) = (__pyx_v_buffer.strides[__pyx_t_7]);
      goto __pyx_L16;
    }
    __pyx_L16:;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "opencl/cl_mem.pyx":1108
 *             result_buffer.strides[noff + i] = buffer.strides[i]
 * 
 *     return CyView_Create(memobj, result_buffer, view.ctype, 1)             # <<<<<<<<<<<<<<
 * 
 * def empty_image(context, shape, image_format):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_view), __pyx_n_s__ctype); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __pyx_f_6opencl_6cl_mem_CyView_Create(__pyx_v_memobj, __pyx_v_result_buffer, __pyx_t_5, 1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_XDECREF(__pyx_t_9);
  __Pyx_AddTraceback("opencl.cl_mem.broadcast", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_clview);
  __Pyx_XDECREF(__pyx_v_i);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1110
 *     return CyView_Create(memobj, result_buffer, view.ctype, 1)
 * 
 * def empty_image(context, shape, image_format):             # <<<<<<<<<<<<<<
 *     '''
 *     Create an image object.
 */

static PyObject *__pyx_pf_6opencl_6cl_mem_4empty_image(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6opencl_6cl_mem_4empty_image[] = "\n    Create an image object.\n    ";
static PyMethodDef __pyx_mdef_6opencl_6cl_mem_4empty_image = {__Pyx_NAMESTR("empty_image"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_4empty_image, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_4empty_image)};
static PyObject *__pyx_pf_6opencl_6cl_mem_4empty_image(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_context = 0;
  PyObject *__pyx_v_shape = 0;
  PyObject *__pyx_v_image_format = 0;
  cl_context __pyx_v_ctx;
  cl_mem_flags __pyx_v_flags;
  cl_int __pyx_v_err_code;
  cl_image_format __pyx_v_fmt;
  size_t __pyx_v_image_width;
  size_t __pyx_v_image_height;
  size_t __pyx_v_image_depth;
  size_t __pyx_v_image_row_pitch;
  size_t __pyx_v_image_slice_pitch;
  void *__pyx_v_host_ptr;
  cl_mem __pyx_v_buffer_id;
  Py_buffer *__pyx_v_buffer;
  PyObject *__pyx_v_format = NULL;
  PyObject *__pyx_v_bytes_format = NULL;
  char *__pyx_v_tmp;
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  int __pyx_t_4;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  size_t __pyx_t_7;
  PyObject *__pyx_t_8 = NULL;
  char *__pyx_t_9;
  int __pyx_t_10;
  int __pyx_t_11;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_n_s__context,&__pyx_n_s__shape,&__pyx_n_s__image_format,0};
  __Pyx_RefNannySetupContext("empty_image");
  __pyx_self = __pyx_self;
  {
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = PyDict_Size(__pyx_kwds);
      switch (PyTuple_GET_SIZE(__pyx_args)) {
        case  0:
        values[0] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__context);
        if (likely(values[0])) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        values[1] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__shape);
        if (likely(values[1])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("empty_image", 1, 3, 3, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
        case  2:
        values[2] = PyDict_GetItem(__pyx_kwds, __pyx_n_s__image_format);
        if (likely(values[2])) kw_args--;
        else {
          __Pyx_RaiseArgtupleInvalid("empty_image", 1, 3, 3, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
        }
      }
      if (unlikely(kw_args > 0)) {
        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "empty_image") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
    }
    __pyx_v_context = values[0];
    __pyx_v_shape = values[1];
    __pyx_v_image_format = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("empty_image", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("opencl.cl_mem.empty_image", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __Pyx_RefNannyFinishContext();
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "opencl/cl_mem.pyx":1114
 *     Create an image object.
 *     '''
 *     if not CyContext_Check(context):             # <<<<<<<<<<<<<<
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 */
  __pyx_t_1 = (!__pyx_f_6opencl_7context_CyContext_Check(__pyx_v_context));
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1115
 *     '''
 *     if not CyContext_Check(context):
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *     if len(shape) not in [2, 3]:
 */
    __pyx_t_2 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_50), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "opencl/cl_mem.pyx":1117
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")
 * 
 *     if len(shape) not in [2, 3]:             # <<<<<<<<<<<<<<
 *         raise TypeError("shape must be 2 or 3 dimentional (got ndim=%i)" % len(shape))
 * 
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_1 = ((int)(__pyx_t_3 != 2));
  if (__pyx_t_1) {
    __pyx_t_4 = ((int)(__pyx_t_3 != 3));
    __pyx_t_5 = __pyx_t_4;
  } else {
    __pyx_t_5 = __pyx_t_1;
  }
  __pyx_t_1 = __pyx_t_5;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1118
 * 
 *     if len(shape) not in [2, 3]:
 *         raise TypeError("shape must be 2 or 3 dimentional (got ndim=%i)" % len(shape))             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_context ctx = CyContext_GetID(context)
 */
    __pyx_t_3 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_6 = PyNumber_Remainder(((PyObject *)__pyx_kp_s_51), __pyx_t_2); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_6));
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_2));
    PyTuple_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_t_6));
    __Pyx_GIVEREF(((PyObject *)__pyx_t_6));
    __pyx_t_6 = 0;
    __pyx_t_6 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1118; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "opencl/cl_mem.pyx":1120
 *         raise TypeError("shape must be 2 or 3 dimentional (got ndim=%i)" % len(shape))
 * 
 *     cdef cl_context ctx = CyContext_GetID(context)             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_mem_flags flags = CL_MEM_READ_WRITE
 */
  __pyx_v_ctx = __pyx_f_6opencl_7context_CyContext_GetID(__pyx_v_context);

  /* "opencl/cl_mem.pyx":1122
 *     cdef cl_context ctx = CyContext_GetID(context)
 * 
 *     cdef cl_mem_flags flags = CL_MEM_READ_WRITE             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_int err_code
 */
  __pyx_v_flags = CL_MEM_READ_WRITE;

  /* "opencl/cl_mem.pyx":1127
 * 
 * 
 *     if not ImageFormat_Check(image_format):             # <<<<<<<<<<<<<<
 *         raise TypeError("arguement 'image_format' must be a valid ImageFormat object")
 * 
 */
  __pyx_t_1 = (!__pyx_f_6opencl_6cl_mem_ImageFormat_Check(__pyx_v_image_format));
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1128
 * 
 *     if not ImageFormat_Check(image_format):
 *         raise TypeError("arguement 'image_format' must be a valid ImageFormat object")             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_image_format fmt = ImageFormat_Get(image_format)
 */
    __pyx_t_6 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_53), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_Raise(__pyx_t_6, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "opencl/cl_mem.pyx":1130
 *         raise TypeError("arguement 'image_format' must be a valid ImageFormat object")
 * 
 *     cdef cl_image_format fmt = ImageFormat_Get(image_format)             # <<<<<<<<<<<<<<
 * 
 *     cdef size_t image_width = shape[0]
 */
  __pyx_v_fmt = __pyx_f_6opencl_6cl_mem_ImageFormat_Get(__pyx_v_image_format);

  /* "opencl/cl_mem.pyx":1132
 *     cdef cl_image_format fmt = ImageFormat_Get(image_format)
 * 
 *     cdef size_t image_width = shape[0]             # <<<<<<<<<<<<<<
 *     cdef size_t image_height = shape[1]
 *     cdef size_t image_depth
 */
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_shape, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyInt_AsSize_t(__pyx_t_6); if (unlikely((__pyx_t_7 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1132; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_image_width = __pyx_t_7;

  /* "opencl/cl_mem.pyx":1133
 * 
 *     cdef size_t image_width = shape[0]
 *     cdef size_t image_height = shape[1]             # <<<<<<<<<<<<<<
 *     cdef size_t image_depth
 *     cdef size_t image_row_pitch = 0
 */
  __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_shape, 1, sizeof(long), PyInt_FromLong); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyInt_AsSize_t(__pyx_t_6); if (unlikely((__pyx_t_7 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_image_height = __pyx_t_7;

  /* "opencl/cl_mem.pyx":1135
 *     cdef size_t image_height = shape[1]
 *     cdef size_t image_depth
 *     cdef size_t image_row_pitch = 0             # <<<<<<<<<<<<<<
 *     cdef size_t image_slice_pitch = 0
 *     cdef void * host_ptr = NULL
 */
  __pyx_v_image_row_pitch = 0;

  /* "opencl/cl_mem.pyx":1136
 *     cdef size_t image_depth
 *     cdef size_t image_row_pitch = 0
 *     cdef size_t image_slice_pitch = 0             # <<<<<<<<<<<<<<
 *     cdef void * host_ptr = NULL
 * 
 */
  __pyx_v_image_slice_pitch = 0;

  /* "opencl/cl_mem.pyx":1137
 *     cdef size_t image_row_pitch = 0
 *     cdef size_t image_slice_pitch = 0
 *     cdef void * host_ptr = NULL             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_mem buffer_id
 */
  __pyx_v_host_ptr = NULL;

  /* "opencl/cl_mem.pyx":1140
 * 
 *     cdef cl_mem buffer_id
 *     if len(shape) == 2:             # <<<<<<<<<<<<<<
 *         buffer_id = clCreateImage2D(ctx, flags, & fmt, image_width, image_height, image_row_pitch, NULL, & err_code)
 *     else:
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1140; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_t_1 = (__pyx_t_3 == 2);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1141
 *     cdef cl_mem buffer_id
 *     if len(shape) == 2:
 *         buffer_id = clCreateImage2D(ctx, flags, & fmt, image_width, image_height, image_row_pitch, NULL, & err_code)             # <<<<<<<<<<<<<<
 *     else:
 *         image_depth = shape[2]
 */
    __pyx_v_buffer_id = clCreateImage2D(__pyx_v_ctx, __pyx_v_flags, (&__pyx_v_fmt), __pyx_v_image_width, __pyx_v_image_height, __pyx_v_image_row_pitch, NULL, (&__pyx_v_err_code));
    goto __pyx_L9;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":1143
 *         buffer_id = clCreateImage2D(ctx, flags, & fmt, image_width, image_height, image_row_pitch, NULL, & err_code)
 *     else:
 *         image_depth = shape[2]             # <<<<<<<<<<<<<<
 *         buffer_id = clCreateImage3D(ctx, flags, & fmt, image_width, image_height, image_depth, image_row_pitch, image_slice_pitch, NULL, & err_code)
 * 
 */
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_shape, 2, sizeof(long), PyInt_FromLong); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_7 = __Pyx_PyInt_AsSize_t(__pyx_t_6); if (unlikely((__pyx_t_7 == (size_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1143; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_image_depth = __pyx_t_7;

    /* "opencl/cl_mem.pyx":1144
 *     else:
 *         image_depth = shape[2]
 *         buffer_id = clCreateImage3D(ctx, flags, & fmt, image_width, image_height, image_depth, image_row_pitch, image_slice_pitch, NULL, & err_code)             # <<<<<<<<<<<<<<
 * 
 *     if err_code != CL_SUCCESS:
 */
    __pyx_v_buffer_id = clCreateImage3D(__pyx_v_ctx, __pyx_v_flags, (&__pyx_v_fmt), __pyx_v_image_width, __pyx_v_image_height, __pyx_v_image_depth, __pyx_v_image_row_pitch, __pyx_v_image_slice_pitch, NULL, (&__pyx_v_err_code));
  }
  __pyx_L9:;

  /* "opencl/cl_mem.pyx":1146
 *         buffer_id = clCreateImage3D(ctx, flags, & fmt, image_width, image_height, image_depth, image_row_pitch, image_slice_pitch, NULL, & err_code)
 * 
 *     if err_code != CL_SUCCESS:             # <<<<<<<<<<<<<<
 *         raise OpenCLException(err_code)
 * 
 */
  __pyx_t_1 = (__pyx_v_err_code != CL_SUCCESS);
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1147
 * 
 *     if err_code != CL_SUCCESS:
 *         raise OpenCLException(err_code)             # <<<<<<<<<<<<<<
 * 
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 */
    __pyx_t_6 = __Pyx_GetName(__pyx_m, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_2 = __Pyx_PyInt_to_py_int32_t(__pyx_v_err_code); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(((PyObject *)__pyx_t_8));
    PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
    __Pyx_GIVEREF(__pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = PyObject_Call(__pyx_t_6, ((PyObject *)__pyx_t_8), NULL); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_DECREF(((PyObject *)__pyx_t_8)); __pyx_t_8 = 0;
    __Pyx_Raise(__pyx_t_2, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L10;
  }
  __pyx_L10:;

  /* "opencl/cl_mem.pyx":1149
 *         raise OpenCLException(err_code)
 * 
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 * 
 *     buffer.buf = NULL
 */
  __pyx_v_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":1151
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 * 
 *     buffer.buf = NULL             # <<<<<<<<<<<<<<
 *     format = image_format.format
 *     buffer.format = < char *> malloc(len(format) + 1)
 */
  __pyx_v_buffer->buf = NULL;

  /* "opencl/cl_mem.pyx":1152
 * 
 *     buffer.buf = NULL
 *     format = image_format.format             # <<<<<<<<<<<<<<
 *     buffer.format = < char *> malloc(len(format) + 1)
 * 
 */
  __pyx_t_2 = PyObject_GetAttr(__pyx_v_image_format, __pyx_n_s__format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_v_format = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":1153
 *     buffer.buf = NULL
 *     format = image_format.format
 *     buffer.format = < char *> malloc(len(format) + 1)             # <<<<<<<<<<<<<<
 * 
 *     if isinstance(format, str):
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_format); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1153; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_buffer->format = ((char *)malloc((__pyx_t_3 + 1)));

  /* "opencl/cl_mem.pyx":1155
 *     buffer.format = < char *> malloc(len(format) + 1)
 * 
 *     if isinstance(format, str):             # <<<<<<<<<<<<<<
 *         bytes_format = format.encode()
 * 
 */
  __pyx_t_2 = ((PyObject *)((PyObject*)(&PyString_Type)));
  __Pyx_INCREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_format, __pyx_t_2); 
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {

    /* "opencl/cl_mem.pyx":1156
 * 
 *     if isinstance(format, str):
 *         bytes_format = format.encode()             # <<<<<<<<<<<<<<
 * 
 *     cdef char * tmp = < char *> bytes_format
 */
    __pyx_t_2 = PyObject_GetAttr(__pyx_v_format, __pyx_n_s__encode); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_2);
    __pyx_t_8 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1156; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_8);
    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_bytes_format = __pyx_t_8;
    __pyx_t_8 = 0;
    goto __pyx_L11;
  }
  __pyx_L11:;
  if (unlikely(!__pyx_v_bytes_format)) { __Pyx_RaiseUnboundLocalError("bytes_format"); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;} }__pyx_t_9 = PyBytes_AsString(__pyx_v_bytes_format); if (unlikely((!__pyx_t_9) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1158; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "opencl/cl_mem.pyx":1158
 *         bytes_format = format.encode()
 * 
 *     cdef char * tmp = < char *> bytes_format             # <<<<<<<<<<<<<<
 * 
 *     strcpy(buffer.format, tmp)
 */
  __pyx_v_tmp = ((char *)__pyx_t_9);

  /* "opencl/cl_mem.pyx":1160
 *     cdef char * tmp = < char *> bytes_format
 * 
 *     strcpy(buffer.format, tmp)             # <<<<<<<<<<<<<<
 *     buffer.readonly = 0
 * 
 */
  strcpy(__pyx_v_buffer->format, __pyx_v_tmp);

  /* "opencl/cl_mem.pyx":1161
 * 
 *     strcpy(buffer.format, tmp)
 *     buffer.readonly = 0             # <<<<<<<<<<<<<<
 * 
 *     buffer.itemsize = size_from_format(format)
 */
  __pyx_v_buffer->readonly = 0;

  /* "opencl/cl_mem.pyx":1163
 *     buffer.readonly = 0
 * 
 *     buffer.itemsize = size_from_format(format)             # <<<<<<<<<<<<<<
 *     buffer.ndim = len(shape)
 * 
 */
  __pyx_t_8 = __Pyx_GetName(__pyx_m, __pyx_n_s__size_from_format); if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_8);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_format);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_format);
  __Pyx_GIVEREF(__pyx_v_format);
  __pyx_t_6 = PyObject_Call(__pyx_t_8, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_buffer->itemsize = __pyx_t_3;

  /* "opencl/cl_mem.pyx":1164
 * 
 *     buffer.itemsize = size_from_format(format)
 *     buffer.ndim = len(shape)             # <<<<<<<<<<<<<<
 * 
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_shape); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_buffer->ndim = __pyx_t_3;

  /* "opencl/cl_mem.pyx":1166
 *     buffer.ndim = len(shape)
 * 
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.suboffsets = NULL
 */
  __pyx_v_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":1167
 * 
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *     buffer.suboffsets = NULL
 * 
 */
  __pyx_v_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":1168
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *     for i in range(buffer.ndim):
 */
  __pyx_v_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":1170
 *     buffer.suboffsets = NULL
 * 
 *     for i in range(buffer.ndim):             # <<<<<<<<<<<<<<
 *         buffer.shape[i] = shape[i]
 * 
 */
  __pyx_t_10 = __pyx_v_buffer->ndim;
  for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;

    /* "opencl/cl_mem.pyx":1171
 * 
 *     for i in range(buffer.ndim):
 *         buffer.shape[i] = shape[i]             # <<<<<<<<<<<<<<
 * 
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')
 */
    __pyx_t_6 = __Pyx_GetItemInt(__pyx_v_shape, __pyx_v_i, sizeof(int), PyInt_FromLong); if (!__pyx_t_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1171; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    (__pyx_v_buffer->shape[__pyx_v_i]) = __pyx_t_3;
  }

  /* "opencl/cl_mem.pyx":1173
 *         buffer.shape[i] = shape[i]
 * 
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')             # <<<<<<<<<<<<<<
 * 
 *     return CyImage_Create(buffer_id, buffer, 0)
 */
  PyBuffer_FillContiguousStrides(__pyx_v_buffer->ndim, __pyx_v_buffer->shape, __pyx_v_buffer->strides, __pyx_v_buffer->itemsize, 'C');

  /* "opencl/cl_mem.pyx":1175
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')
 * 
 *     return CyImage_Create(buffer_id, buffer, 0)             # <<<<<<<<<<<<<<
 * 
 * #===============================================================================
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_6 = __pyx_f_6opencl_6cl_mem_CyImage_Create(__pyx_v_buffer_id, __pyx_v_buffer, 0); if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1175; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_8);
  __Pyx_AddTraceback("opencl.cl_mem.empty_image", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF(__pyx_v_format);
  __Pyx_XDECREF(__pyx_v_bytes_format);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1181
 * #===============================================================================
 * 
 * cdef api object CyMemoryObject_Create(cl_mem buffer_id):             # <<<<<<<<<<<<<<
 *     cdef MemoryObject cview = < MemoryObject > MemoryObject.__new__(MemoryObject)
 *     clRetainMemObject(buffer_id)
 */

static PyObject *__pyx_f_6opencl_6cl_mem_CyMemoryObject_Create(cl_mem __pyx_v_buffer_id) {
  struct __pyx_obj_6opencl_6cl_mem_MemoryObject *__pyx_v_cview = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("CyMemoryObject_Create");

  /* "opencl/cl_mem.pyx":1182
 * 
 * cdef api object CyMemoryObject_Create(cl_mem buffer_id):
 *     cdef MemoryObject cview = < MemoryObject > MemoryObject.__new__(MemoryObject)             # <<<<<<<<<<<<<<
 *     clRetainMemObject(buffer_id)
 *     cview.buffer_id = buffer_id
 */
  __pyx_t_1 = __Pyx_tp_new(((PyObject*)__pyx_ptype_6opencl_6cl_mem_MemoryObject)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1182; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_t_1)));
  __pyx_v_cview = ((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1183
 * cdef api object CyMemoryObject_Create(cl_mem buffer_id):
 *     cdef MemoryObject cview = < MemoryObject > MemoryObject.__new__(MemoryObject)
 *     clRetainMemObject(buffer_id)             # <<<<<<<<<<<<<<
 *     cview.buffer_id = buffer_id
 *     return cview
 */
  clRetainMemObject(__pyx_v_buffer_id);

  /* "opencl/cl_mem.pyx":1184
 *     cdef MemoryObject cview = < MemoryObject > MemoryObject.__new__(MemoryObject)
 *     clRetainMemObject(buffer_id)
 *     cview.buffer_id = buffer_id             # <<<<<<<<<<<<<<
 *     return cview
 * 
 */
  __pyx_v_cview->buffer_id = __pyx_v_buffer_id;

  /* "opencl/cl_mem.pyx":1185
 *     clRetainMemObject(buffer_id)
 *     cview.buffer_id = buffer_id
 *     return cview             # <<<<<<<<<<<<<<
 * 
 * cdef api int CyView_GetBuffer(object view, Py_buffer * buffer):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_cview));
  __pyx_r = ((PyObject *)__pyx_v_cview);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.CyMemoryObject_Create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_cview);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1187
 *     return cview
 * 
 * cdef api int CyView_GetBuffer(object view, Py_buffer * buffer):             # <<<<<<<<<<<<<<
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > view
 *     buffer[0] = dview.buffer[0]
 */

static int __pyx_f_6opencl_6cl_mem_CyView_GetBuffer(PyObject *__pyx_v_view, Py_buffer *__pyx_v_buffer) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *__pyx_v_dview = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("CyView_GetBuffer");

  /* "opencl/cl_mem.pyx":1188
 * 
 * cdef api int CyView_GetBuffer(object view, Py_buffer * buffer):
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > view             # <<<<<<<<<<<<<<
 *     buffer[0] = dview.buffer[0]
 *     return 0
 */
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_view)));
  __pyx_v_dview = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_view);

  /* "opencl/cl_mem.pyx":1189
 * cdef api int CyView_GetBuffer(object view, Py_buffer * buffer):
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > view
 *     buffer[0] = dview.buffer[0]             # <<<<<<<<<<<<<<
 *     return 0
 * 
 */
  (__pyx_v_buffer[0]) = (__pyx_v_dview->buffer[0]);

  /* "opencl/cl_mem.pyx":1190
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > view
 *     buffer[0] = dview.buffer[0]
 *     return 0             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_dview);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1193
 * 
 * 
 * cdef api object CyView_Create(cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):             # <<<<<<<<<<<<<<
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > DeviceMemoryView.__new__(DeviceMemoryView)
 *     if incref:
 */

static PyObject *__pyx_f_6opencl_6cl_mem_CyView_Create(cl_mem __pyx_v_buffer_id, Py_buffer *__pyx_v_buffer, PyObject *__pyx_v_ctype, int __pyx_v_incref) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *__pyx_v_dview = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("CyView_Create");

  /* "opencl/cl_mem.pyx":1194
 * 
 * cdef api object CyView_Create(cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > DeviceMemoryView.__new__(DeviceMemoryView)             # <<<<<<<<<<<<<<
 *     if incref:
 *         clRetainMemObject(buffer_id)
 */
  __pyx_t_1 = __Pyx_tp_new(((PyObject*)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1194; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_t_1)));
  __pyx_v_dview = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1195
 * cdef api object CyView_Create(cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > DeviceMemoryView.__new__(DeviceMemoryView)
 *     if incref:             # <<<<<<<<<<<<<<
 *         clRetainMemObject(buffer_id)
 * 
 */
  if (__pyx_v_incref) {

    /* "opencl/cl_mem.pyx":1196
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > DeviceMemoryView.__new__(DeviceMemoryView)
 *     if incref:
 *         clRetainMemObject(buffer_id)             # <<<<<<<<<<<<<<
 * 
 *     dview.buffer_id = buffer_id
 */
    clRetainMemObject(__pyx_v_buffer_id);
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "opencl/cl_mem.pyx":1198
 *         clRetainMemObject(buffer_id)
 * 
 *     dview.buffer_id = buffer_id             # <<<<<<<<<<<<<<
 *     dview.buffer = buffer
 *     dview._ctype = ctype
 */
  __pyx_v_dview->__pyx_base.buffer_id = __pyx_v_buffer_id;

  /* "opencl/cl_mem.pyx":1199
 * 
 *     dview.buffer_id = buffer_id
 *     dview.buffer = buffer             # <<<<<<<<<<<<<<
 *     dview._ctype = ctype
 * 
 */
  __pyx_v_dview->buffer = __pyx_v_buffer;

  /* "opencl/cl_mem.pyx":1200
 *     dview.buffer_id = buffer_id
 *     dview.buffer = buffer
 *     dview._ctype = ctype             # <<<<<<<<<<<<<<
 * 
 *     return dview
 */
  __Pyx_INCREF(__pyx_v_ctype);
  __Pyx_GIVEREF(__pyx_v_ctype);
  __Pyx_GOTREF(__pyx_v_dview->_ctype);
  __Pyx_DECREF(__pyx_v_dview->_ctype);
  __pyx_v_dview->_ctype = __pyx_v_ctype;

  /* "opencl/cl_mem.pyx":1202
 *     dview._ctype = ctype
 * 
 *     return dview             # <<<<<<<<<<<<<<
 * 
 * cdef api object CyView_CreateSubclass(object cls, cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_dview));
  __pyx_r = ((PyObject *)__pyx_v_dview);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.CyView_Create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_dview);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1204
 *     return dview
 * 
 * cdef api object CyView_CreateSubclass(object cls, cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):             # <<<<<<<<<<<<<<
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > cls.__new__(cls)
 *     if incref:
 */

static PyObject *__pyx_f_6opencl_6cl_mem_CyView_CreateSubclass(PyObject *__pyx_v_cls, cl_mem __pyx_v_buffer_id, Py_buffer *__pyx_v_buffer, PyObject *__pyx_v_ctype, int __pyx_v_incref) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *__pyx_v_dview = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("CyView_CreateSubclass");

  /* "opencl/cl_mem.pyx":1205
 * 
 * cdef api object CyView_CreateSubclass(object cls, cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > cls.__new__(cls)             # <<<<<<<<<<<<<<
 *     if incref:
 *         clRetainMemObject(buffer_id)
 */
  __pyx_t_1 = PyObject_GetAttr(__pyx_v_cls, __pyx_n_s____new__); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(__pyx_v_cls);
  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_cls);
  __Pyx_GIVEREF(__pyx_v_cls);
  __pyx_t_3 = PyObject_Call(__pyx_t_1, ((PyObject *)__pyx_t_2), NULL); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1205; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_t_3)));
  __pyx_v_dview = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_t_3);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":1206
 * cdef api object CyView_CreateSubclass(object cls, cl_mem buffer_id, Py_buffer * buffer, object ctype, int incref):
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > cls.__new__(cls)
 *     if incref:             # <<<<<<<<<<<<<<
 *         clRetainMemObject(buffer_id)
 * 
 */
  if (__pyx_v_incref) {

    /* "opencl/cl_mem.pyx":1207
 *     cdef DeviceMemoryView dview = < DeviceMemoryView > cls.__new__(cls)
 *     if incref:
 *         clRetainMemObject(buffer_id)             # <<<<<<<<<<<<<<
 * 
 *     dview.buffer_id = buffer_id
 */
    clRetainMemObject(__pyx_v_buffer_id);
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "opencl/cl_mem.pyx":1209
 *         clRetainMemObject(buffer_id)
 * 
 *     dview.buffer_id = buffer_id             # <<<<<<<<<<<<<<
 *     dview.buffer = buffer
 *     dview._ctype = ctype
 */
  __pyx_v_dview->__pyx_base.buffer_id = __pyx_v_buffer_id;

  /* "opencl/cl_mem.pyx":1210
 * 
 *     dview.buffer_id = buffer_id
 *     dview.buffer = buffer             # <<<<<<<<<<<<<<
 *     dview._ctype = ctype
 * 
 */
  __pyx_v_dview->buffer = __pyx_v_buffer;

  /* "opencl/cl_mem.pyx":1211
 *     dview.buffer_id = buffer_id
 *     dview.buffer = buffer
 *     dview._ctype = ctype             # <<<<<<<<<<<<<<
 * 
 *     return dview
 */
  __Pyx_INCREF(__pyx_v_ctype);
  __Pyx_GIVEREF(__pyx_v_ctype);
  __Pyx_GOTREF(__pyx_v_dview->_ctype);
  __Pyx_DECREF(__pyx_v_dview->_ctype);
  __pyx_v_dview->_ctype = __pyx_v_ctype;

  /* "opencl/cl_mem.pyx":1213
 *     dview._ctype = ctype
 * 
 *     return dview             # <<<<<<<<<<<<<<
 * 
 * cdef api Py_buffer * CyView_GetPyBuffer(object memobj):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_dview));
  __pyx_r = ((PyObject *)__pyx_v_dview);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_AddTraceback("opencl.cl_mem.CyView_CreateSubclass", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_dview);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1215
 *     return dview
 * 
 * cdef api Py_buffer * CyView_GetPyBuffer(object memobj):             # <<<<<<<<<<<<<<
 *     obj = (< DeviceMemoryView > memobj)
 *     return obj.buffer
 */

static Py_buffer *__pyx_f_6opencl_6cl_mem_CyView_GetPyBuffer(PyObject *__pyx_v_memobj) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *__pyx_v_obj = NULL;
  Py_buffer *__pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("CyView_GetPyBuffer");

  /* "opencl/cl_mem.pyx":1216
 * 
 * cdef api Py_buffer * CyView_GetPyBuffer(object memobj):
 *     obj = (< DeviceMemoryView > memobj)             # <<<<<<<<<<<<<<
 *     return obj.buffer
 * 
 */
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_memobj)));
  __pyx_v_obj = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)__pyx_v_memobj);

  /* "opencl/cl_mem.pyx":1217
 * cdef api Py_buffer * CyView_GetPyBuffer(object memobj):
 *     obj = (< DeviceMemoryView > memobj)
 *     return obj.buffer             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = __pyx_v_obj->buffer;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_obj);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1221
 * 
 * 
 * cdef api object CyImage_Create(cl_mem buffer_id, Py_buffer * buffer, int incref):             # <<<<<<<<<<<<<<
 *     cdef Image image = < Image > Image.__new__(Image)
 *     if incref:
 */

static PyObject *__pyx_f_6opencl_6cl_mem_CyImage_Create(cl_mem __pyx_v_buffer_id, Py_buffer *__pyx_v_buffer, int __pyx_v_incref) {
  struct __pyx_obj_6opencl_6cl_mem_Image *__pyx_v_image = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("CyImage_Create");

  /* "opencl/cl_mem.pyx":1222
 * 
 * cdef api object CyImage_Create(cl_mem buffer_id, Py_buffer * buffer, int incref):
 *     cdef Image image = < Image > Image.__new__(Image)             # <<<<<<<<<<<<<<
 *     if incref:
 *         clRetainMemObject(buffer_id)
 */
  __pyx_t_1 = __Pyx_tp_new(((PyObject*)__pyx_ptype_6opencl_6cl_mem_Image)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1222; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_t_1)));
  __pyx_v_image = ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1223
 * cdef api object CyImage_Create(cl_mem buffer_id, Py_buffer * buffer, int incref):
 *     cdef Image image = < Image > Image.__new__(Image)
 *     if incref:             # <<<<<<<<<<<<<<
 *         clRetainMemObject(buffer_id)
 * 
 */
  if (__pyx_v_incref) {

    /* "opencl/cl_mem.pyx":1224
 *     cdef Image image = < Image > Image.__new__(Image)
 *     if incref:
 *         clRetainMemObject(buffer_id)             # <<<<<<<<<<<<<<
 * 
 *     image.buffer_id = buffer_id
 */
    clRetainMemObject(__pyx_v_buffer_id);
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "opencl/cl_mem.pyx":1226
 *         clRetainMemObject(buffer_id)
 * 
 *     image.buffer_id = buffer_id             # <<<<<<<<<<<<<<
 *     image.buffer = buffer
 * 
 */
  __pyx_v_image->__pyx_base.buffer_id = __pyx_v_buffer_id;

  /* "opencl/cl_mem.pyx":1227
 * 
 *     image.buffer_id = buffer_id
 *     image.buffer = buffer             # <<<<<<<<<<<<<<
 * 
 *     return image
 */
  __pyx_v_image->buffer = __pyx_v_buffer;

  /* "opencl/cl_mem.pyx":1229
 *     image.buffer = buffer
 * 
 *     return image             # <<<<<<<<<<<<<<
 * 
 * cdef api int CyImage_GetBuffer(object view, Py_buffer * buffer):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_image));
  __pyx_r = ((PyObject *)__pyx_v_image);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.CyImage_Create", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_image);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1231
 *     return image
 * 
 * cdef api int CyImage_GetBuffer(object view, Py_buffer * buffer):             # <<<<<<<<<<<<<<
 *     cdef Image dview = < Image > view
 *     buffer[0] = dview.buffer[0]
 */

static int __pyx_f_6opencl_6cl_mem_CyImage_GetBuffer(PyObject *__pyx_v_view, Py_buffer *__pyx_v_buffer) {
  struct __pyx_obj_6opencl_6cl_mem_Image *__pyx_v_dview = 0;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("CyImage_GetBuffer");

  /* "opencl/cl_mem.pyx":1232
 * 
 * cdef api int CyImage_GetBuffer(object view, Py_buffer * buffer):
 *     cdef Image dview = < Image > view             # <<<<<<<<<<<<<<
 *     buffer[0] = dview.buffer[0]
 *     return 0
 */
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_view)));
  __pyx_v_dview = ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_v_view);

  /* "opencl/cl_mem.pyx":1233
 * cdef api int CyImage_GetBuffer(object view, Py_buffer * buffer):
 *     cdef Image dview = < Image > view
 *     buffer[0] = dview.buffer[0]             # <<<<<<<<<<<<<<
 *     return 0
 * 
 */
  (__pyx_v_buffer[0]) = (__pyx_v_dview->buffer[0]);

  /* "opencl/cl_mem.pyx":1234
 *     cdef Image dview = < Image > view
 *     buffer[0] = dview.buffer[0]
 *     return 0             # <<<<<<<<<<<<<<
 * 
 * cdef api int CyMemoryObject_Check(object memobj):
 */
  __pyx_r = 0;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_dview);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1236
 *     return 0
 * 
 * cdef api int CyMemoryObject_Check(object memobj):             # <<<<<<<<<<<<<<
 *     return isinstance(memobj, MemoryObject)
 * 
 */

static int __pyx_f_6opencl_6cl_mem_CyMemoryObject_Check(PyObject *__pyx_v_memobj) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  __Pyx_RefNannySetupContext("CyMemoryObject_Check");

  /* "opencl/cl_mem.pyx":1237
 * 
 * cdef api int CyMemoryObject_Check(object memobj):
 *     return isinstance(memobj, MemoryObject)             # <<<<<<<<<<<<<<
 * 
 * cdef api cl_mem CyMemoryObject_GetID(object memobj):
 */
  __pyx_t_1 = ((PyObject *)((PyObject*)__pyx_ptype_6opencl_6cl_mem_MemoryObject));
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_memobj, __pyx_t_1); 
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1239
 *     return isinstance(memobj, MemoryObject)
 * 
 * cdef api cl_mem CyMemoryObject_GetID(object memobj):             # <<<<<<<<<<<<<<
 *     obj = (< MemoryObject > memobj)
 *     cdef cl_mem buffer_id = obj.buffer_id
 */

static cl_mem __pyx_f_6opencl_6cl_mem_CyMemoryObject_GetID(PyObject *__pyx_v_memobj) {
  struct __pyx_obj_6opencl_6cl_mem_MemoryObject *__pyx_v_obj = NULL;
  cl_mem __pyx_v_buffer_id;
  cl_mem __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("CyMemoryObject_GetID");

  /* "opencl/cl_mem.pyx":1240
 * 
 * cdef api cl_mem CyMemoryObject_GetID(object memobj):
 *     obj = (< MemoryObject > memobj)             # <<<<<<<<<<<<<<
 *     cdef cl_mem buffer_id = obj.buffer_id
 *     return buffer_id
 */
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_memobj)));
  __pyx_v_obj = ((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)__pyx_v_memobj);

  /* "opencl/cl_mem.pyx":1241
 * cdef api cl_mem CyMemoryObject_GetID(object memobj):
 *     obj = (< MemoryObject > memobj)
 *     cdef cl_mem buffer_id = obj.buffer_id             # <<<<<<<<<<<<<<
 *     return buffer_id
 * 
 */
  __pyx_v_buffer_id = __pyx_v_obj->buffer_id;

  /* "opencl/cl_mem.pyx":1242
 *     obj = (< MemoryObject > memobj)
 *     cdef cl_mem buffer_id = obj.buffer_id
 *     return buffer_id             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = __pyx_v_buffer_id;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_obj);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1245
 * 
 * 
 * cdef api int ImageFormat_Check(object fmt):             # <<<<<<<<<<<<<<
 *     return isinstance(fmt, ImageFormat)
 * 
 */

static int __pyx_f_6opencl_6cl_mem_ImageFormat_Check(PyObject *__pyx_v_fmt) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  __Pyx_RefNannySetupContext("ImageFormat_Check");

  /* "opencl/cl_mem.pyx":1246
 * 
 * cdef api int ImageFormat_Check(object fmt):
 *     return isinstance(fmt, ImageFormat)             # <<<<<<<<<<<<<<
 * 
 * cdef api cl_image_format ImageFormat_Get(object fmt):
 */
  __pyx_t_1 = ((PyObject *)((PyObject*)__pyx_ptype_6opencl_6cl_mem_ImageFormat));
  __Pyx_INCREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_TypeCheck(__pyx_v_fmt, __pyx_t_1); 
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1248
 *     return isinstance(fmt, ImageFormat)
 * 
 * cdef api cl_image_format ImageFormat_Get(object fmt):             # <<<<<<<<<<<<<<
 *     return (< ImageFormat > fmt).cl_format
 * 
 */

static cl_image_format __pyx_f_6opencl_6cl_mem_ImageFormat_Get(PyObject *__pyx_v_fmt) {
  cl_image_format __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("ImageFormat_Get");

  /* "opencl/cl_mem.pyx":1249
 * 
 * cdef api cl_image_format ImageFormat_Get(object fmt):
 *     return (< ImageFormat > fmt).cl_format             # <<<<<<<<<<<<<<
 * 
 * cdef api object CyImageFormat_New(cl_image_format image_format):
 */
  __pyx_r = ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_v_fmt)->cl_format;
  goto __pyx_L0;

  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1251
 *     return (< ImageFormat > fmt).cl_format
 * 
 * cdef api object CyImageFormat_New(cl_image_format image_format):             # <<<<<<<<<<<<<<
 *     cdef ImageFormat fmt = < ImageFormat > ImageFormat.__new__(ImageFormat)
 *     fmt.cl_format = image_format
 */

static PyObject *__pyx_f_6opencl_6cl_mem_CyImageFormat_New(cl_image_format __pyx_v_image_format) {
  struct __pyx_obj_6opencl_6cl_mem_ImageFormat *__pyx_v_fmt = 0;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("CyImageFormat_New");

  /* "opencl/cl_mem.pyx":1252
 * 
 * cdef api object CyImageFormat_New(cl_image_format image_format):
 *     cdef ImageFormat fmt = < ImageFormat > ImageFormat.__new__(ImageFormat)             # <<<<<<<<<<<<<<
 *     fmt.cl_format = image_format
 *     return fmt
 */
  __pyx_t_1 = __Pyx_tp_new(((PyObject*)__pyx_ptype_6opencl_6cl_mem_ImageFormat)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1252; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_t_1)));
  __pyx_v_fmt = ((struct __pyx_obj_6opencl_6cl_mem_ImageFormat *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1253
 * cdef api object CyImageFormat_New(cl_image_format image_format):
 *     cdef ImageFormat fmt = < ImageFormat > ImageFormat.__new__(ImageFormat)
 *     fmt.cl_format = image_format             # <<<<<<<<<<<<<<
 *     return fmt
 * 
 */
  __pyx_v_fmt->cl_format = __pyx_v_image_format;

  /* "opencl/cl_mem.pyx":1254
 *     cdef ImageFormat fmt = < ImageFormat > ImageFormat.__new__(ImageFormat)
 *     fmt.cl_format = image_format
 *     return fmt             # <<<<<<<<<<<<<<
 * 
 * cdef api object CyImage_New(cl_mem buffer_id):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_fmt));
  __pyx_r = ((PyObject *)__pyx_v_fmt);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("opencl.cl_mem.CyImageFormat_New", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_fmt);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "opencl/cl_mem.pyx":1256
 *     return fmt
 * 
 * cdef api object CyImage_New(cl_mem buffer_id):             # <<<<<<<<<<<<<<
 *     cdef Image image = < Image > Image.__new__(Image)
 *     image.buffer_id = buffer_id
 */

static PyObject *__pyx_f_6opencl_6cl_mem_CyImage_New(cl_mem __pyx_v_buffer_id) {
  struct __pyx_obj_6opencl_6cl_mem_Image *__pyx_v_image = 0;
  Py_buffer *__pyx_v_buffer;
  PyObject *__pyx_v_format = NULL;
  char *__pyx_v_tmp;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  Py_ssize_t __pyx_t_3;
  char *__pyx_t_4;
  PyObject *__pyx_t_5 = NULL;
  int __pyx_t_6;
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;
  __Pyx_RefNannySetupContext("CyImage_New");

  /* "opencl/cl_mem.pyx":1257
 * 
 * cdef api object CyImage_New(cl_mem buffer_id):
 *     cdef Image image = < Image > Image.__new__(Image)             # <<<<<<<<<<<<<<
 *     image.buffer_id = buffer_id
 * 
 */
  __pyx_t_1 = __Pyx_tp_new(((PyObject*)__pyx_ptype_6opencl_6cl_mem_Image)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1257; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(((PyObject *)((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_t_1)));
  __pyx_v_image = ((struct __pyx_obj_6opencl_6cl_mem_Image *)__pyx_t_1);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "opencl/cl_mem.pyx":1258
 * cdef api object CyImage_New(cl_mem buffer_id):
 *     cdef Image image = < Image > Image.__new__(Image)
 *     image.buffer_id = buffer_id             # <<<<<<<<<<<<<<
 * 
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 */
  __pyx_v_image->__pyx_base.buffer_id = __pyx_v_buffer_id;

  /* "opencl/cl_mem.pyx":1260
 *     image.buffer_id = buffer_id
 * 
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))             # <<<<<<<<<<<<<<
 * 
 *     format = image.image_format.format
 */
  __pyx_v_buffer = ((Py_buffer *)malloc((sizeof(Py_buffer))));

  /* "opencl/cl_mem.pyx":1262
 *     cdef Py_buffer * buffer = < Py_buffer *> malloc(sizeof(Py_buffer))
 * 
 *     format = image.image_format.format             # <<<<<<<<<<<<<<
 * 
 *     buffer.format = < char *> malloc(len(format) + 1)
 */
  __pyx_t_1 = PyObject_GetAttr(((PyObject *)__pyx_v_image), __pyx_n_s__image_format); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_1, __pyx_n_s__format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_format = __pyx_t_2;
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":1264
 *     format = image.image_format.format
 * 
 *     buffer.format = < char *> malloc(len(format) + 1)             # <<<<<<<<<<<<<<
 *     cdef char * tmp = < char *> format
 *     strcpy(buffer.format, tmp)
 */
  __pyx_t_3 = PyObject_Length(__pyx_v_format); if (unlikely(__pyx_t_3 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_buffer->format = ((char *)malloc((__pyx_t_3 + 1)));

  /* "opencl/cl_mem.pyx":1265
 * 
 *     buffer.format = < char *> malloc(len(format) + 1)
 *     cdef char * tmp = < char *> format             # <<<<<<<<<<<<<<
 *     strcpy(buffer.format, tmp)
 * 
 */
  __pyx_t_4 = PyBytes_AsString(__pyx_v_format); if (unlikely((!__pyx_t_4) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1265; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_tmp = ((char *)__pyx_t_4);

  /* "opencl/cl_mem.pyx":1266
 *     buffer.format = < char *> malloc(len(format) + 1)
 *     cdef char * tmp = < char *> format
 *     strcpy(buffer.format, tmp)             # <<<<<<<<<<<<<<
 * 
 *     buffer.readonly = 0
 */
  strcpy(__pyx_v_buffer->format, __pyx_v_tmp);

  /* "opencl/cl_mem.pyx":1268
 *     strcpy(buffer.format, tmp)
 * 
 *     buffer.readonly = 0             # <<<<<<<<<<<<<<
 *     buffer.itemsize = size_from_format(format)
 * #    buffer.ndim = len(shape)
 */
  __pyx_v_buffer->readonly = 0;

  /* "opencl/cl_mem.pyx":1269
 * 
 *     buffer.readonly = 0
 *     buffer.itemsize = size_from_format(format)             # <<<<<<<<<<<<<<
 * #    buffer.ndim = len(shape)
 *     if image.type == CL_MEM_OBJECT_IMAGE2D:
 */
  __pyx_t_2 = __Pyx_GetName(__pyx_m, __pyx_n_s__size_from_format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_1));
  __Pyx_INCREF(__pyx_v_format);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_format);
  __Pyx_GIVEREF(__pyx_v_format);
  __pyx_t_5 = PyObject_Call(__pyx_t_2, ((PyObject *)__pyx_t_1), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(((PyObject *)__pyx_t_1)); __pyx_t_1 = 0;
  __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_buffer->itemsize = __pyx_t_3;

  /* "opencl/cl_mem.pyx":1271
 *     buffer.itemsize = size_from_format(format)
 * #    buffer.ndim = len(shape)
 *     if image.type == CL_MEM_OBJECT_IMAGE2D:             # <<<<<<<<<<<<<<
 *         buffer.ndim = 2
 *     elif image.type == CL_MEM_OBJECT_IMAGE3D:
 */
  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_image), __pyx_n_s__type); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyInt_FromSize_t(CL_MEM_OBJECT_IMAGE2D); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_t_1, Py_EQ); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":1272
 * #    buffer.ndim = len(shape)
 *     if image.type == CL_MEM_OBJECT_IMAGE2D:
 *         buffer.ndim = 2             # <<<<<<<<<<<<<<
 *     elif image.type == CL_MEM_OBJECT_IMAGE3D:
 *         buffer.ndim = 3
 */
    __pyx_v_buffer->ndim = 2;
    goto __pyx_L3;
  }

  /* "opencl/cl_mem.pyx":1273
 *     if image.type == CL_MEM_OBJECT_IMAGE2D:
 *         buffer.ndim = 2
 *     elif image.type == CL_MEM_OBJECT_IMAGE3D:             # <<<<<<<<<<<<<<
 *         buffer.ndim = 3
 *     else:
 */
  __pyx_t_2 = PyObject_GetAttr(((PyObject *)__pyx_v_image), __pyx_n_s__type); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyInt_FromSize_t(CL_MEM_OBJECT_IMAGE3D); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_6 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":1274
 *         buffer.ndim = 2
 *     elif image.type == CL_MEM_OBJECT_IMAGE3D:
 *         buffer.ndim = 3             # <<<<<<<<<<<<<<
 *     else:
 *         raise TypeError("CyImage_New takes a valid image object as an argument")
 */
    __pyx_v_buffer->ndim = 3;
    goto __pyx_L3;
  }
  /*else*/ {

    /* "opencl/cl_mem.pyx":1276
 *         buffer.ndim = 3
 *     else:
 *         raise TypeError("CyImage_New takes a valid image object as an argument")             # <<<<<<<<<<<<<<
 * 
 *     buffer.buf = NULL
 */
    __pyx_t_5 = PyObject_Call(__pyx_builtin_TypeError, ((PyObject *)__pyx_k_tuple_55), NULL); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_Raise(__pyx_t_5, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }
  __pyx_L3:;

  /* "opencl/cl_mem.pyx":1278
 *         raise TypeError("CyImage_New takes a valid image object as an argument")
 * 
 *     buffer.buf = NULL             # <<<<<<<<<<<<<<
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 */
  __pyx_v_buffer->buf = NULL;

  /* "opencl/cl_mem.pyx":1279
 * 
 *     buffer.buf = NULL
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.suboffsets = NULL
 */
  __pyx_v_buffer->shape = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":1280
 *     buffer.buf = NULL
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)             # <<<<<<<<<<<<<<
 *     buffer.suboffsets = NULL
 * 
 */
  __pyx_v_buffer->strides = ((Py_ssize_t *)malloc(((sizeof(Py_ssize_t)) * __pyx_v_buffer->ndim)));

  /* "opencl/cl_mem.pyx":1281
 *     buffer.shape = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.strides = < Py_ssize_t *> malloc(sizeof(Py_ssize_t) * buffer.ndim)
 *     buffer.suboffsets = NULL             # <<<<<<<<<<<<<<
 * 
 *     buffer.shape[0] = image.image_width
 */
  __pyx_v_buffer->suboffsets = NULL;

  /* "opencl/cl_mem.pyx":1283
 *     buffer.suboffsets = NULL
 * 
 *     buffer.shape[0] = image.image_width             # <<<<<<<<<<<<<<
 *     buffer.shape[1] = image.image_height
 * 
 */
  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_image), __pyx_n_s__image_width); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  (__pyx_v_buffer->shape[0]) = __pyx_t_3;

  /* "opencl/cl_mem.pyx":1284
 * 
 *     buffer.shape[0] = image.image_width
 *     buffer.shape[1] = image.image_height             # <<<<<<<<<<<<<<
 * 
 *     if buffer.ndim == 3:
 */
  __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_image), __pyx_n_s__image_height); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  (__pyx_v_buffer->shape[1]) = __pyx_t_3;

  /* "opencl/cl_mem.pyx":1286
 *     buffer.shape[1] = image.image_height
 * 
 *     if buffer.ndim == 3:             # <<<<<<<<<<<<<<
 *         buffer.shape[2] = image.image_depth
 * 
 */
  __pyx_t_6 = (__pyx_v_buffer->ndim == 3);
  if (__pyx_t_6) {

    /* "opencl/cl_mem.pyx":1287
 * 
 *     if buffer.ndim == 3:
 *         buffer.shape[2] = image.image_depth             # <<<<<<<<<<<<<<
 * 
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')
 */
    __pyx_t_5 = PyObject_GetAttr(((PyObject *)__pyx_v_image), __pyx_n_s__image_depth); if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1287; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    (__pyx_v_buffer->shape[2]) = __pyx_t_3;
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "opencl/cl_mem.pyx":1289
 *         buffer.shape[2] = image.image_depth
 * 
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')             # <<<<<<<<<<<<<<
 * 
 *     image.buffer = buffer
 */
  PyBuffer_FillContiguousStrides(__pyx_v_buffer->ndim, __pyx_v_buffer->shape, __pyx_v_buffer->strides, __pyx_v_buffer->itemsize, 'C');

  /* "opencl/cl_mem.pyx":1291
 *     PyBuffer_FillContiguousStrides(buffer.ndim, buffer.shape, buffer.strides, buffer.itemsize, 'C')
 * 
 *     image.buffer = buffer             # <<<<<<<<<<<<<<
 *     return image
 * 
 */
  __pyx_v_image->buffer = __pyx_v_buffer;

  /* "opencl/cl_mem.pyx":1292
 * 
 *     image.buffer = buffer
 *     return image             # <<<<<<<<<<<<<<
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_image));
  __pyx_r = ((PyObject *)__pyx_v_image);
  goto __pyx_L0;

  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("opencl.cl_mem.CyImage_New", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_image);
  __Pyx_XDECREF(__pyx_v_format);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_tp_new_6opencl_6cl_mem_UserData(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_6opencl_6cl_mem_UserData *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_6opencl_6cl_mem_UserData *)o);
  p->function = Py_None; Py_INCREF(Py_None);
  p->args = Py_None; Py_INCREF(Py_None);
  p->kwargs = Py_None; Py_INCREF(Py_None);
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem_UserData(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem_UserData *p = (struct __pyx_obj_6opencl_6cl_mem_UserData *)o;
  Py_XDECREF(p->function);
  Py_XDECREF(p->args);
  Py_XDECREF(p->kwargs);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6opencl_6cl_mem_UserData(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6opencl_6cl_mem_UserData *p = (struct __pyx_obj_6opencl_6cl_mem_UserData *)o;
  if (p->function) {
    e = (*v)(p->function, a); if (e) return e;
  }
  if (p->args) {
    e = (*v)(p->args, a); if (e) return e;
  }
  if (p->kwargs) {
    e = (*v)(p->kwargs, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6opencl_6cl_mem_UserData(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem_UserData *p = (struct __pyx_obj_6opencl_6cl_mem_UserData *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->function);
  p->function = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->args);
  p->args = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->kwargs);
  p->kwargs = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem_UserData[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_UserData = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_UserData = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_UserData = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_UserData = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem_UserData = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.UserData"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem_UserData), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem_UserData, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number_UserData, /*tp_as_number*/
  &__pyx_tp_as_sequence_UserData, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_UserData, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_UserData, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6opencl_6cl_mem_UserData, /*tp_traverse*/
  __pyx_tp_clear_6opencl_6cl_mem_UserData, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem_UserData, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem_UserData, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};
static struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject __pyx_vtable_6opencl_6cl_mem_MemoryObject;

static PyObject *__pyx_tp_new_6opencl_6cl_mem_MemoryObject(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_6opencl_6cl_mem_MemoryObject *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_6opencl_6cl_mem_MemoryObject *)o);
  p->__pyx_vtab = __pyx_vtabptr_6opencl_6cl_mem_MemoryObject;
  if (__pyx_pf_6opencl_6cl_mem_12MemoryObject_1__cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem_MemoryObject(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_6opencl_6cl_mem_12MemoryObject_2__dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_12MemoryObject_context(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_12MemoryObject_7context___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_12MemoryObject_type(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_12MemoryObject_4type___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_12MemoryObject_mem_size(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_12MemoryObject_8mem_size___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_12MemoryObject__refcount(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_12MemoryObject_9_refcount___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_12MemoryObject__mapcount(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_12MemoryObject_9_mapcount___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_12MemoryObject_base(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_12MemoryObject_4base___get__(o);
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem_MemoryObject[] = {
  {__Pyx_NAMESTR("get_buffer_id"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_12MemoryObject_get_buffer_id, METH_NOARGS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_12MemoryObject_get_buffer_id)},
  {__Pyx_NAMESTR("add_destructor_callback"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_12MemoryObject_3add_destructor_callback, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_12MemoryObject_3add_destructor_callback)},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6opencl_6cl_mem_MemoryObject[] = {
  {(char *)"context", __pyx_getprop_6opencl_6cl_mem_12MemoryObject_context, 0, __Pyx_DOCSTR(__pyx_k_56), 0},
  {(char *)"type", __pyx_getprop_6opencl_6cl_mem_12MemoryObject_type, 0, __Pyx_DOCSTR(__pyx_k_57), 0},
  {(char *)"mem_size", __pyx_getprop_6opencl_6cl_mem_12MemoryObject_mem_size, 0, __Pyx_DOCSTR(__pyx_k_58), 0},
  {(char *)"_refcount", __pyx_getprop_6opencl_6cl_mem_12MemoryObject__refcount, 0, __Pyx_DOCSTR(__pyx_k_59), 0},
  {(char *)"_mapcount", __pyx_getprop_6opencl_6cl_mem_12MemoryObject__mapcount, 0, 0, 0},
  {(char *)"base", __pyx_getprop_6opencl_6cl_mem_12MemoryObject_base, 0, __Pyx_DOCSTR(__pyx_k_60), 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_MemoryObject = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_MemoryObject = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_MemoryObject = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_MemoryObject = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem_MemoryObject = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.MemoryObject"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem_MemoryObject), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem_MemoryObject, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number_MemoryObject, /*tp_as_number*/
  &__pyx_tp_as_sequence_MemoryObject, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_MemoryObject, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_MemoryObject, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  __Pyx_DOCSTR("\n    Memory objects are categorized into two types: buffer objects, and image objects.  A buffer\n    object stores a one-dimensional collection of elements whereas an image object is used to store a \n    two- or three- dimensional texture, frame-buffer or image.\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem_MemoryObject, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6opencl_6cl_mem_MemoryObject, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem_MemoryObject, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};
static struct __pyx_vtabstruct_6opencl_6cl_mem_DeviceMemoryView __pyx_vtable_6opencl_6cl_mem_DeviceMemoryView;

static PyObject *__pyx_tp_new_6opencl_6cl_mem_DeviceMemoryView(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *p;
  PyObject *o = __pyx_tp_new_6opencl_6cl_mem_MemoryObject(t, a, k);
  if (!o) return 0;
  p = ((struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)o);
  p->__pyx_base.__pyx_vtab = (struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject*)__pyx_vtabptr_6opencl_6cl_mem_DeviceMemoryView;
  p->__weakref__ = 0;
  p->_host_pointer = Py_None; Py_INCREF(Py_None);
  p->_ctype = Py_None; Py_INCREF(Py_None);
  if (__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem_DeviceMemoryView(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *p = (struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_1__dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  if (p->__weakref__) PyObject_ClearWeakRefs(o);
  Py_XDECREF(p->_host_pointer);
  Py_XDECREF(p->_ctype);
  __pyx_tp_dealloc_6opencl_6cl_mem_MemoryObject(o);
}

static int __pyx_tp_traverse_6opencl_6cl_mem_DeviceMemoryView(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *p = (struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)o;
  if (__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_traverse) {
    e = __pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_traverse(o, v, a); if (e) return e;
  }
  if (p->_host_pointer) {
    e = (*v)(p->_host_pointer, a); if (e) return e;
  }
  if (p->_ctype) {
    e = (*v)(p->_ctype, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6opencl_6cl_mem_DeviceMemoryView(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *p = (struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView *)o;
  PyObject* tmp;
  if (__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_clear) {
    __pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_clear(o);
  }
  tmp = ((PyObject*)p->_host_pointer);
  p->_host_pointer = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->_ctype);
  p->_ctype = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}
static PyObject *__pyx_sq_item_6opencl_6cl_mem_DeviceMemoryView(PyObject *o, Py_ssize_t i) {
  PyObject *r;
  PyObject *x = PyInt_FromSsize_t(i); if(!x) return 0;
  r = Py_TYPE(o)->tp_as_mapping->mp_subscript(o, x);
  Py_DECREF(x);
  return r;
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_array_info(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10array_info___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_offset_(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7offset____get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_ndim(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4ndim___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_readonly(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8readonly___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_itemsize(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8itemsize___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_format(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6format___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_shape(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5shape___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_strides(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7strides___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_size(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4size___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_nbytes(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6nbytes___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_is_contiguous(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13is_contiguous___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_ctype(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5ctype___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView__host_pointer(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer___get__(o);
}

static int __pyx_setprop_6opencl_6cl_mem_16DeviceMemoryView__host_pointer(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer_1__set__(o, v);
  }
  else {
    return __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13_host_pointer_2__del__(o);
  }
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem_DeviceMemoryView[] = {
  {__Pyx_NAMESTR("reshape"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_3reshape, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("map"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_4map, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_4map)},
  {__Pyx_NAMESTR("from_host"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_5from_host, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_5from_host)},
  {__Pyx_NAMESTR("copy"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_8copy, METH_O, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_8copy)},
  {__Pyx_NAMESTR("item"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_11item, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_11item)},
  {__Pyx_NAMESTR("read"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_12read, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_12read)},
  {__Pyx_NAMESTR("write"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_13write, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_13write)},
  {__Pyx_NAMESTR("_view_as_this"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_15_view_as_this, METH_O, __Pyx_DOCSTR(__pyx_doc_6opencl_6cl_mem_16DeviceMemoryView_15_view_as_this)},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6opencl_6cl_mem_DeviceMemoryView[] = {
  {(char *)"array_info", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_array_info, 0, 0, 0},
  {(char *)"offset_", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_offset_, 0, __Pyx_DOCSTR(__pyx_k_61), 0},
  {(char *)"ndim", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_ndim, 0, __Pyx_DOCSTR(__pyx_k_62), 0},
  {(char *)"readonly", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_readonly, 0, __Pyx_DOCSTR(__pyx_k_63), 0},
  {(char *)"itemsize", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_itemsize, 0, __Pyx_DOCSTR(__pyx_k_64), 0},
  {(char *)"format", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_format, 0, __Pyx_DOCSTR(__pyx_k_65), 0},
  {(char *)"shape", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_shape, 0, __Pyx_DOCSTR(__pyx_k_66), 0},
  {(char *)"strides", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_strides, 0, __Pyx_DOCSTR(__pyx_k_67), 0},
  {(char *)"size", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_size, 0, __Pyx_DOCSTR(__pyx_k_68), 0},
  {(char *)"nbytes", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_nbytes, 0, __Pyx_DOCSTR(__pyx_k_69), 0},
  {(char *)"is_contiguous", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_is_contiguous, 0, __Pyx_DOCSTR(__pyx_k_70), 0},
  {(char *)"ctype", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView_ctype, 0, 0, 0},
  {(char *)"_host_pointer", __pyx_getprop_6opencl_6cl_mem_16DeviceMemoryView__host_pointer, __pyx_setprop_6opencl_6cl_mem_16DeviceMemoryView__host_pointer, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_DeviceMemoryView = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10__int__, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_10__int__, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_9__float__, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_DeviceMemoryView = {
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7__len__, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  __pyx_sq_item_6opencl_6cl_mem_DeviceMemoryView, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_DeviceMemoryView = {
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_7__len__, /*mp_length*/
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_6__getitem__, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_DeviceMemoryView = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_14__releasebuffer__, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem_DeviceMemoryView = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.DeviceMemoryView"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem_DeviceMemoryView, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number_DeviceMemoryView, /*tp_as_number*/
  &__pyx_tp_as_sequence_DeviceMemoryView, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_DeviceMemoryView, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_DeviceMemoryView, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  __Pyx_DOCSTR("\n    A buffer object stores a one-dimensional collection of elements.  Elements of a buffer object can \n    be a scalar data type (such as an int, float), vector data type, or a user-defined structure\n    "), /*tp_doc*/
  __pyx_tp_traverse_6opencl_6cl_mem_DeviceMemoryView, /*tp_traverse*/
  __pyx_tp_clear_6opencl_6cl_mem_DeviceMemoryView, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem_DeviceMemoryView, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6opencl_6cl_mem_DeviceMemoryView, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_6opencl_6cl_mem_16DeviceMemoryView_2__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem_DeviceMemoryView, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyObject *__pyx_tp_new_6opencl_6cl_mem_ImageFormat(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem_ImageFormat(PyObject *o) {
  (*Py_TYPE(o)->tp_free)(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_11ImageFormat_format(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_11ImageFormat_6format___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_11ImageFormat_ctype(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_11ImageFormat_5ctype___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_11ImageFormat_channel_order(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_11ImageFormat_13channel_order___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_11ImageFormat_channel_data_type(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_11ImageFormat_17channel_data_type___get__(o);
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem_ImageFormat[] = {
  {__Pyx_NAMESTR("supported_formats"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_11ImageFormat_supported_formats, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("from_ctype"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_11ImageFormat_1from_ctype, METH_O, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6opencl_6cl_mem_ImageFormat[] = {
  {(char *)"format", __pyx_getprop_6opencl_6cl_mem_11ImageFormat_format, 0, 0, 0},
  {(char *)"ctype", __pyx_getprop_6opencl_6cl_mem_11ImageFormat_ctype, 0, 0, 0},
  {(char *)"channel_order", __pyx_getprop_6opencl_6cl_mem_11ImageFormat_channel_order, 0, 0, 0},
  {(char *)"channel_data_type", __pyx_getprop_6opencl_6cl_mem_11ImageFormat_channel_data_type, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_ImageFormat = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_ImageFormat = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_ImageFormat = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_ImageFormat = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem_ImageFormat = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.ImageFormat"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem_ImageFormat), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem_ImageFormat, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  __pyx_pf_6opencl_6cl_mem_11ImageFormat_3__repr__, /*tp_repr*/
  &__pyx_tp_as_number_ImageFormat, /*tp_as_number*/
  &__pyx_tp_as_sequence_ImageFormat, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_ImageFormat, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_ImageFormat, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE, /*tp_flags*/
  __Pyx_DOCSTR("\n    "), /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  __pyx_pf_6opencl_6cl_mem_11ImageFormat_4__richcmp__, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem_ImageFormat, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6opencl_6cl_mem_ImageFormat, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_6opencl_6cl_mem_11ImageFormat_2__init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem_ImageFormat, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};
static struct __pyx_vtabstruct_6opencl_6cl_mem_Image __pyx_vtable_6opencl_6cl_mem_Image;

static PyObject *__pyx_tp_new_6opencl_6cl_mem_Image(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_6opencl_6cl_mem_Image *p;
  PyObject *o = __pyx_tp_new_6opencl_6cl_mem_MemoryObject(t, a, k);
  if (!o) return 0;
  p = ((struct __pyx_obj_6opencl_6cl_mem_Image *)o);
  p->__pyx_base.__pyx_vtab = (struct __pyx_vtabstruct_6opencl_6cl_mem_MemoryObject*)__pyx_vtabptr_6opencl_6cl_mem_Image;
  p->__weakref__ = 0;
  if (__pyx_pf_6opencl_6cl_mem_5Image___cinit__(o, __pyx_empty_tuple, NULL) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem_Image(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem_Image *p = (struct __pyx_obj_6opencl_6cl_mem_Image *)o;
  if (p->__weakref__) PyObject_ClearWeakRefs(o);
  __pyx_tp_dealloc_6opencl_6cl_mem_MemoryObject(o);
}

static int __pyx_tp_traverse_6opencl_6cl_mem_Image(PyObject *o, visitproc v, void *a) {
  int e;
  if (__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_traverse) {
    e = __pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_traverse(o, v, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6opencl_6cl_mem_Image(PyObject *o) {
  if (__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_clear) {
    __pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_clear(o);
  }
  return 0;
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_image_format(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_12image_format___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_image_width(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_11image_width___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_image_height(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_12image_height___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_image_depth(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_11image_depth___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_format(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_6format___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_shape(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_5shape___get__(o);
}

static PyObject *__pyx_getprop_6opencl_6cl_mem_5Image_strides(PyObject *o, void *x) {
  return __pyx_pf_6opencl_6cl_mem_5Image_7strides___get__(o);
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem_Image[] = {
  {__Pyx_NAMESTR("map"), (PyCFunction)__pyx_pf_6opencl_6cl_mem_5Image_1map, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_6opencl_6cl_mem_Image[] = {
  {(char *)"image_format", __pyx_getprop_6opencl_6cl_mem_5Image_image_format, 0, 0, 0},
  {(char *)"image_width", __pyx_getprop_6opencl_6cl_mem_5Image_image_width, 0, 0, 0},
  {(char *)"image_height", __pyx_getprop_6opencl_6cl_mem_5Image_image_height, 0, 0, 0},
  {(char *)"image_depth", __pyx_getprop_6opencl_6cl_mem_5Image_image_depth, 0, 0, 0},
  {(char *)"format", __pyx_getprop_6opencl_6cl_mem_5Image_format, 0, 0, 0},
  {(char *)"shape", __pyx_getprop_6opencl_6cl_mem_5Image_shape, 0, 0, 0},
  {(char *)"strides", __pyx_getprop_6opencl_6cl_mem_5Image_strides, 0, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_Image = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_Image = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_Image = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_Image = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem_Image = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.Image"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem_Image), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem_Image, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number_Image, /*tp_as_number*/
  &__pyx_tp_as_sequence_Image, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_Image, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_Image, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6opencl_6cl_mem_Image, /*tp_traverse*/
  __pyx_tp_clear_6opencl_6cl_mem_Image, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem_Image, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_6opencl_6cl_mem_Image, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem_Image, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyObject *__pyx_tp_new_6opencl_6cl_mem___pyx_scope_struct__copy(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)o);
  p->__pyx_v_self = 0;
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem___pyx_scope_struct__copy(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *p = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)o;
  Py_XDECREF(((PyObject *)p->__pyx_v_self));
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6opencl_6cl_mem___pyx_scope_struct__copy(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *p = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)o;
  if (p->__pyx_v_self) {
    e = (*v)(((PyObject*)p->__pyx_v_self), a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6opencl_6cl_mem___pyx_scope_struct__copy(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *p = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->__pyx_v_self);
  p->__pyx_v_self = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem___pyx_scope_struct__copy[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number___pyx_scope_struct__copy = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence___pyx_scope_struct__copy = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping___pyx_scope_struct__copy = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer___pyx_scope_struct__copy = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem___pyx_scope_struct__copy = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.__pyx_scope_struct__copy"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem___pyx_scope_struct__copy, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number___pyx_scope_struct__copy, /*tp_as_number*/
  &__pyx_tp_as_sequence___pyx_scope_struct__copy, /*tp_as_sequence*/
  &__pyx_tp_as_mapping___pyx_scope_struct__copy, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer___pyx_scope_struct__copy, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6opencl_6cl_mem___pyx_scope_struct__copy, /*tp_traverse*/
  __pyx_tp_clear_6opencl_6cl_mem___pyx_scope_struct__copy, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem___pyx_scope_struct__copy, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem___pyx_scope_struct__copy, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyObject *__pyx_tp_new_6opencl_6cl_mem___pyx_Generator(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_Generator_object *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_Generator_object *)o);
  p->exc_type = 0;
  p->exc_value = 0;
  p->exc_traceback = 0;
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem___pyx_Generator(PyObject *o) {
  struct __pyx_Generator_object *p = (struct __pyx_Generator_object *)o;
  Py_XDECREF(p->exc_type);
  Py_XDECREF(p->exc_value);
  Py_XDECREF(p->exc_traceback);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_6opencl_6cl_mem___pyx_Generator(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_Generator_object *p = (struct __pyx_Generator_object *)o;
  if (p->exc_type) {
    e = (*v)(p->exc_type, a); if (e) return e;
  }
  if (p->exc_value) {
    e = (*v)(p->exc_value, a); if (e) return e;
  }
  if (p->exc_traceback) {
    e = (*v)(p->exc_traceback, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6opencl_6cl_mem___pyx_Generator(PyObject *o) {
  struct __pyx_Generator_object *p = (struct __pyx_Generator_object *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->exc_type);
  p->exc_type = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->exc_value);
  p->exc_value = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->exc_traceback);
  p->exc_traceback = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem___pyx_Generator[] = {
  {__Pyx_NAMESTR("send"), (PyCFunction)__Pyx_Generator_Send, METH_O, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("close"), (PyCFunction)__Pyx_Generator_Close, METH_NOARGS, __Pyx_DOCSTR(0)},
  {__Pyx_NAMESTR("throw"), (PyCFunction)__Pyx_Generator_Throw, METH_VARARGS|METH_KEYWORDS, __Pyx_DOCSTR(0)},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number___pyx_Generator = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence___pyx_Generator = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping___pyx_Generator = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer___pyx_Generator = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_Generator_type = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.__pyx_Generator"), /*tp_name*/
  sizeof(struct __pyx_Generator_object), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem___pyx_Generator, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number___pyx_Generator, /*tp_as_number*/
  &__pyx_tp_as_sequence___pyx_Generator, /*tp_as_sequence*/
  &__pyx_tp_as_mapping___pyx_Generator, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer___pyx_Generator, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6opencl_6cl_mem___pyx_Generator, /*tp_traverse*/
  __pyx_tp_clear_6opencl_6cl_mem___pyx_Generator, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  PyObject_SelfIter, /*tp_iter*/
  __Pyx_Generator_Next, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem___pyx_Generator, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem___pyx_Generator, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyObject *__pyx_tp_new_6opencl_6cl_mem___pyx_scope_struct_1_genexpr(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *p;
  PyObject *o = __pyx_tp_new_6opencl_6cl_mem___pyx_Generator(t, a, k);
  if (!o) return 0;
  p = ((struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *)o);
  p->__pyx_outer_scope = 0;
  p->__pyx_v_stride = 0;
  p->__pyx_t_0 = 0;
  return o;
}

static void __pyx_tp_dealloc_6opencl_6cl_mem___pyx_scope_struct_1_genexpr(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *p = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *)o;
  Py_XDECREF(((PyObject *)p->__pyx_outer_scope));
  Py_XDECREF(p->__pyx_v_stride);
  Py_XDECREF(p->__pyx_t_0);
  __pyx_tp_dealloc_6opencl_6cl_mem___pyx_Generator(o);
}

static int __pyx_tp_traverse_6opencl_6cl_mem___pyx_scope_struct_1_genexpr(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *p = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *)o;
  e = __pyx_tp_traverse_6opencl_6cl_mem___pyx_Generator(o, v, a); if (e) return e;
  if (p->__pyx_outer_scope) {
    e = (*v)(((PyObject*)p->__pyx_outer_scope), a); if (e) return e;
  }
  if (p->__pyx_v_stride) {
    e = (*v)(p->__pyx_v_stride, a); if (e) return e;
  }
  if (p->__pyx_t_0) {
    e = (*v)(p->__pyx_t_0, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_6opencl_6cl_mem___pyx_scope_struct_1_genexpr(PyObject *o) {
  struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *p = (struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr *)o;
  PyObject* tmp;
  __pyx_tp_clear_6opencl_6cl_mem___pyx_Generator(o);
  tmp = ((PyObject*)p->__pyx_outer_scope);
  p->__pyx_outer_scope = ((struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct__copy *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->__pyx_v_stride);
  p->__pyx_v_stride = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->__pyx_t_0);
  p->__pyx_t_0 = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyMethodDef __pyx_methods_6opencl_6cl_mem___pyx_scope_struct_1_genexpr[] = {
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number___pyx_scope_struct_1_genexpr = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_long*/
  #else
  0, /*reserved*/
  #endif
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if PY_VERSION_HEX >= 0x02050000
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence___pyx_scope_struct_1_genexpr = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping___pyx_scope_struct_1_genexpr = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer___pyx_scope_struct_1_genexpr = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

static PyTypeObject __pyx_type_6opencl_6cl_mem___pyx_scope_struct_1_genexpr = {
  PyVarObject_HEAD_INIT(0, 0)
  __Pyx_NAMESTR("opencl.cl_mem.__pyx_scope_struct_1_genexpr"), /*tp_name*/
  sizeof(struct __pyx_obj_6opencl_6cl_mem___pyx_scope_struct_1_genexpr), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_6opencl_6cl_mem___pyx_scope_struct_1_genexpr, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  #if PY_MAJOR_VERSION < 3
  0, /*tp_compare*/
  #else
  0, /*reserved*/
  #endif
  0, /*tp_repr*/
  &__pyx_tp_as_number___pyx_scope_struct_1_genexpr, /*tp_as_number*/
  &__pyx_tp_as_sequence___pyx_scope_struct_1_genexpr, /*tp_as_sequence*/
  &__pyx_tp_as_mapping___pyx_scope_struct_1_genexpr, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer___pyx_scope_struct_1_genexpr, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_6opencl_6cl_mem___pyx_scope_struct_1_genexpr, /*tp_traverse*/
  __pyx_tp_clear_6opencl_6cl_mem___pyx_scope_struct_1_genexpr, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_6opencl_6cl_mem___pyx_scope_struct_1_genexpr, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_6opencl_6cl_mem___pyx_scope_struct_1_genexpr, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
  0, /*tp_del*/
  #if PY_VERSION_HEX >= 0x02060000
  0, /*tp_version_tag*/
  #endif
};

static PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    __Pyx_NAMESTR("cl_mem"),
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp_s_1, __pyx_k_1, sizeof(__pyx_k_1), 0, 0, 1, 0},
  {&__pyx_n_s_10, __pyx_k_10, sizeof(__pyx_k_10), 0, 0, 1, 1},
  {&__pyx_kp_s_14, __pyx_k_14, sizeof(__pyx_k_14), 0, 0, 1, 0},
  {&__pyx_kp_s_16, __pyx_k_16, sizeof(__pyx_k_16), 0, 0, 1, 0},
  {&__pyx_kp_s_18, __pyx_k_18, sizeof(__pyx_k_18), 0, 0, 1, 0},
  {&__pyx_kp_s_19, __pyx_k_19, sizeof(__pyx_k_19), 0, 0, 1, 0},
  {&__pyx_kp_s_21, __pyx_k_21, sizeof(__pyx_k_21), 0, 0, 1, 0},
  {&__pyx_kp_s_23, __pyx_k_23, sizeof(__pyx_k_23), 0, 0, 1, 0},
  {&__pyx_n_s_26, __pyx_k_26, sizeof(__pyx_k_26), 0, 0, 1, 1},
  {&__pyx_kp_s_28, __pyx_k_28, sizeof(__pyx_k_28), 0, 0, 1, 0},
  {&__pyx_kp_s_3, __pyx_k_3, sizeof(__pyx_k_3), 0, 0, 1, 0},
  {&__pyx_n_s_32, __pyx_k_32, sizeof(__pyx_k_32), 0, 0, 1, 1},
  {&__pyx_kp_s_33, __pyx_k_33, sizeof(__pyx_k_33), 0, 0, 1, 0},
  {&__pyx_kp_s_38, __pyx_k_38, sizeof(__pyx_k_38), 0, 0, 1, 0},
  {&__pyx_n_s_40, __pyx_k_40, sizeof(__pyx_k_40), 0, 0, 1, 1},
  {&__pyx_kp_s_41, __pyx_k_41, sizeof(__pyx_k_41), 0, 0, 1, 0},
  {&__pyx_kp_s_42, __pyx_k_42, sizeof(__pyx_k_42), 0, 0, 1, 0},
  {&__pyx_kp_s_45, __pyx_k_45, sizeof(__pyx_k_45), 0, 0, 1, 0},
  {&__pyx_kp_s_47, __pyx_k_47, sizeof(__pyx_k_47), 0, 0, 1, 0},
  {&__pyx_kp_s_49, __pyx_k_49, sizeof(__pyx_k_49), 0, 0, 1, 0},
  {&__pyx_kp_s_5, __pyx_k_5, sizeof(__pyx_k_5), 0, 0, 1, 0},
  {&__pyx_kp_s_51, __pyx_k_51, sizeof(__pyx_k_51), 0, 0, 1, 0},
  {&__pyx_kp_s_52, __pyx_k_52, sizeof(__pyx_k_52), 0, 0, 1, 0},
  {&__pyx_kp_s_54, __pyx_k_54, sizeof(__pyx_k_54), 0, 0, 1, 0},
  {&__pyx_n_s_71, __pyx_k_71, sizeof(__pyx_k_71), 0, 0, 1, 1},
  {&__pyx_n_s_72, __pyx_k_72, sizeof(__pyx_k_72), 0, 0, 1, 1},
  {&__pyx_n_s_73, __pyx_k_73, sizeof(__pyx_k_73), 0, 0, 1, 1},
  {&__pyx_kp_s_74, __pyx_k_74, sizeof(__pyx_k_74), 0, 0, 1, 0},
  {&__pyx_kp_s_75, __pyx_k_75, sizeof(__pyx_k_75), 0, 0, 1, 0},
  {&__pyx_kp_s_76, __pyx_k_76, sizeof(__pyx_k_76), 0, 0, 1, 0},
  {&__pyx_kp_s_77, __pyx_k_77, sizeof(__pyx_k_77), 0, 0, 1, 0},
  {&__pyx_kp_s_78, __pyx_k_78, sizeof(__pyx_k_78), 0, 0, 1, 0},
  {&__pyx_kp_s_79, __pyx_k_79, sizeof(__pyx_k_79), 0, 0, 1, 0},
  {&__pyx_n_s__B, __pyx_k__B, sizeof(__pyx_k__B), 0, 0, 1, 1},
  {&__pyx_n_s__BUFFER, __pyx_k__BUFFER, sizeof(__pyx_k__BUFFER), 0, 0, 1, 1},
  {&__pyx_n_s__CHANNEL_DTYPES, __pyx_k__CHANNEL_DTYPES, sizeof(__pyx_k__CHANNEL_DTYPES), 0, 0, 1, 1},
  {&__pyx_n_s__CHANNEL_ORDERS, __pyx_k__CHANNEL_ORDERS, sizeof(__pyx_k__CHANNEL_ORDERS), 0, 0, 1, 1},
  {&__pyx_n_s__CL_A, __pyx_k__CL_A, sizeof(__pyx_k__CL_A), 0, 0, 1, 1},
  {&__pyx_n_s__CL_ARGB, __pyx_k__CL_ARGB, sizeof(__pyx_k__CL_ARGB), 0, 0, 1, 1},
  {&__pyx_n_s__CL_BGRA, __pyx_k__CL_BGRA, sizeof(__pyx_k__CL_BGRA), 0, 0, 1, 1},
  {&__pyx_n_s__CL_FLOAT, __pyx_k__CL_FLOAT, sizeof(__pyx_k__CL_FLOAT), 0, 0, 1, 1},
  {&__pyx_n_s__CL_HALF_FLOAT, __pyx_k__CL_HALF_FLOAT, sizeof(__pyx_k__CL_HALF_FLOAT), 0, 0, 1, 1},
  {&__pyx_n_s__CL_INTENSITY, __pyx_k__CL_INTENSITY, sizeof(__pyx_k__CL_INTENSITY), 0, 0, 1, 1},
  {&__pyx_n_s__CL_LUMINANCE, __pyx_k__CL_LUMINANCE, sizeof(__pyx_k__CL_LUMINANCE), 0, 0, 1, 1},
  {&__pyx_n_s__CL_R, __pyx_k__CL_R, sizeof(__pyx_k__CL_R), 0, 0, 1, 1},
  {&__pyx_n_s__CL_RA, __pyx_k__CL_RA, sizeof(__pyx_k__CL_RA), 0, 0, 1, 1},
  {&__pyx_n_s__CL_RG, __pyx_k__CL_RG, sizeof(__pyx_k__CL_RG), 0, 0, 1, 1},
  {&__pyx_n_s__CL_RGB, __pyx_k__CL_RGB, sizeof(__pyx_k__CL_RGB), 0, 0, 1, 1},
  {&__pyx_n_s__CL_RGBA, __pyx_k__CL_RGBA, sizeof(__pyx_k__CL_RGBA), 0, 0, 1, 1},
  {&__pyx_n_s__CL_RGBx, __pyx_k__CL_RGBx, sizeof(__pyx_k__CL_RGBx), 0, 0, 1, 1},
  {&__pyx_n_s__CL_RGx, __pyx_k__CL_RGx, sizeof(__pyx_k__CL_RGx), 0, 0, 1, 1},
  {&__pyx_n_s__CL_Rx, __pyx_k__CL_Rx, sizeof(__pyx_k__CL_Rx), 0, 0, 1, 1},
  {&__pyx_n_s__CL_SIGNED_INT16, __pyx_k__CL_SIGNED_INT16, sizeof(__pyx_k__CL_SIGNED_INT16), 0, 0, 1, 1},
  {&__pyx_n_s__CL_SIGNED_INT32, __pyx_k__CL_SIGNED_INT32, sizeof(__pyx_k__CL_SIGNED_INT32), 0, 0, 1, 1},
  {&__pyx_n_s__CL_SIGNED_INT8, __pyx_k__CL_SIGNED_INT8, sizeof(__pyx_k__CL_SIGNED_INT8), 0, 0, 1, 1},
  {&__pyx_n_s__CL_SNORM_INT16, __pyx_k__CL_SNORM_INT16, sizeof(__pyx_k__CL_SNORM_INT16), 0, 0, 1, 1},
  {&__pyx_n_s__CL_SNORM_INT8, __pyx_k__CL_SNORM_INT8, sizeof(__pyx_k__CL_SNORM_INT8), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNORM_INT16, __pyx_k__CL_UNORM_INT16, sizeof(__pyx_k__CL_UNORM_INT16), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNORM_INT8, __pyx_k__CL_UNORM_INT8, sizeof(__pyx_k__CL_UNORM_INT8), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNORM_INT_101010, __pyx_k__CL_UNORM_INT_101010, sizeof(__pyx_k__CL_UNORM_INT_101010), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNORM_SHORT_555, __pyx_k__CL_UNORM_SHORT_555, sizeof(__pyx_k__CL_UNORM_SHORT_555), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNORM_SHORT_565, __pyx_k__CL_UNORM_SHORT_565, sizeof(__pyx_k__CL_UNORM_SHORT_565), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNSIGNED_INT16, __pyx_k__CL_UNSIGNED_INT16, sizeof(__pyx_k__CL_UNSIGNED_INT16), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNSIGNED_INT32, __pyx_k__CL_UNSIGNED_INT32, sizeof(__pyx_k__CL_UNSIGNED_INT32), 0, 0, 1, 1},
  {&__pyx_n_s__CL_UNSIGNED_INT8, __pyx_k__CL_UNSIGNED_INT8, sizeof(__pyx_k__CL_UNSIGNED_INT8), 0, 0, 1, 1},
  {&__pyx_n_s__Exception, __pyx_k__Exception, sizeof(__pyx_k__Exception), 0, 0, 1, 1},
  {&__pyx_n_s__H, __pyx_k__H, sizeof(__pyx_k__H), 0, 0, 1, 1},
  {&__pyx_n_s__IMAGE2D, __pyx_k__IMAGE2D, sizeof(__pyx_k__IMAGE2D), 0, 0, 1, 1},
  {&__pyx_n_s__IMAGE3D, __pyx_k__IMAGE3D, sizeof(__pyx_k__IMAGE3D), 0, 0, 1, 1},
  {&__pyx_n_s__ImageMap, __pyx_k__ImageMap, sizeof(__pyx_k__ImageMap), 0, 0, 1, 1},
  {&__pyx_n_s__IndexError, __pyx_k__IndexError, sizeof(__pyx_k__IndexError), 0, 0, 1, 1},
  {&__pyx_n_s__L, __pyx_k__L, sizeof(__pyx_k__L), 0, 0, 1, 1},
  {&__pyx_n_s__MemoryViewMap, __pyx_k__MemoryViewMap, sizeof(__pyx_k__MemoryViewMap), 0, 0, 1, 1},
  {&__pyx_n_s__NotImplemented, __pyx_k__NotImplemented, sizeof(__pyx_k__NotImplemented), 0, 0, 1, 1},
  {&__pyx_n_s__NotImplementedError, __pyx_k__NotImplementedError, sizeof(__pyx_k__NotImplementedError), 0, 0, 1, 1},
  {&__pyx_n_s__OpenCLException, __pyx_k__OpenCLException, sizeof(__pyx_k__OpenCLException), 0, 0, 1, 1},
  {&__pyx_n_s__Queue, __pyx_k__Queue, sizeof(__pyx_k__Queue), 0, 0, 1, 1},
  {&__pyx_n_s__TypeError, __pyx_k__TypeError, sizeof(__pyx_k__TypeError), 0, 0, 1, 1},
  {&__pyx_n_s__ValueError, __pyx_k__ValueError, sizeof(__pyx_k__ValueError), 0, 0, 1, 1},
  {&__pyx_n_s___CHANNEL_CTYPE_MAP, __pyx_k___CHANNEL_CTYPE_MAP, sizeof(__pyx_k___CHANNEL_CTYPE_MAP), 0, 0, 1, 1},
  {&__pyx_n_s____builtin__, __pyx_k____builtin__, sizeof(__pyx_k____builtin__), 0, 0, 1, 1},
  {&__pyx_n_s____main__, __pyx_k____main__, sizeof(__pyx_k____main__), 0, 0, 1, 1},
  {&__pyx_n_s____new__, __pyx_k____new__, sizeof(__pyx_k____new__), 0, 0, 1, 1},
  {&__pyx_n_s____test__, __pyx_k____test__, sizeof(__pyx_k____test__), 0, 0, 1, 1},
  {&__pyx_n_s___host_pointer, __pyx_k___host_pointer, sizeof(__pyx_k___host_pointer), 0, 0, 1, 1},
  {&__pyx_n_s___view_as_this, __pyx_k___view_as_this, sizeof(__pyx_k___view_as_this), 0, 0, 1, 1},
  {&__pyx_n_s__any, __pyx_k__any, sizeof(__pyx_k__any), 0, 0, 1, 1},
  {&__pyx_n_s__array, __pyx_k__array, sizeof(__pyx_k__array), 0, 0, 1, 1},
  {&__pyx_n_s__b, __pyx_k__b, sizeof(__pyx_k__b), 0, 0, 1, 1},
  {&__pyx_n_s__blocking, __pyx_k__blocking, sizeof(__pyx_k__blocking), 0, 0, 1, 1},
  {&__pyx_n_s__blocking_read, __pyx_k__blocking_read, sizeof(__pyx_k__blocking_read), 0, 0, 1, 1},
  {&__pyx_n_s__broadcast, __pyx_k__broadcast, sizeof(__pyx_k__broadcast), 0, 0, 1, 1},
  {&__pyx_n_s__buf, __pyx_k__buf, sizeof(__pyx_k__buf), 0, 0, 1, 1},
  {&__pyx_n_s__c_float, __pyx_k__c_float, sizeof(__pyx_k__c_float), 0, 0, 1, 1},
  {&__pyx_n_s__c_int, __pyx_k__c_int, sizeof(__pyx_k__c_int), 0, 0, 1, 1},
  {&__pyx_n_s__c_void_p, __pyx_k__c_void_p, sizeof(__pyx_k__c_void_p), 0, 0, 1, 1},
  {&__pyx_n_s__callback, __pyx_k__callback, sizeof(__pyx_k__callback), 0, 0, 1, 1},
  {&__pyx_n_s__channel_data_type, __pyx_k__channel_data_type, sizeof(__pyx_k__channel_data_type), 0, 0, 1, 1},
  {&__pyx_n_s__channel_order, __pyx_k__channel_order, sizeof(__pyx_k__channel_order), 0, 0, 1, 1},
  {&__pyx_n_s__cl_types, __pyx_k__cl_types, sizeof(__pyx_k__cl_types), 0, 0, 1, 1},
  {&__pyx_n_s__cl_uint8, __pyx_k__cl_uint8, sizeof(__pyx_k__cl_uint8), 0, 0, 1, 1},
  {&__pyx_n_s__context, __pyx_k__context, sizeof(__pyx_k__context), 0, 0, 1, 1},
  {&__pyx_n_s__copy, __pyx_k__copy, sizeof(__pyx_k__copy), 0, 0, 1, 1},
  {&__pyx_n_s__ctype, __pyx_k__ctype, sizeof(__pyx_k__ctype), 0, 0, 1, 1},
  {&__pyx_n_s__ctype_from_format, __pyx_k__ctype_from_format, sizeof(__pyx_k__ctype_from_format), 0, 0, 1, 1},
  {&__pyx_n_s__ctypes, __pyx_k__ctypes, sizeof(__pyx_k__ctypes), 0, 0, 1, 1},
  {&__pyx_n_s__dst_offset, __pyx_k__dst_offset, sizeof(__pyx_k__dst_offset), 0, 0, 1, 1},
  {&__pyx_n_s__dtype, __pyx_k__dtype, sizeof(__pyx_k__dtype), 0, 0, 1, 1},
  {&__pyx_n_s__empty, __pyx_k__empty, sizeof(__pyx_k__empty), 0, 0, 1, 1},
  {&__pyx_n_s__empty_image, __pyx_k__empty_image, sizeof(__pyx_k__empty_image), 0, 0, 1, 1},
  {&__pyx_n_s__encode, __pyx_k__encode, sizeof(__pyx_k__encode), 0, 0, 1, 1},
  {&__pyx_n_s__enqueue_copy_buffer, __pyx_k__enqueue_copy_buffer, sizeof(__pyx_k__enqueue_copy_buffer), 0, 0, 1, 1},
  {&__pyx_n_s__enqueue_read_buffer, __pyx_k__enqueue_read_buffer, sizeof(__pyx_k__enqueue_read_buffer), 0, 0, 1, 1},
  {&__pyx_n_s__enumerate, __pyx_k__enumerate, sizeof(__pyx_k__enumerate), 0, 0, 1, 1},
  {&__pyx_n_s__f, __pyx_k__f, sizeof(__pyx_k__f), 0, 0, 1, 1},
  {&__pyx_n_s__format, __pyx_k__format, sizeof(__pyx_k__format), 0, 0, 1, 1},
  {&__pyx_n_s__from_ctype, __pyx_k__from_ctype, sizeof(__pyx_k__from_ctype), 0, 0, 1, 1},
  {&__pyx_n_s__from_host, __pyx_k__from_host, sizeof(__pyx_k__from_host), 0, 0, 1, 1},
  {&__pyx_n_s__h, __pyx_k__h, sizeof(__pyx_k__h), 0, 0, 1, 1},
  {&__pyx_n_s__host, __pyx_k__host, sizeof(__pyx_k__host), 0, 0, 1, 1},
  {&__pyx_n_s__image_depth, __pyx_k__image_depth, sizeof(__pyx_k__image_depth), 0, 0, 1, 1},
  {&__pyx_n_s__image_format, __pyx_k__image_format, sizeof(__pyx_k__image_format), 0, 0, 1, 1},
  {&__pyx_n_s__image_height, __pyx_k__image_height, sizeof(__pyx_k__image_height), 0, 0, 1, 1},
  {&__pyx_n_s__image_width, __pyx_k__image_width, sizeof(__pyx_k__image_width), 0, 0, 1, 1},
  {&__pyx_n_s__indices, __pyx_k__indices, sizeof(__pyx_k__indices), 0, 0, 1, 1},
  {&__pyx_n_s__is_contiguous, __pyx_k__is_contiguous, sizeof(__pyx_k__is_contiguous), 0, 0, 1, 1},
  {&__pyx_n_s__is_string, __pyx_k__is_string, sizeof(__pyx_k__is_string), 0, 0, 1, 1},
  {&__pyx_n_s__item, __pyx_k__item, sizeof(__pyx_k__item), 0, 0, 1, 1},
  {&__pyx_n_s__items, __pyx_k__items, sizeof(__pyx_k__items), 0, 0, 1, 1},
  {&__pyx_n_s__itemsize, __pyx_k__itemsize, sizeof(__pyx_k__itemsize), 0, 0, 1, 1},
  {&__pyx_n_s__l, __pyx_k__l, sizeof(__pyx_k__l), 0, 0, 1, 1},
  {&__pyx_n_s__major, __pyx_k__major, sizeof(__pyx_k__major), 0, 0, 1, 1},
  {&__pyx_n_s__mem, __pyx_k__mem, sizeof(__pyx_k__mem), 0, 0, 1, 1},
  {&__pyx_n_s__mem_layout, __pyx_k__mem_layout, sizeof(__pyx_k__mem_layout), 0, 0, 1, 1},
  {&__pyx_n_s__mem_size, __pyx_k__mem_size, sizeof(__pyx_k__mem_size), 0, 0, 1, 1},
  {&__pyx_n_s__mock_callback, __pyx_k__mock_callback, sizeof(__pyx_k__mock_callback), 0, 0, 1, 1},
  {&__pyx_n_s__nbytes, __pyx_k__nbytes, sizeof(__pyx_k__nbytes), 0, 0, 1, 1},
  {&__pyx_n_s__offset_, __pyx_k__offset_, sizeof(__pyx_k__offset_), 0, 0, 1, 1},
  {&__pyx_n_s__opencl, __pyx_k__opencl, sizeof(__pyx_k__opencl), 0, 0, 1, 1},
  {&__pyx_n_s__order, __pyx_k__order, sizeof(__pyx_k__order), 0, 0, 1, 1},
  {&__pyx_n_s__out, __pyx_k__out, sizeof(__pyx_k__out), 0, 0, 1, 1},
  {&__pyx_n_s__queue, __pyx_k__queue, sizeof(__pyx_k__queue), 0, 0, 1, 1},
  {&__pyx_n_s__range, __pyx_k__range, sizeof(__pyx_k__range), 0, 0, 1, 1},
  {&__pyx_n_s__read, __pyx_k__read, sizeof(__pyx_k__read), 0, 0, 1, 1},
  {&__pyx_n_s__readable, __pyx_k__readable, sizeof(__pyx_k__readable), 0, 0, 1, 1},
  {&__pyx_n_s__readonly, __pyx_k__readonly, sizeof(__pyx_k__readonly), 0, 0, 1, 1},
  {&__pyx_n_s__shape, __pyx_k__shape, sizeof(__pyx_k__shape), 0, 0, 1, 1},
  {&__pyx_n_s__size, __pyx_k__size, sizeof(__pyx_k__size), 0, 0, 1, 1},
  {&__pyx_n_s__size_from_format, __pyx_k__size_from_format, sizeof(__pyx_k__size_from_format), 0, 0, 1, 1},
  {&__pyx_n_s__src_offset, __pyx_k__src_offset, sizeof(__pyx_k__src_offset), 0, 0, 1, 1},
  {&__pyx_n_s__strides, __pyx_k__strides, sizeof(__pyx_k__strides), 0, 0, 1, 1},
  {&__pyx_n_s__struct, __pyx_k__struct, sizeof(__pyx_k__struct), 0, 0, 1, 1},
  {&__pyx_n_s__struct_name, __pyx_k__struct_name, sizeof(__pyx_k__struct_name), 0, 0, 1, 1},
  {&__pyx_n_s__supported_formats, __pyx_k__supported_formats, sizeof(__pyx_k__supported_formats), 0, 0, 1, 1},
  {&__pyx_n_s__sys, __pyx_k__sys, sizeof(__pyx_k__sys), 0, 0, 1, 1},
  {&__pyx_n_s__type, __pyx_k__type, sizeof(__pyx_k__type), 0, 0, 1, 1},
  {&__pyx_n_s__type_format, __pyx_k__type_format, sizeof(__pyx_k__type_format), 0, 0, 1, 1},
  {&__pyx_n_s__unicode, __pyx_k__unicode, sizeof(__pyx_k__unicode), 0, 0, 1, 1},
  {&__pyx_n_s__value, __pyx_k__value, sizeof(__pyx_k__value), 0, 0, 1, 1},
  {&__pyx_n_s__version_info, __pyx_k__version_info, sizeof(__pyx_k__version_info), 0, 0, 1, 1},
  {&__pyx_n_s__view, __pyx_k__view, sizeof(__pyx_k__view), 0, 0, 1, 1},
  {&__pyx_n_s__wait_on, __pyx_k__wait_on, sizeof(__pyx_k__wait_on), 0, 0, 1, 1},
  {&__pyx_n_s__weakref, __pyx_k__weakref, sizeof(__pyx_k__weakref), 0, 0, 1, 1},
  {&__pyx_n_s__wirteable, __pyx_k__wirteable, sizeof(__pyx_k__wirteable), 0, 0, 1, 1},
  {&__pyx_n_s__writeable, __pyx_k__writeable, sizeof(__pyx_k__writeable), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_TypeError = __Pyx_GetName(__pyx_b, __pyx_n_s__TypeError); if (!__pyx_builtin_TypeError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_range = __Pyx_GetName(__pyx_b, __pyx_n_s__range); if (!__pyx_builtin_range) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 279; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_n_s__ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_Exception = __Pyx_GetName(__pyx_b, __pyx_n_s__Exception); if (!__pyx_builtin_Exception) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_enumerate = __Pyx_GetName(__pyx_b, __pyx_n_s__enumerate); if (!__pyx_builtin_enumerate) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 360; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_NotImplementedError = __Pyx_GetName(__pyx_b, __pyx_n_s__NotImplementedError); if (!__pyx_builtin_NotImplementedError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_IndexError = __Pyx_GetName(__pyx_b, __pyx_n_s__IndexError); if (!__pyx_builtin_IndexError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_any = __Pyx_GetName(__pyx_b, __pyx_n_s__any); if (!__pyx_builtin_any) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_NotImplemented = __Pyx_GetName(__pyx_b, __pyx_n_s__NotImplemented); if (!__pyx_builtin_NotImplemented) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 980; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants");

  /* "opencl/cl_mem.pyx":273
 * 
 *     def __init__(self):
 *         raise TypeError("Can not initialize 'DeviceMemoryView' directly use 'opencl.empty'")             # <<<<<<<<<<<<<<
 * 
 *     property array_info:
 */
  __pyx_k_tuple_2 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_2));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_1));
  PyTuple_SET_ITEM(__pyx_k_tuple_2, 0, ((PyObject *)__pyx_kp_s_1));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_1));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_2));

  /* "opencl/cl_mem.pyx":338
 * 
 *         if size != self.size:
 *             raise ValueError("total size of new array must be unchanged")             # <<<<<<<<<<<<<<
 * 
 *         if not self.is_contiguous:
 */
  __pyx_k_tuple_4 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_4));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_3));
  PyTuple_SET_ITEM(__pyx_k_tuple_4, 0, ((PyObject *)__pyx_kp_s_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_3));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_4));

  /* "opencl/cl_mem.pyx":341
 * 
 *         if not self.is_contiguous:
 *             raise Exception("array must be contiguous to reshape")             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem buffer_id = self.buffer_id
 */
  __pyx_k_tuple_6 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_6));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_5));
  PyTuple_SET_ITEM(__pyx_k_tuple_6, 0, ((PyObject *)__pyx_kp_s_5));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_5));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_6));

  /* "opencl/cl_mem.pyx":400
 *         '''
 *         if not CyContext_Check(context):
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *         if isinstance(host, int):
 */
  __pyx_k_tuple_15 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 400; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_15));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_14));
  PyTuple_SET_ITEM(__pyx_k_tuple_15, 0, ((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_15));

  /* "opencl/cl_mem.pyx":428
 *             mem_flags |= CL_MEM_WRITE_ONLY
 *         else:
 *             raise Exception("at least one of arguments 'readable' or 'writable' must be true")             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_int err_code
 */
  __pyx_k_tuple_17 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_17)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_17));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_16));
  PyTuple_SET_ITEM(__pyx_k_tuple_17, 0, ((PyObject *)__pyx_kp_s_16));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_16));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_17));

  /* "opencl/cl_mem.pyx":477
 *             return cy_buffer
 *         else:
 *             raise NotImplementedError("data must be contiguous")             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_k_tuple_20 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_20)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_20));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_19));
  PyTuple_SET_ITEM(__pyx_k_tuple_20, 0, ((PyObject *)__pyx_kp_s_19));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_19));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_20));

  /* "opencl/cl_mem.pyx":586
 *                 strides.append(stride * size)
 * 
 *             return self.strides == tuple(strides[::-1])             # <<<<<<<<<<<<<<
 * 
 *     def copy(self, queue):
 */
  __pyx_k_slice_22 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_k_slice_22)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_k_slice_22);
  __Pyx_GIVEREF(__pyx_k_slice_22);

  /* "opencl/cl_mem.pyx":604
 * 
 *         elif any(stride < 0 for stride in self.strides):
 *             raise NotImplementedError("stride < 0")             # <<<<<<<<<<<<<<
 * 
 *         elif self.buffer.ndim == 1:
 */
  __pyx_k_tuple_24 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_24));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_23));
  PyTuple_SET_ITEM(__pyx_k_tuple_24, 0, ((PyObject *)__pyx_kp_s_23));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_23));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_24));

  /* "opencl/cl_mem.pyx":614
 *             region = (dest.itemsize, dest.size, 1)
 *             src_origin = (offset, 0, 0)
 *             dst_origin = (0, 0, 0)             # <<<<<<<<<<<<<<
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 */
  __pyx_k_tuple_25 = PyTuple_New(3); if (unlikely(!__pyx_k_tuple_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_25));
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_k_tuple_25, 0, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_k_tuple_25, 1, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_k_tuple_25, 2, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_25));

  /* "opencl/cl_mem.pyx":630
 *             region = shape2, shape1, shape0
 *             src_origin = (< size_t > self.buffer.buf, 0, 0)
 *             dst_origin = (0, 0, 0)             # <<<<<<<<<<<<<<
 * 
 *             queue.enqueue_copy_buffer_rect(self, dest, region, src_origin, dst_origin,
 */
  __pyx_k_tuple_27 = PyTuple_New(3); if (unlikely(!__pyx_k_tuple_27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_27));
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_k_tuple_27, 0, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_k_tuple_27, 1, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_k_tuple_27, 2, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_27));

  /* "opencl/cl_mem.pyx":653
 *         '''
 *         if self.size != 1:
 *             raise ValueError('can only convert an array  of size 1 to a Python scalar')             # <<<<<<<<<<<<<<
 *         if queue is None:
 *             import opencl
 */
  __pyx_k_tuple_29 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_29));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_28));
  PyTuple_SET_ITEM(__pyx_k_tuple_29, 0, ((PyObject *)__pyx_kp_s_28));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_28));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_29));

  /* "opencl/cl_mem.pyx":740
 *     '''
 *     if not CyContext_Check(context):
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_context ctx = CyContext_GetID(context)
 */
  __pyx_k_tuple_34 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_34));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_14));
  PyTuple_SET_ITEM(__pyx_k_tuple_34, 0, ((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_34));

  /* "opencl/cl_mem.pyx":868
 * 
 *         if not CyContext_Check(context):
 *             raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *         cdef cl_mem_flags flags
 */
  __pyx_k_tuple_37 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 868; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_37));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_14));
  PyTuple_SET_ITEM(__pyx_k_tuple_37, 0, ((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_37));

  /* "opencl/cl_mem.pyx":875
 *             flags = CL_MEM_READ_WRITE
 *         elif not (readable ^ wirteable):
 *             raise TypeError("al least one of readable or wirteable must be True")             # <<<<<<<<<<<<<<
 *         elif readable:
 *             flags = CL_MEM_READ_ONLY
 */
  __pyx_k_tuple_39 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 875; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_39));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_38));
  PyTuple_SET_ITEM(__pyx_k_tuple_39, 0, ((PyObject *)__pyx_kp_s_38));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_38));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_39));

  /* "opencl/cl_mem.pyx":1065
 * def broadcast(DeviceMemoryView view, shape):
 *     if not isinstance(view, DeviceMemoryView):
 *         raise TypeError("argument 'view' must be a valid opencl.DeviceMemoryView object")             # <<<<<<<<<<<<<<
 * 
 *     cdef DeviceMemoryView clview = < DeviceMemoryView > view
 */
  __pyx_k_tuple_46 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_46)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_46));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_45));
  PyTuple_SET_ITEM(__pyx_k_tuple_46, 0, ((PyObject *)__pyx_kp_s_45));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_45));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_46));

  /* "opencl/cl_mem.pyx":1078
 * 
 *     if ndim < buffer.ndim:
 *         raise TypeError("ndim of arguement shape must be >= view.ndim")             # <<<<<<<<<<<<<<
 * 
 *     cdef size_t noff = ndim - buffer.ndim
 */
  __pyx_k_tuple_48 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_48)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1078; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_48));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_47));
  PyTuple_SET_ITEM(__pyx_k_tuple_48, 0, ((PyObject *)__pyx_kp_s_47));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_47));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_48));

  /* "opencl/cl_mem.pyx":1115
 *     '''
 *     if not CyContext_Check(context):
 *         raise TypeError("argument 'context' must be a valid opencl.Context object")             # <<<<<<<<<<<<<<
 * 
 *     if len(shape) not in [2, 3]:
 */
  __pyx_k_tuple_50 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_50)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1115; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_50));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_14));
  PyTuple_SET_ITEM(__pyx_k_tuple_50, 0, ((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_14));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_50));

  /* "opencl/cl_mem.pyx":1128
 * 
 *     if not ImageFormat_Check(image_format):
 *         raise TypeError("arguement 'image_format' must be a valid ImageFormat object")             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_image_format fmt = ImageFormat_Get(image_format)
 */
  __pyx_k_tuple_53 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_53)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_53));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_52));
  PyTuple_SET_ITEM(__pyx_k_tuple_53, 0, ((PyObject *)__pyx_kp_s_52));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_52));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_53));

  /* "opencl/cl_mem.pyx":1276
 *         buffer.ndim = 3
 *     else:
 *         raise TypeError("CyImage_New takes a valid image object as an argument")             # <<<<<<<<<<<<<<
 * 
 *     buffer.buf = NULL
 */
  __pyx_k_tuple_55 = PyTuple_New(1); if (unlikely(!__pyx_k_tuple_55)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_k_tuple_55));
  __Pyx_INCREF(((PyObject *)__pyx_kp_s_54));
  PyTuple_SET_ITEM(__pyx_k_tuple_55, 0, ((PyObject *)__pyx_kp_s_54));
  __Pyx_GIVEREF(((PyObject *)__pyx_kp_s_54));
  __Pyx_GIVEREF(((PyObject *)__pyx_k_tuple_55));
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_neg_1 = PyInt_FromLong(-1); if (unlikely(!__pyx_int_neg_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initcl_mem(void); /*proto*/
PyMODINIT_FUNC initcl_mem(void)
#else
PyMODINIT_FUNC PyInit_cl_mem(void); /*proto*/
PyMODINIT_FUNC PyInit_cl_mem(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit_cl_mem(void)");
  if ( __Pyx_check_binary_version() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #ifdef __pyx_binding_PyCFunctionType_USED
  if (__pyx_binding_PyCFunctionType_init() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4(__Pyx_NAMESTR("cl_mem"), __pyx_methods, 0, 0, PYTHON_API_VERSION);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  #if PY_MAJOR_VERSION < 3
  Py_INCREF(__pyx_m);
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_NAMESTR(__Pyx_BUILTIN_MODULE_NAME));
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (__Pyx_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_module_is_main_opencl__cl_mem) {
    if (__Pyx_SetAttrString(__pyx_m, "__name__", __pyx_n_s____main__) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  }
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Constants init code ---*/
  if (unlikely(__Pyx_InitCachedConstants() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Global init code ---*/
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  if (__Pyx_ExportFunction("CyMemoryObject_Create", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyMemoryObject_Create, "PyObject *(cl_mem)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyView_GetBuffer", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyView_GetBuffer, "int (PyObject *, Py_buffer *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyView_Create", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyView_Create, "PyObject *(cl_mem, Py_buffer *, PyObject *, int)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyMemoryObject_Check", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyMemoryObject_Check, "int (PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyMemoryObject_GetID", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyMemoryObject_GetID, "cl_mem (PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyImageFormat_New", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyImageFormat_New, "PyObject *(cl_image_format)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyImage_New", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyImage_New, "PyObject *(cl_mem)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyView_GetPyBuffer", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyView_GetPyBuffer, "Py_buffer *(PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyImage_GetBuffer", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyImage_GetBuffer, "int (PyObject *, Py_buffer *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyView_CreateSubclass", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyView_CreateSubclass, "PyObject *(PyObject *, cl_mem, Py_buffer *, PyObject *, int)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("CyImage_Create", (void (*)(void))__pyx_f_6opencl_6cl_mem_CyImage_Create, "PyObject *(cl_mem, Py_buffer *, int)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("ImageFormat_Check", (void (*)(void))__pyx_f_6opencl_6cl_mem_ImageFormat_Check, "int (PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ExportFunction("ImageFormat_Get", (void (*)(void))__pyx_f_6opencl_6cl_mem_ImageFormat_Get, "cl_image_format (PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Type init code ---*/
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem_UserData) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "UserData", (PyObject *)&__pyx_type_6opencl_6cl_mem_UserData) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 34; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6opencl_6cl_mem_UserData = &__pyx_type_6opencl_6cl_mem_UserData;
  __pyx_vtabptr_6opencl_6cl_mem_MemoryObject = &__pyx_vtable_6opencl_6cl_mem_MemoryObject;
  __pyx_vtable_6opencl_6cl_mem_MemoryObject._get_base = (cl_mem (*)(struct __pyx_obj_6opencl_6cl_mem_MemoryObject *))__pyx_f_6opencl_6cl_mem_12MemoryObject__get_base;
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem_MemoryObject) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetVtable(__pyx_type_6opencl_6cl_mem_MemoryObject.tp_dict, __pyx_vtabptr_6opencl_6cl_mem_MemoryObject) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "MemoryObject", (PyObject *)&__pyx_type_6opencl_6cl_mem_MemoryObject) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 60; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6opencl_6cl_mem_MemoryObject = &__pyx_type_6opencl_6cl_mem_MemoryObject;
  __pyx_vtabptr_6opencl_6cl_mem_DeviceMemoryView = &__pyx_vtable_6opencl_6cl_mem_DeviceMemoryView;
  __pyx_vtable_6opencl_6cl_mem_DeviceMemoryView.__pyx_base = *__pyx_vtabptr_6opencl_6cl_mem_MemoryObject;
  __pyx_type_6opencl_6cl_mem_DeviceMemoryView.tp_base = __pyx_ptype_6opencl_6cl_mem_MemoryObject;
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem_DeviceMemoryView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetVtable(__pyx_type_6opencl_6cl_mem_DeviceMemoryView.tp_dict, __pyx_vtabptr_6opencl_6cl_mem_DeviceMemoryView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "DeviceMemoryView", (PyObject *)&__pyx_type_6opencl_6cl_mem_DeviceMemoryView) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_type_6opencl_6cl_mem_DeviceMemoryView.tp_weaklistoffset == 0) __pyx_type_6opencl_6cl_mem_DeviceMemoryView.tp_weaklistoffset = offsetof(struct __pyx_obj_6opencl_6cl_mem_DeviceMemoryView, __weakref__);
  __pyx_ptype_6opencl_6cl_mem_DeviceMemoryView = &__pyx_type_6opencl_6cl_mem_DeviceMemoryView;
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem_ImageFormat) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "ImageFormat", (PyObject *)&__pyx_type_6opencl_6cl_mem_ImageFormat) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6opencl_6cl_mem_ImageFormat = &__pyx_type_6opencl_6cl_mem_ImageFormat;
  __pyx_vtabptr_6opencl_6cl_mem_Image = &__pyx_vtable_6opencl_6cl_mem_Image;
  __pyx_vtable_6opencl_6cl_mem_Image.__pyx_base = *__pyx_vtabptr_6opencl_6cl_mem_MemoryObject;
  __pyx_type_6opencl_6cl_mem_Image.tp_base = __pyx_ptype_6opencl_6cl_mem_MemoryObject;
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem_Image) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 983; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetVtable(__pyx_type_6opencl_6cl_mem_Image.tp_dict, __pyx_vtabptr_6opencl_6cl_mem_Image) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 983; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_SetAttrString(__pyx_m, "Image", (PyObject *)&__pyx_type_6opencl_6cl_mem_Image) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 983; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__pyx_type_6opencl_6cl_mem_Image.tp_weaklistoffset == 0) __pyx_type_6opencl_6cl_mem_Image.tp_weaklistoffset = offsetof(struct __pyx_obj_6opencl_6cl_mem_Image, __weakref__);
  __pyx_ptype_6opencl_6cl_mem_Image = &__pyx_type_6opencl_6cl_mem_Image;
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem___pyx_scope_struct__copy) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6opencl_6cl_mem___pyx_scope_struct__copy = &__pyx_type_6opencl_6cl_mem___pyx_scope_struct__copy;
  if (PyType_Ready(&__pyx_Generator_type) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6opencl_6cl_mem___pyx_Generator = &__pyx_Generator_type;
  __pyx_type_6opencl_6cl_mem___pyx_scope_struct_1_genexpr.tp_base = __pyx_ptype_6opencl_6cl_mem___pyx_Generator;
  if (PyType_Ready(&__pyx_type_6opencl_6cl_mem___pyx_scope_struct_1_genexpr) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6opencl_6cl_mem___pyx_scope_struct_1_genexpr = &__pyx_type_6opencl_6cl_mem___pyx_scope_struct_1_genexpr;
  /*--- Type import code ---*/
  __pyx_ptype_7cpython_4bool_bool = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "bool", sizeof(PyBoolObject), 0); if (unlikely(!__pyx_ptype_7cpython_4bool_bool)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 8; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_7cpython_7complex_complex = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "complex", sizeof(PyComplexObject), 0); if (unlikely(!__pyx_ptype_7cpython_7complex_complex)) {__pyx_filename = __pyx_f[2]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Variable import code ---*/
  /*--- Function import code ---*/
  __pyx_t_1 = __Pyx_ImportModule("opencl.context"); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_t_1, "CyContext_GetID", (void (**)(void))&__pyx_f_6opencl_7context_CyContext_GetID, "cl_context (PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_t_1, "CyContext_Create", (void (**)(void))&__pyx_f_6opencl_7context_CyContext_Create, "PyObject *(cl_context)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_ImportFunction(__pyx_t_1, "CyContext_Check", (void (**)(void))&__pyx_f_6opencl_7context_CyContext_Check, "int (PyObject *)") < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  /*--- Execution code ---*/

  /* "opencl/cl_mem.pyx":1
 * import weakref             # <<<<<<<<<<<<<<
 * import struct
 * import ctypes
 */
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__weakref), 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__weakref, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":2
 * import weakref
 * import struct             # <<<<<<<<<<<<<<
 * import ctypes
 * 
 */
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__struct), 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__struct, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":3
 * import weakref
 * import struct
 * import ctypes             # <<<<<<<<<<<<<<
 * 
 * from opencl.type_formats import type_format, size_from_format, ctype_from_format
 */
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s__ctypes), 0, -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__ctypes, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 3; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":5
 * import ctypes
 * 
 * from opencl.type_formats import type_format, size_from_format, ctype_from_format             # <<<<<<<<<<<<<<
 * from opencl.errors import OpenCLException
 * from opencl import cl_types
 */
  __pyx_t_2 = PyList_New(3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__type_format));
  PyList_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__type_format));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__type_format));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__size_from_format));
  PyList_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_n_s__size_from_format));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__size_from_format));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__ctype_from_format));
  PyList_SET_ITEM(__pyx_t_2, 2, ((PyObject *)__pyx_n_s__ctype_from_format));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__ctype_from_format));
  __pyx_t_3 = __Pyx_Import(((PyObject *)__pyx_n_s_71), ((PyObject *)__pyx_t_2), -1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__type_format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__type_format, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__size_from_format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__size_from_format, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__ctype_from_format); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__ctype_from_format, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 5; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":6
 * 
 * from opencl.type_formats import type_format, size_from_format, ctype_from_format
 * from opencl.errors import OpenCLException             # <<<<<<<<<<<<<<
 * from opencl import cl_types
 * 
 */
  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_3));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__OpenCLException));
  PyList_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_n_s__OpenCLException));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__OpenCLException));
  __pyx_t_2 = __Pyx_Import(((PyObject *)__pyx_n_s_72), ((PyObject *)__pyx_t_3), -1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(((PyObject *)__pyx_t_3)); __pyx_t_3 = 0;
  __pyx_t_3 = PyObject_GetAttr(__pyx_t_2, __pyx_n_s__OpenCLException); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__OpenCLException, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 6; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":7
 * from opencl.type_formats import type_format, size_from_format, ctype_from_format
 * from opencl.errors import OpenCLException
 * from opencl import cl_types             # <<<<<<<<<<<<<<
 * 
 * from libc.stdlib cimport malloc, free
 */
  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  __Pyx_INCREF(((PyObject *)__pyx_n_s__cl_types));
  PyList_SET_ITEM(__pyx_t_2, 0, ((PyObject *)__pyx_n_s__cl_types));
  __Pyx_GIVEREF(((PyObject *)__pyx_n_s__cl_types));
  __pyx_t_3 = __Pyx_Import(((PyObject *)__pyx_n_s__opencl), ((PyObject *)__pyx_t_2), -1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__cl_types); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__cl_types, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 7; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":17
 * from _cl cimport *
 * from opencl.context cimport CyContext_GetID, CyContext_Create, CyContext_Check
 * import sys             # <<<<<<<<<<<<<<
 * 
 * mem_layout = cl_types.cl_uint8
 */
  __pyx_t_3 = __Pyx_Import(((PyObject *)__pyx_n_s__sys), 0, -1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__sys, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":19
 * import sys
 * 
 * mem_layout = cl_types.cl_uint8             # <<<<<<<<<<<<<<
 * 
 * cdef extern from "Python.h":
 */
  __pyx_t_3 = __Pyx_GetName(__pyx_m, __pyx_n_s__cl_types); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = PyObject_GetAttr(__pyx_t_3, __pyx_n_s__cl_uint8); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mem_layout, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 19; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":31
 *     void PyEval_InitThreads()
 * 
 * PyEval_InitThreads()             # <<<<<<<<<<<<<<
 * 
 * 
 */
  PyEval_InitThreads();

  /* "opencl/cl_mem.pyx":66
 *     two- or three- dimensional texture, frame-buffer or image.
 *     '''
 *     BUFFER = CL_MEM_OBJECT_BUFFER             # <<<<<<<<<<<<<<
 *     IMAGE2D = CL_MEM_OBJECT_IMAGE2D
 *     IMAGE3D = CL_MEM_OBJECT_IMAGE3D
 */
  __pyx_t_2 = __Pyx_PyInt_FromSize_t(CL_MEM_OBJECT_BUFFER); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_dict, __pyx_n_s__BUFFER, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 66; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_MemoryObject);

  /* "opencl/cl_mem.pyx":67
 *     '''
 *     BUFFER = CL_MEM_OBJECT_BUFFER
 *     IMAGE2D = CL_MEM_OBJECT_IMAGE2D             # <<<<<<<<<<<<<<
 *     IMAGE3D = CL_MEM_OBJECT_IMAGE3D
 * 
 */
  __pyx_t_2 = __Pyx_PyInt_FromSize_t(CL_MEM_OBJECT_IMAGE2D); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_dict, __pyx_n_s__IMAGE2D, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 67; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_MemoryObject);

  /* "opencl/cl_mem.pyx":68
 *     BUFFER = CL_MEM_OBJECT_BUFFER
 *     IMAGE2D = CL_MEM_OBJECT_IMAGE2D
 *     IMAGE3D = CL_MEM_OBJECT_IMAGE3D             # <<<<<<<<<<<<<<
 * 
 *     cdef cl_mem buffer_id
 */
  __pyx_t_2 = __Pyx_PyInt_FromSize_t(CL_MEM_OBJECT_IMAGE3D); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_MemoryObject->tp_dict, __pyx_n_s__IMAGE3D, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 68; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_MemoryObject);

  /* "opencl/cl_mem.pyx":244
 * 
 * 
 * def mock_callback(mem, array):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6opencl_6cl_mem_mock_callback, NULL, __pyx_n_s_73); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__mock_callback, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":371
 * 
 * 
 *     def map(self, queue, blocking=True, readable=True, writeable=True):             # <<<<<<<<<<<<<<
 *         '''
 *         DeviceMemoryView.map(queue, blocking=True, readable=True, writeable=True)
 */
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_7 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_8 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 371; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_9 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":393
 * 
 *     @classmethod
 *     def from_host(cls, context, host, copy=True, readable=True, writeable=True):             # <<<<<<<<<<<<<<
 *         '''
 *         DeviceMemoryView.from_host(context, host, copy=True, readable=True, writeable=True)
 */
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_11 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_12 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_13 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":392
 *         return MemoryViewMap(queue, self, blocking_map, flags)
 * 
 *     @classmethod             # <<<<<<<<<<<<<<
 *     def from_host(cls, context, host, copy=True, readable=True, writeable=True):
 *         '''
 */
  __pyx_t_2 = __Pyx_GetName((PyObject *)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView, __pyx_n_s__from_host); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_Method_ClassMethod(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 392; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView->tp_dict, __pyx_n_s__from_host, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 393; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView);

  /* "opencl/cl_mem.pyx":670
 * 
 * 
 *     def read(self, queue, out, wait_on=(), blocking=False):             # <<<<<<<<<<<<<<
 *         '''
 *         buf.read(queue, out, wait_on=(), blocking=False)
 */
  __pyx_t_3 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_k_30 = __pyx_t_3;
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":678
 *         return queue.enqueue_read_buffer(self, out, self.offset_, self.nbytes, wait_on, blocking_read=blocking)
 * 
 *     def write(self, queue, buf, wait_on=(), blocking=False):             # <<<<<<<<<<<<<<
 *         '''
 *         view.write(queue, buf, wait_on=(), blocking=False)
 */
  __pyx_t_3 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_k_31 = __pyx_t_3;
  __Pyx_GIVEREF(__pyx_t_3);
  __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":690
 * 
 *     @classmethod
 *     def _view_as_this(cls, obj):             # <<<<<<<<<<<<<<
 *         '''
 *         view DeviceMemoryView obj as this class.
 */
  __pyx_t_3 = __Pyx_GetName((PyObject *)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView, __pyx_n_s___view_as_this); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_Method_ClassMethod(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 689; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView->tp_dict, __pyx_n_s___view_as_this, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_DeviceMemoryView);

  /* "opencl/cl_mem.pyx":725
 *         return CyView_CreateSubclass(cls, buffer_id, buffer, obj.ctype, 1)
 * 
 * def is_string(obj):             # <<<<<<<<<<<<<<
 * 
 *     if sys.version_info.major < 3:
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6opencl_6cl_mem_1is_string, NULL, __pyx_n_s_73); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__is_string, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 725; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":733
 *         return isinstance(obj, (str,))
 * 
 * def empty(context, shape, ctype='B'):             # <<<<<<<<<<<<<<
 *     '''
 *     empty(context, shape, ctype='B') -> view
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6opencl_6cl_mem_2empty, NULL, __pyx_n_s_73); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__empty, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":793
 *     '''
 *     '''
 *     CHANNEL_ORDERS = {             # <<<<<<<<<<<<<<
 *         CL_R : 'CL_R',
 *         CL_Rx : 'CL_Rx',
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));

  /* "opencl/cl_mem.pyx":794
 *     '''
 *     CHANNEL_ORDERS = {
 *         CL_R : 'CL_R',             # <<<<<<<<<<<<<<
 *         CL_Rx : 'CL_Rx',
 *         CL_A : 'CL_A',
 */
  __pyx_t_3 = PyInt_FromLong(CL_R); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_R)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":795
 *     CHANNEL_ORDERS = {
 *         CL_R : 'CL_R',
 *         CL_Rx : 'CL_Rx',             # <<<<<<<<<<<<<<
 *         CL_A : 'CL_A',
 *         CL_INTENSITY : 'CL_INTENSITY',
 */
  __pyx_t_3 = PyInt_FromLong(CL_Rx); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_Rx)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":796
 *         CL_R : 'CL_R',
 *         CL_Rx : 'CL_Rx',
 *         CL_A : 'CL_A',             # <<<<<<<<<<<<<<
 *         CL_INTENSITY : 'CL_INTENSITY',
 *         CL_LUMINANCE : 'CL_LUMINANCE',
 */
  __pyx_t_3 = PyInt_FromLong(CL_A); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 796; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_A)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":797
 *         CL_Rx : 'CL_Rx',
 *         CL_A : 'CL_A',
 *         CL_INTENSITY : 'CL_INTENSITY',             # <<<<<<<<<<<<<<
 *         CL_LUMINANCE : 'CL_LUMINANCE',
 *         CL_RG : 'CL_RG',
 */
  __pyx_t_3 = PyInt_FromLong(CL_INTENSITY); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_INTENSITY)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":798
 *         CL_A : 'CL_A',
 *         CL_INTENSITY : 'CL_INTENSITY',
 *         CL_LUMINANCE : 'CL_LUMINANCE',             # <<<<<<<<<<<<<<
 *         CL_RG : 'CL_RG',
 *         CL_RGx : 'CL_RGx',
 */
  __pyx_t_3 = PyInt_FromLong(CL_LUMINANCE); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_LUMINANCE)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":799
 *         CL_INTENSITY : 'CL_INTENSITY',
 *         CL_LUMINANCE : 'CL_LUMINANCE',
 *         CL_RG : 'CL_RG',             # <<<<<<<<<<<<<<
 *         CL_RGx : 'CL_RGx',
 *         CL_RA : 'CL_RA',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RG); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_RG)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":800
 *         CL_LUMINANCE : 'CL_LUMINANCE',
 *         CL_RG : 'CL_RG',
 *         CL_RGx : 'CL_RGx',             # <<<<<<<<<<<<<<
 *         CL_RA : 'CL_RA',
 *         CL_RGB : 'CL_RGB',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RGx); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 800; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_RGx)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":801
 *         CL_RG : 'CL_RG',
 *         CL_RGx : 'CL_RGx',
 *         CL_RA : 'CL_RA',             # <<<<<<<<<<<<<<
 *         CL_RGB : 'CL_RGB',
 *         CL_RGBx : 'CL_RGBx',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RA); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 801; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_RA)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":802
 *         CL_RGx : 'CL_RGx',
 *         CL_RA : 'CL_RA',
 *         CL_RGB : 'CL_RGB',             # <<<<<<<<<<<<<<
 *         CL_RGBx : 'CL_RGBx',
 *         CL_RGBA : 'CL_RGBA',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RGB); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 802; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_RGB)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":803
 *         CL_RA : 'CL_RA',
 *         CL_RGB : 'CL_RGB',
 *         CL_RGBx : 'CL_RGBx',             # <<<<<<<<<<<<<<
 *         CL_RGBA : 'CL_RGBA',
 *         CL_ARGB : 'CL_ARGB',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RGBx); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 803; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_RGBx)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":804
 *         CL_RGB : 'CL_RGB',
 *         CL_RGBx : 'CL_RGBx',
 *         CL_RGBA : 'CL_RGBA',             # <<<<<<<<<<<<<<
 *         CL_ARGB : 'CL_ARGB',
 *         CL_BGRA : 'CL_BGRA',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RGBA); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 804; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_RGBA)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":805
 *         CL_RGBx : 'CL_RGBx',
 *         CL_RGBA : 'CL_RGBA',
 *         CL_ARGB : 'CL_ARGB',             # <<<<<<<<<<<<<<
 *         CL_BGRA : 'CL_BGRA',
 *         }
 */
  __pyx_t_3 = PyInt_FromLong(CL_ARGB); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 805; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_ARGB)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":806
 *         CL_RGBA : 'CL_RGBA',
 *         CL_ARGB : 'CL_ARGB',
 *         CL_BGRA : 'CL_BGRA',             # <<<<<<<<<<<<<<
 *         }
 * 
 */
  __pyx_t_3 = PyInt_FromLong(CL_BGRA); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 806; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_BGRA)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat->tp_dict, __pyx_n_s__CHANNEL_ORDERS, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 793; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_ImageFormat);

  /* "opencl/cl_mem.pyx":809
 *         }
 * 
 *     CHANNEL_DTYPES = {             # <<<<<<<<<<<<<<
 *         CL_SNORM_INT8 : 'CL_SNORM_INT8',
 *         CL_SNORM_INT16 : 'CL_SNORM_INT16',
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));

  /* "opencl/cl_mem.pyx":810
 * 
 *     CHANNEL_DTYPES = {
 *         CL_SNORM_INT8 : 'CL_SNORM_INT8',             # <<<<<<<<<<<<<<
 *         CL_SNORM_INT16 : 'CL_SNORM_INT16',
 *         CL_UNORM_INT8 : 'CL_UNORM_INT8',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SNORM_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 810; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_SNORM_INT8)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":811
 *     CHANNEL_DTYPES = {
 *         CL_SNORM_INT8 : 'CL_SNORM_INT8',
 *         CL_SNORM_INT16 : 'CL_SNORM_INT16',             # <<<<<<<<<<<<<<
 *         CL_UNORM_INT8 : 'CL_UNORM_INT8',
 *         CL_UNORM_INT16 : 'CL_UNORM_INT16',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SNORM_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 811; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_SNORM_INT16)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":812
 *         CL_SNORM_INT8 : 'CL_SNORM_INT8',
 *         CL_SNORM_INT16 : 'CL_SNORM_INT16',
 *         CL_UNORM_INT8 : 'CL_UNORM_INT8',             # <<<<<<<<<<<<<<
 *         CL_UNORM_INT16 : 'CL_UNORM_INT16',
 *         CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 812; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNORM_INT8)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":813
 *         CL_SNORM_INT16 : 'CL_SNORM_INT16',
 *         CL_UNORM_INT8 : 'CL_UNORM_INT8',
 *         CL_UNORM_INT16 : 'CL_UNORM_INT16',             # <<<<<<<<<<<<<<
 *         CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',
 *         CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 813; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNORM_INT16)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":814
 *         CL_UNORM_INT8 : 'CL_UNORM_INT8',
 *         CL_UNORM_INT16 : 'CL_UNORM_INT16',
 *         CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',             # <<<<<<<<<<<<<<
 *         CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',
 *         CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_SHORT_565); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 814; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNORM_SHORT_565)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":815
 *         CL_UNORM_INT16 : 'CL_UNORM_INT16',
 *         CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',
 *         CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',             # <<<<<<<<<<<<<<
 *         CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',
 *         CL_SIGNED_INT8 : 'CL_SIGNED_INT8',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_SHORT_555); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 815; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNORM_SHORT_555)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":816
 *         CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',
 *         CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',
 *         CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',             # <<<<<<<<<<<<<<
 *         CL_SIGNED_INT8 : 'CL_SIGNED_INT8',
 *         CL_SIGNED_INT16 : 'CL_SIGNED_INT16',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_INT_101010); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 816; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNORM_INT_101010)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":817
 *         CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',
 *         CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',
 *         CL_SIGNED_INT8 : 'CL_SIGNED_INT8',             # <<<<<<<<<<<<<<
 *         CL_SIGNED_INT16 : 'CL_SIGNED_INT16',
 *         CL_SIGNED_INT32 : 'CL_SIGNED_INT32',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SIGNED_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 817; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_SIGNED_INT8)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":818
 *         CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',
 *         CL_SIGNED_INT8 : 'CL_SIGNED_INT8',
 *         CL_SIGNED_INT16 : 'CL_SIGNED_INT16',             # <<<<<<<<<<<<<<
 *         CL_SIGNED_INT32 : 'CL_SIGNED_INT32',
 *         CL_UNSIGNED_INT8 : 'CL_UNSIGNED_INT8',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SIGNED_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 818; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_SIGNED_INT16)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":819
 *         CL_SIGNED_INT8 : 'CL_SIGNED_INT8',
 *         CL_SIGNED_INT16 : 'CL_SIGNED_INT16',
 *         CL_SIGNED_INT32 : 'CL_SIGNED_INT32',             # <<<<<<<<<<<<<<
 *         CL_UNSIGNED_INT8 : 'CL_UNSIGNED_INT8',
 *         CL_UNSIGNED_INT16 : 'CL_UNSIGNED_INT16',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SIGNED_INT32); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 819; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_SIGNED_INT32)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":820
 *         CL_SIGNED_INT16 : 'CL_SIGNED_INT16',
 *         CL_SIGNED_INT32 : 'CL_SIGNED_INT32',
 *         CL_UNSIGNED_INT8 : 'CL_UNSIGNED_INT8',             # <<<<<<<<<<<<<<
 *         CL_UNSIGNED_INT16 : 'CL_UNSIGNED_INT16',
 *         CL_UNSIGNED_INT32 : 'CL_UNSIGNED_INT32',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNSIGNED_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNSIGNED_INT8)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":821
 *         CL_SIGNED_INT32 : 'CL_SIGNED_INT32',
 *         CL_UNSIGNED_INT8 : 'CL_UNSIGNED_INT8',
 *         CL_UNSIGNED_INT16 : 'CL_UNSIGNED_INT16',             # <<<<<<<<<<<<<<
 *         CL_UNSIGNED_INT32 : 'CL_UNSIGNED_INT32',
 *         CL_HALF_FLOAT : 'CL_HALF_FLOAT',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNSIGNED_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 821; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNSIGNED_INT16)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":822
 *         CL_UNSIGNED_INT8 : 'CL_UNSIGNED_INT8',
 *         CL_UNSIGNED_INT16 : 'CL_UNSIGNED_INT16',
 *         CL_UNSIGNED_INT32 : 'CL_UNSIGNED_INT32',             # <<<<<<<<<<<<<<
 *         CL_HALF_FLOAT : 'CL_HALF_FLOAT',
 *         CL_FLOAT : 'CL_FLOAT',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNSIGNED_INT32); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 822; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_UNSIGNED_INT32)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":823
 *         CL_UNSIGNED_INT16 : 'CL_UNSIGNED_INT16',
 *         CL_UNSIGNED_INT32 : 'CL_UNSIGNED_INT32',
 *         CL_HALF_FLOAT : 'CL_HALF_FLOAT',             # <<<<<<<<<<<<<<
 *         CL_FLOAT : 'CL_FLOAT',
 *                       }
 */
  __pyx_t_3 = PyInt_FromLong(CL_HALF_FLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 823; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_HALF_FLOAT)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":824
 *         CL_UNSIGNED_INT32 : 'CL_UNSIGNED_INT32',
 *         CL_HALF_FLOAT : 'CL_HALF_FLOAT',
 *         CL_FLOAT : 'CL_FLOAT',             # <<<<<<<<<<<<<<
 *                       }
 * 
 */
  __pyx_t_3 = PyInt_FromLong(CL_FLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 824; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__CL_FLOAT)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat->tp_dict, __pyx_n_s__CHANNEL_DTYPES, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 809; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_ImageFormat);

  /* "opencl/cl_mem.pyx":827
 *                       }
 * 
 *     _CHANNEL_CTYPE_MAP = {             # <<<<<<<<<<<<<<
 *         CL_SNORM_INT8 : 'b',
 *         CL_SNORM_INT16 : 'h',
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));

  /* "opencl/cl_mem.pyx":828
 * 
 *     _CHANNEL_CTYPE_MAP = {
 *         CL_SNORM_INT8 : 'b',             # <<<<<<<<<<<<<<
 *         CL_SNORM_INT16 : 'h',
 *         CL_UNORM_INT8 : 'B',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SNORM_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__b)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":829
 *     _CHANNEL_CTYPE_MAP = {
 *         CL_SNORM_INT8 : 'b',
 *         CL_SNORM_INT16 : 'h',             # <<<<<<<<<<<<<<
 *         CL_UNORM_INT8 : 'B',
 *         CL_UNORM_INT16 : 'H',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SNORM_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__h)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":830
 *         CL_SNORM_INT8 : 'b',
 *         CL_SNORM_INT16 : 'h',
 *         CL_UNORM_INT8 : 'B',             # <<<<<<<<<<<<<<
 *         CL_UNORM_INT16 : 'H',
 * #        CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 830; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__B)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":831
 *         CL_SNORM_INT16 : 'h',
 *         CL_UNORM_INT8 : 'B',
 *         CL_UNORM_INT16 : 'H',             # <<<<<<<<<<<<<<
 * #        CL_UNORM_SHORT_565 : 'CL_UNORM_SHORT_565',
 * #        CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNORM_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__H)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":835
 * #        CL_UNORM_SHORT_555 : 'CL_UNORM_SHORT_555',
 * #        CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',
 *         CL_SIGNED_INT8 : 'b',             # <<<<<<<<<<<<<<
 *         CL_SIGNED_INT16 : 'h',
 *         CL_SIGNED_INT32 : 'l',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SIGNED_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__b)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":836
 * #        CL_UNORM_INT_101010 : 'CL_UNORM_INT_101010',
 *         CL_SIGNED_INT8 : 'b',
 *         CL_SIGNED_INT16 : 'h',             # <<<<<<<<<<<<<<
 *         CL_SIGNED_INT32 : 'l',
 *         CL_UNSIGNED_INT8 : 'B',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SIGNED_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 836; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__h)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":837
 *         CL_SIGNED_INT8 : 'b',
 *         CL_SIGNED_INT16 : 'h',
 *         CL_SIGNED_INT32 : 'l',             # <<<<<<<<<<<<<<
 *         CL_UNSIGNED_INT8 : 'B',
 *         CL_UNSIGNED_INT16 : 'H',
 */
  __pyx_t_3 = PyInt_FromLong(CL_SIGNED_INT32); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 837; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__l)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":838
 *         CL_SIGNED_INT16 : 'h',
 *         CL_SIGNED_INT32 : 'l',
 *         CL_UNSIGNED_INT8 : 'B',             # <<<<<<<<<<<<<<
 *         CL_UNSIGNED_INT16 : 'H',
 *         CL_UNSIGNED_INT32 : 'L',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNSIGNED_INT8); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__B)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":839
 *         CL_SIGNED_INT32 : 'l',
 *         CL_UNSIGNED_INT8 : 'B',
 *         CL_UNSIGNED_INT16 : 'H',             # <<<<<<<<<<<<<<
 *         CL_UNSIGNED_INT32 : 'L',
 * #        CL_HALF_FLOAT : 'CL_HALF_FLOAT',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNSIGNED_INT16); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__H)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":840
 *         CL_UNSIGNED_INT8 : 'B',
 *         CL_UNSIGNED_INT16 : 'H',
 *         CL_UNSIGNED_INT32 : 'L',             # <<<<<<<<<<<<<<
 * #        CL_HALF_FLOAT : 'CL_HALF_FLOAT',
 *         CL_FLOAT : 'f',
 */
  __pyx_t_3 = PyInt_FromLong(CL_UNSIGNED_INT32); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__L)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":842
 *         CL_UNSIGNED_INT32 : 'L',
 * #        CL_HALF_FLOAT : 'CL_HALF_FLOAT',
 *         CL_FLOAT : 'f',             # <<<<<<<<<<<<<<
 * 
 *                                 }
 */
  __pyx_t_3 = PyInt_FromLong(CL_FLOAT); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 842; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_n_s__f)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat->tp_dict, __pyx_n_s___CHANNEL_CTYPE_MAP, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_ImageFormat);

  /* "opencl/cl_mem.pyx":846
 *                                 }
 * 
 *     _CHANNEL_ORDER_CTYPE_MAP = {             # <<<<<<<<<<<<<<
 *         CL_R : 'T{%(dtype)s:r:}',
 *         #CL_Rx : 'CL_Rx',
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));

  /* "opencl/cl_mem.pyx":847
 * 
 *     _CHANNEL_ORDER_CTYPE_MAP = {
 *         CL_R : 'T{%(dtype)s:r:}',             # <<<<<<<<<<<<<<
 *         #CL_Rx : 'CL_Rx',
 *         #CL_A : 'CL_A',
 */
  __pyx_t_3 = PyInt_FromLong(CL_R); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 847; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_kp_s_74)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":850
 *         #CL_Rx : 'CL_Rx',
 *         #CL_A : 'CL_A',
 *         CL_INTENSITY : 'T{%(dtype)s:i:}',             # <<<<<<<<<<<<<<
 * #        CL_LUMINANCE : 'CL_LUMINANCE',
 * #        CL_RG : 'CL_RG',
 */
  __pyx_t_3 = PyInt_FromLong(CL_INTENSITY); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 850; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_kp_s_75)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":855
 * #        CL_RGx : 'CL_RGx',
 * #        CL_RA : 'CL_RA',
 *         CL_RGB : 'T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}',             # <<<<<<<<<<<<<<
 * #        CL_RGBx : 'CL_RGBx',
 *         CL_RGBA : 'T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:%(dtype)s:a:}',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RGB); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 855; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_kp_s_76)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":857
 *         CL_RGB : 'T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}',
 * #        CL_RGBx : 'CL_RGBx',
 *         CL_RGBA : 'T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:%(dtype)s:a:}',             # <<<<<<<<<<<<<<
 *         CL_ARGB : 'T{%(dtype)s:a:%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}',
 *         CL_BGRA : 'T{%(dtype)s:b:%(dtype)s:g:%(dtype)s:r:%(dtype)s:a:}',
 */
  __pyx_t_3 = PyInt_FromLong(CL_RGBA); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_kp_s_77)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":858
 * #        CL_RGBx : 'CL_RGBx',
 *         CL_RGBA : 'T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:%(dtype)s:a:}',
 *         CL_ARGB : 'T{%(dtype)s:a:%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}',             # <<<<<<<<<<<<<<
 *         CL_BGRA : 'T{%(dtype)s:b:%(dtype)s:g:%(dtype)s:r:%(dtype)s:a:}',
 *         }
 */
  __pyx_t_3 = PyInt_FromLong(CL_ARGB); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 858; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_kp_s_78)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "opencl/cl_mem.pyx":859
 *         CL_RGBA : 'T{%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:%(dtype)s:a:}',
 *         CL_ARGB : 'T{%(dtype)s:a:%(dtype)s:r:%(dtype)s:g:%(dtype)s:b:}',
 *         CL_BGRA : 'T{%(dtype)s:b:%(dtype)s:g:%(dtype)s:r:%(dtype)s:a:}',             # <<<<<<<<<<<<<<
 *         }
 * 
 */
  __pyx_t_3 = PyInt_FromLong(CL_BGRA); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  if (PyDict_SetItem(__pyx_t_2, __pyx_t_3, ((PyObject *)__pyx_kp_s_79)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat->tp_dict, __pyx_n_s_40, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 846; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_ImageFormat);

  /* "opencl/cl_mem.pyx":865
 * 
 *     @classmethod
 *     def supported_formats(cls, context, readable=True, wirteable=True):             # <<<<<<<<<<<<<<
 * 
 *         if not CyContext_Check(context):
 */
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_35 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_36 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":864
 *     cdef cl_image_format cl_format
 * 
 *     @classmethod             # <<<<<<<<<<<<<<
 *     def supported_formats(cls, context, readable=True, wirteable=True):
 * 
 */
  __pyx_t_2 = __Pyx_GetName((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat, __pyx_n_s__supported_formats); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_Method_ClassMethod(__pyx_t_2); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 864; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat->tp_dict, __pyx_n_s__supported_formats, __pyx_t_3) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 865; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_ImageFormat);

  /* "opencl/cl_mem.pyx":915
 * 
 *     @classmethod
 *     def from_ctype(cls, format):             # <<<<<<<<<<<<<<
 * 
 *         cdef ImageFormat fmt
 */
  __pyx_t_3 = __Pyx_GetName((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat, __pyx_n_s__from_ctype); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_2 = __Pyx_Method_ClassMethod(__pyx_t_3); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 914; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem((PyObject *)__pyx_ptype_6opencl_6cl_mem_ImageFormat->tp_dict, __pyx_n_s__from_ctype, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 915; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  PyType_Modified(__pyx_ptype_6opencl_6cl_mem_ImageFormat);

  /* "opencl/cl_mem.pyx":1049
 *             return tuple(strides)
 * 
 *     def map(self, queue, blocking=True, readonly=False):             # <<<<<<<<<<<<<<
 * 
 *         from opencl.queue import ImageMap
 */
  __pyx_t_2 = __Pyx_PyBool_FromLong(1); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_43 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyBool_FromLong(0); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1049; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_k_44 = __pyx_t_2;
  __Pyx_GIVEREF(__pyx_t_2);
  __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":1063
 * 
 * 
 * def broadcast(DeviceMemoryView view, shape):             # <<<<<<<<<<<<<<
 *     if not isinstance(view, DeviceMemoryView):
 *         raise TypeError("argument 'view' must be a valid opencl.DeviceMemoryView object")
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6opencl_6cl_mem_3broadcast, NULL, __pyx_n_s_73); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__broadcast, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":1110
 *     return CyView_Create(memobj, result_buffer, view.ctype, 1)
 * 
 * def empty_image(context, shape, image_format):             # <<<<<<<<<<<<<<
 *     '''
 *     Create an image object.
 */
  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_6opencl_6cl_mem_4empty_image, NULL, __pyx_n_s_73); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(__pyx_t_2);
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s__empty_image, __pyx_t_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "opencl/cl_mem.pyx":1
 * import weakref             # <<<<<<<<<<<<<<
 * import struct
 * import ctypes
 */
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_GOTREF(((PyObject *)__pyx_t_2));
  if (PyObject_SetAttr(__pyx_m, __pyx_n_s____test__, ((PyObject *)__pyx_t_2)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __Pyx_DECREF(((PyObject *)__pyx_t_2)); __pyx_t_2 = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  if (__pyx_m) {
    __Pyx_AddTraceback("init opencl.cl_mem", __pyx_clineno, __pyx_lineno, __pyx_filename);
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init opencl.cl_mem");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* Runtime support code */

#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif /* CYTHON_REFNANNY */

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result) {
        if (dict != __pyx_b) {
            PyErr_Clear();
            result = PyObject_GetAttr(__pyx_b, name);
        }
        if (!result) {
            PyErr_SetObject(PyExc_NameError, name);
        }
    }
    return result;
}

static PyObject* __Pyx_PyEval_CallObjectWithKeywords(PyObject *callable, PyObject *args, PyObject *kwargs) {
    PyObject* result;
    if (likely(PyDict_Check(kwargs))) {
        return PyEval_CallObjectWithKeywords(callable, args, kwargs);
    } else {
        PyObject* real_dict;
        real_dict = PyObject_CallFunctionObjArgs((PyObject*)&PyDict_Type, kwargs, NULL);
        if (unlikely(!real_dict))
            return NULL;
        result = PyEval_CallObjectWithKeywords(callable, args, real_dict);
        Py_DECREF(real_dict);
        return result; /* may be NULL */
    }
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *more_or_less;

    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    PyErr_Format(PyExc_TypeError,
                 "%s() takes %s %"PY_FORMAT_SIZE_T"d positional argument%s (%"PY_FORMAT_SIZE_T"d given)",
                 func_name, more_or_less, num_expected,
                 (num_expected == 1) ? "" : "s", num_found);
}

static CYTHON_INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #else
        if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key)))
        #endif
            goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    return 0;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AS_STRING(kw_name));
        #endif
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;

    while (PyDict_Next(kwds, &pos, &key, &value)) {
        name = first_kw_arg;
        while (*name && (**name != key)) name++;
        if (*name) {
            values[name-argnames] = value;
        } else {
            #if PY_MAJOR_VERSION < 3
            if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key))) {
            #else
            if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key))) {
            #endif
                goto invalid_keyword_type;
            } else {
                for (name = first_kw_arg; *name; name++) {
                    #if PY_MAJOR_VERSION >= 3
                    if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                        PyUnicode_Compare(**name, key) == 0) break;
                    #else
                    if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                        _PyString_Eq(**name, key)) break;
                    #endif
                }
                if (*name) {
                    values[name-argnames] = value;
                } else {
                    /* unexpected keyword found */
                    for (name=argnames; name != first_kw_arg; name++) {
                        if (**name == key) goto arg_passed_twice;
                        #if PY_MAJOR_VERSION >= 3
                        if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                            PyUnicode_Compare(**name, key) == 0) goto arg_passed_twice;
                        #else
                        if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                            _PyString_Eq(**name, key)) goto arg_passed_twice;
                        #endif
                    }
                    if (kwds2) {
                        if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
                    } else {
                        goto invalid_keyword;
                    }
                }
            }
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, **name);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static CYTHON_INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();

    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}

static CYTHON_INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;

    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
}


#if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    /* cause is unused */
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    #if PY_VERSION_HEX < 0x02050000
    if (!PyClass_Check(type))
    #else
    if (!PyType_Check(type))
    #endif
    {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                type = 0;
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) Py_TYPE(type);
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }

    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

#else /* Python 3+ */

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;

    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (!PyExceptionClass_Check(type)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }

    if (cause) {
        PyObject *fixed_cause;
        if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        }
        else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        }
        else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        if (!value) {
            value = PyObject_CallObject(type, NULL);
        }
        PyException_SetCause(value, fixed_cause);
    }

    PyErr_SetObject(type, value);

    if (tb) {
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
    }

bad:
    return;
}
#endif


static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %"PY_FORMAT_SIZE_T"d value%s to unpack",
                 index, (index == 1) ? "" : "s");
}

static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %"PY_FORMAT_SIZE_T"d)", expected);
}

static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else if (PyErr_Occurred()) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
}

static CYTHON_INLINE void __Pyx_RaiseUnboundLocalError(const char *varname) {
    PyErr_Format(PyExc_UnboundLocalError, "local variable '%s' referenced before assignment", varname);
}


static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
    PyErr_Format(PyExc_NameError, "free variable '%s' referenced before assignment in enclosing scope", varname);
}

static double __Pyx__PyObject_AsDouble(PyObject* obj) {
    PyObject* float_value;
    if (Py_TYPE(obj)->tp_as_number && Py_TYPE(obj)->tp_as_number->nb_float) {
        return PyFloat_AsDouble(obj);
    } else if (PyUnicode_CheckExact(obj) || PyBytes_CheckExact(obj)) {
#if PY_MAJOR_VERSION >= 3
        float_value = PyFloat_FromString(obj);
#else
        float_value = PyFloat_FromString(obj, 0);
#endif
    } else {
        PyObject* args = PyTuple_New(1);
        if (unlikely(!args)) goto bad;
        PyTuple_SET_ITEM(args, 0, obj);
        float_value = PyObject_Call((PyObject*)&PyFloat_Type, args, 0);
        PyTuple_SET_ITEM(args, 0, 0);
        Py_DECREF(args);
    }
    if (likely(float_value)) {
        double value = PyFloat_AS_DOUBLE(float_value);
        Py_DECREF(float_value);
        return value;
    }
bad:
    return (double)-1;
}

static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (unlikely(!type)) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(PyObject_TypeCheck(obj, type)))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                 Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact)
{
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (none_allowed && obj == Py_None) return 1;
    else if (exact) {
        if (Py_TYPE(obj) == type) return 1;
    }
    else {
        if (PyObject_TypeCheck(obj, type)) return 1;
    }
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, Py_TYPE(obj)->tp_name);
    return 0;
}

static CYTHON_INLINE void __Pyx_RaiseNoneIndexingError(void) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is unsubscriptable");
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, long level) {
    PyObject *py_import = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    py_import = __Pyx_GetAttrString(__pyx_b, "__import__");
    if (!py_import)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    #if PY_VERSION_HEX >= 0x02050000
    {
        PyObject *py_level = PyInt_FromLong(level);
        if (!py_level)
            goto bad;
        module = PyObject_CallFunctionObjArgs(py_import,
            name, global_dict, empty_dict, list, py_level, NULL);
        Py_DECREF(py_level);
    }
    #else
    if (level>0) {
        PyErr_SetString(PyExc_RuntimeError, "Relative import is not supported for Python <=2.4.");
        goto bad;
    }
    module = PyObject_CallFunctionObjArgs(py_import,
        name, global_dict, empty_dict, list, NULL);
    #endif
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(py_import);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject* __Pyx_Method_ClassMethod(PyObject *method) {
    /* It appears that PyMethodDescr_Type is not anywhere exposed in the Python/C API */
    static PyTypeObject *methoddescr_type = NULL;
    if (methoddescr_type == NULL) {
       PyObject *meth = __Pyx_GetAttrString((PyObject*)&PyList_Type, "append");
       if (!meth) return NULL;
       methoddescr_type = Py_TYPE(meth);
       Py_DECREF(meth);
    }
    if (PyObject_TypeCheck(method, methoddescr_type)) { /* cdef classes */
        PyMethodDescrObject *descr = (PyMethodDescrObject *)method;
        #if PY_VERSION_HEX < 0x03020000
        PyTypeObject *d_type = descr->d_type;
        #else
        PyTypeObject *d_type = descr->d_common.d_type;
        #endif
        return PyDescr_NewClassMethod(d_type, descr->d_method);
    }
    else if (PyMethod_Check(method)) { /* python classes */
        return PyClassMethod_New(PyMethod_GET_FUNCTION(method));
    }
    else if (PyCFunction_Check(method)) {
        return PyClassMethod_New(method);
    }
#ifdef __pyx_binding_PyCFunctionType_USED
    else if (PyObject_TypeCheck(method, __pyx_binding_PyCFunctionType)) { /* binded CFunction */
        return PyClassMethod_New(method);
    }
#endif
    PyErr_Format(PyExc_TypeError,
                 "Class-level classmethod() can only be called on "
                 "a method_descriptor or instance method.");
    return NULL;
}

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_int32_t(int32_t val) {
    const int32_t neg_one = (int32_t)-1, const_zero = (int32_t)0;
    const int is_unsigned = const_zero < neg_one;
    if ((sizeof(int32_t) == sizeof(char))  ||
        (sizeof(int32_t) == sizeof(short))) {
        return PyInt_FromLong((long)val);
    } else if ((sizeof(int32_t) == sizeof(int)) ||
               (sizeof(int32_t) == sizeof(long))) {
        if (is_unsigned)
            return PyLong_FromUnsignedLong((unsigned long)val);
        else
            return PyInt_FromLong((long)val);
    } else if (sizeof(int32_t) == sizeof(PY_LONG_LONG)) {
        if (is_unsigned)
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG)val);
        else
            return PyLong_FromLongLong((PY_LONG_LONG)val);
    } else {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        return _PyLong_FromByteArray(bytes, sizeof(int32_t),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_uint32_t(uint32_t val) {
    const uint32_t neg_one = (uint32_t)-1, const_zero = (uint32_t)0;
    const int is_unsigned = const_zero < neg_one;
    if ((sizeof(uint32_t) == sizeof(char))  ||
        (sizeof(uint32_t) == sizeof(short))) {
        return PyInt_FromLong((long)val);
    } else if ((sizeof(uint32_t) == sizeof(int)) ||
               (sizeof(uint32_t) == sizeof(long))) {
        if (is_unsigned)
            return PyLong_FromUnsignedLong((unsigned long)val);
        else
            return PyInt_FromLong((long)val);
    } else if (sizeof(uint32_t) == sizeof(PY_LONG_LONG)) {
        if (is_unsigned)
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG)val);
        else
            return PyLong_FromLongLong((PY_LONG_LONG)val);
    } else {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        return _PyLong_FromByteArray(bytes, sizeof(uint32_t),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE PyObject *__Pyx_PyInt_to_py_uint64_t(uint64_t val) {
    const uint64_t neg_one = (uint64_t)-1, const_zero = (uint64_t)0;
    const int is_unsigned = const_zero < neg_one;
    if ((sizeof(uint64_t) == sizeof(char))  ||
        (sizeof(uint64_t) == sizeof(short))) {
        return PyInt_FromLong((long)val);
    } else if ((sizeof(uint64_t) == sizeof(int)) ||
               (sizeof(uint64_t) == sizeof(long))) {
        if (is_unsigned)
            return PyLong_FromUnsignedLong((unsigned long)val);
        else
            return PyInt_FromLong((long)val);
    } else if (sizeof(uint64_t) == sizeof(PY_LONG_LONG)) {
        if (is_unsigned)
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG)val);
        else
            return PyLong_FromLongLong((PY_LONG_LONG)val);
    } else {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&val;
        return _PyLong_FromByteArray(bytes, sizeof(uint64_t),
                                     little, !is_unsigned);
    }
}

static CYTHON_INLINE uint32_t __Pyx_PyInt_from_py_uint32_t(PyObject* x) {
    const uint32_t neg_one = (uint32_t)-1, const_zero = (uint32_t)0;
    const int is_unsigned = const_zero < neg_one;
    if (sizeof(uint32_t) == sizeof(char)) {
        if (is_unsigned)
            return (uint32_t)__Pyx_PyInt_AsUnsignedChar(x);
        else
            return (uint32_t)__Pyx_PyInt_AsSignedChar(x);
    } else if (sizeof(uint32_t) == sizeof(short)) {
        if (is_unsigned)
            return (uint32_t)__Pyx_PyInt_AsUnsignedShort(x);
        else
            return (uint32_t)__Pyx_PyInt_AsSignedShort(x);
    } else if (sizeof(uint32_t) == sizeof(int)) {
        if (is_unsigned)
            return (uint32_t)__Pyx_PyInt_AsUnsignedInt(x);
        else
            return (uint32_t)__Pyx_PyInt_AsSignedInt(x);
    } else if (sizeof(uint32_t) == sizeof(long)) {
        if (is_unsigned)
            return (uint32_t)__Pyx_PyInt_AsUnsignedLong(x);
        else
            return (uint32_t)__Pyx_PyInt_AsSignedLong(x);
    } else if (sizeof(uint32_t) == sizeof(PY_LONG_LONG)) {
        if (is_unsigned)
            return (uint32_t)__Pyx_PyInt_AsUnsignedLongLong(x);
        else
            return (uint32_t)__Pyx_PyInt_AsSignedLongLong(x);
    }  else {
        uint32_t val;
        PyObject *v = __Pyx_PyNumber_Int(x);
        #if PY_VERSION_HEX < 0x03000000
        if (likely(v) && !PyLong_Check(v)) {
            PyObject *tmp = v;
            v = PyNumber_Long(tmp);
            Py_DECREF(tmp);
        }
        #endif
        if (likely(v)) {
            int one = 1; int is_little = (int)*(unsigned char *)&one;
            unsigned char *bytes = (unsigned char *)&val;
            int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                          bytes, sizeof(val),
                                          is_little, !is_unsigned);
            Py_DECREF(v);
            if (likely(!ret))
                return val;
        }
        return (uint32_t)-1;
    }
}

static CYTHON_INLINE unsigned char __Pyx_PyInt_AsUnsignedChar(PyObject* x) {
    const unsigned char neg_one = (unsigned char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned char" :
                    "value too large to convert to unsigned char");
            }
            return (unsigned char)-1;
        }
        return (unsigned char)val;
    }
    return (unsigned char)__Pyx_PyInt_AsUnsignedLong(x);
}

static CYTHON_INLINE unsigned short __Pyx_PyInt_AsUnsignedShort(PyObject* x) {
    const unsigned short neg_one = (unsigned short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned short" :
                    "value too large to convert to unsigned short");
            }
            return (unsigned short)-1;
        }
        return (unsigned short)val;
    }
    return (unsigned short)__Pyx_PyInt_AsUnsignedLong(x);
}

static CYTHON_INLINE unsigned int __Pyx_PyInt_AsUnsignedInt(PyObject* x) {
    const unsigned int neg_one = (unsigned int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(unsigned int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(unsigned int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to unsigned int" :
                    "value too large to convert to unsigned int");
            }
            return (unsigned int)-1;
        }
        return (unsigned int)val;
    }
    return (unsigned int)__Pyx_PyInt_AsUnsignedLong(x);
}

static CYTHON_INLINE char __Pyx_PyInt_AsChar(PyObject* x) {
    const char neg_one = (char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to char" :
                    "value too large to convert to char");
            }
            return (char)-1;
        }
        return (char)val;
    }
    return (char)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE short __Pyx_PyInt_AsShort(PyObject* x) {
    const short neg_one = (short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to short" :
                    "value too large to convert to short");
            }
            return (short)-1;
        }
        return (short)val;
    }
    return (short)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE int __Pyx_PyInt_AsInt(PyObject* x) {
    const int neg_one = (int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to int" :
                    "value too large to convert to int");
            }
            return (int)-1;
        }
        return (int)val;
    }
    return (int)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE signed char __Pyx_PyInt_AsSignedChar(PyObject* x) {
    const signed char neg_one = (signed char)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed char) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed char)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed char" :
                    "value too large to convert to signed char");
            }
            return (signed char)-1;
        }
        return (signed char)val;
    }
    return (signed char)__Pyx_PyInt_AsSignedLong(x);
}

static CYTHON_INLINE signed short __Pyx_PyInt_AsSignedShort(PyObject* x) {
    const signed short neg_one = (signed short)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed short) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed short)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed short" :
                    "value too large to convert to signed short");
            }
            return (signed short)-1;
        }
        return (signed short)val;
    }
    return (signed short)__Pyx_PyInt_AsSignedLong(x);
}

static CYTHON_INLINE signed int __Pyx_PyInt_AsSignedInt(PyObject* x) {
    const signed int neg_one = (signed int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(signed int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(signed int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to signed int" :
                    "value too large to convert to signed int");
            }
            return (signed int)-1;
        }
        return (signed int)val;
    }
    return (signed int)__Pyx_PyInt_AsSignedLong(x);
}

static CYTHON_INLINE int __Pyx_PyInt_AsLongDouble(PyObject* x) {
    const int neg_one = (int)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
    if (sizeof(int) < sizeof(long)) {
        long val = __Pyx_PyInt_AsLong(x);
        if (unlikely(val != (long)(int)val)) {
            if (!unlikely(val == -1 && PyErr_Occurred())) {
                PyErr_SetString(PyExc_OverflowError,
                    (is_unsigned && unlikely(val < 0)) ?
                    "can't convert negative value to int" :
                    "value too large to convert to int");
            }
            return (int)-1;
        }
        return (int)val;
    }
    return (int)__Pyx_PyInt_AsLong(x);
}

static CYTHON_INLINE unsigned long __Pyx_PyInt_AsUnsignedLong(PyObject* x) {
    const unsigned long neg_one = (unsigned long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned long");
            return (unsigned long)-1;
        }
        return (unsigned long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned long");
                return (unsigned long)-1;
            }
            return (unsigned long)PyLong_AsUnsignedLong(x);
        } else {
            return (unsigned long)PyLong_AsLong(x);
        }
    } else {
        unsigned long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned long)-1;
        val = __Pyx_PyInt_AsUnsignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE unsigned PY_LONG_LONG __Pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
    const unsigned PY_LONG_LONG neg_one = (unsigned PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to unsigned PY_LONG_LONG");
            return (unsigned PY_LONG_LONG)-1;
        }
        return (unsigned PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to unsigned PY_LONG_LONG");
                return (unsigned PY_LONG_LONG)-1;
            }
            return (unsigned PY_LONG_LONG)PyLong_AsUnsignedLongLong(x);
        } else {
            return (unsigned PY_LONG_LONG)PyLong_AsLongLong(x);
        }
    } else {
        unsigned PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (unsigned PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE long __Pyx_PyInt_AsLong(PyObject* x) {
    const long neg_one = (long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to long");
            return (long)-1;
        }
        return (long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to long");
                return (long)-1;
            }
            return (long)PyLong_AsUnsignedLong(x);
        } else {
            return (long)PyLong_AsLong(x);
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (long)-1;
        val = __Pyx_PyInt_AsLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE PY_LONG_LONG __Pyx_PyInt_AsLongLong(PyObject* x) {
    const PY_LONG_LONG neg_one = (PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to PY_LONG_LONG");
            return (PY_LONG_LONG)-1;
        }
        return (PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to PY_LONG_LONG");
                return (PY_LONG_LONG)-1;
            }
            return (PY_LONG_LONG)PyLong_AsUnsignedLongLong(x);
        } else {
            return (PY_LONG_LONG)PyLong_AsLongLong(x);
        }
    } else {
        PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE signed long __Pyx_PyInt_AsSignedLong(PyObject* x) {
    const signed long neg_one = (signed long)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to signed long");
            return (signed long)-1;
        }
        return (signed long)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to signed long");
                return (signed long)-1;
            }
            return (signed long)PyLong_AsUnsignedLong(x);
        } else {
            return (signed long)PyLong_AsLong(x);
        }
    } else {
        signed long val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed long)-1;
        val = __Pyx_PyInt_AsSignedLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static CYTHON_INLINE signed PY_LONG_LONG __Pyx_PyInt_AsSignedLongLong(PyObject* x) {
    const signed PY_LONG_LONG neg_one = (signed PY_LONG_LONG)-1, const_zero = 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_VERSION_HEX < 0x03000000
    if (likely(PyInt_Check(x))) {
        long val = PyInt_AS_LONG(x);
        if (is_unsigned && unlikely(val < 0)) {
            PyErr_SetString(PyExc_OverflowError,
                            "can't convert negative value to signed PY_LONG_LONG");
            return (signed PY_LONG_LONG)-1;
        }
        return (signed PY_LONG_LONG)val;
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
            if (unlikely(Py_SIZE(x) < 0)) {
                PyErr_SetString(PyExc_OverflowError,
                                "can't convert negative value to signed PY_LONG_LONG");
                return (signed PY_LONG_LONG)-1;
            }
            return (signed PY_LONG_LONG)PyLong_AsUnsignedLongLong(x);
        } else {
            return (signed PY_LONG_LONG)PyLong_AsLongLong(x);
        }
    } else {
        signed PY_LONG_LONG val;
        PyObject *tmp = __Pyx_PyNumber_Int(x);
        if (!tmp) return (signed PY_LONG_LONG)-1;
        val = __Pyx_PyInt_AsSignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static void __Pyx_WriteUnraisable(const char *name, int clineno,
                                  int lineno, const char *filename) {
    PyObject *old_exc, *old_val, *old_tb;
    PyObject *ctx;
    __Pyx_ErrFetch(&old_exc, &old_val, &old_tb);
    #if PY_MAJOR_VERSION < 3
    ctx = PyString_FromString(name);
    #else
    ctx = PyUnicode_FromString(name);
    #endif
    __Pyx_ErrRestore(old_exc, old_val, old_tb);
    if (!ctx) {
        PyErr_WriteUnraisable(Py_None);
    } else {
        PyErr_WriteUnraisable(ctx);
        Py_DECREF(ctx);
    }
}

static CYTHON_INLINE void __Pyx_ExceptionSwap(PyObject **type, PyObject **value, PyObject **tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();

    tmp_type = tstate->exc_type;
    tmp_value = tstate->exc_value;
    tmp_tb = tstate->exc_traceback;

    tstate->exc_type = *type;
    tstate->exc_value = *value;
    tstate->exc_traceback = *tb;

    *type = tmp_type;
    *value = tmp_value;
    *tb = tmp_tb;
}

static CYTHON_INLINE void __Pyx_Generator_ExceptionClear(struct __pyx_Generator_object *self)
{
    Py_XDECREF(self->exc_type);
    Py_XDECREF(self->exc_value);
    Py_XDECREF(self->exc_traceback);

    self->exc_type = NULL;
    self->exc_value = NULL;
    self->exc_traceback = NULL;
}

static CYTHON_INLINE PyObject *__Pyx_Generator_SendEx(struct __pyx_Generator_object *self, PyObject *value)
{
    PyObject *retval;

    if (self->is_running) {
        PyErr_SetString(PyExc_ValueError,
                        "generator already executing");
        return NULL;
    }

    if (self->resume_label == 0) {
        if (value && value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                            "can't send non-None value to a "
                            "just-started generator");
            return NULL;
        }
    }

    if (self->resume_label == -1) {
        PyErr_SetNone(PyExc_StopIteration);
        return NULL;
    }


    if (value)
        __Pyx_ExceptionSwap(&self->exc_type, &self->exc_value, &self->exc_traceback);
    else
        __Pyx_Generator_ExceptionClear(self);

    self->is_running = 1;
    retval = self->body((PyObject *) self, value);
    self->is_running = 0;

    if (retval)
        __Pyx_ExceptionSwap(&self->exc_type, &self->exc_value, &self->exc_traceback);
    else
        __Pyx_Generator_ExceptionClear(self);

    return retval;
}

static PyObject *__Pyx_Generator_Next(PyObject *self)
{
    return __Pyx_Generator_SendEx((struct __pyx_Generator_object *) self, Py_None);
}

static PyObject *__Pyx_Generator_Send(PyObject *self, PyObject *value)
{
    return __Pyx_Generator_SendEx((struct __pyx_Generator_object *) self, value);
}

static PyObject *__Pyx_Generator_Close(PyObject *self)
{
    struct __pyx_Generator_object *generator = (struct __pyx_Generator_object *) self;
    PyObject *retval;
#if PY_VERSION_HEX < 0x02050000
    PyErr_SetNone(PyExc_StopIteration);
#else
    PyErr_SetNone(PyExc_GeneratorExit);
#endif
    retval = __Pyx_Generator_SendEx(generator, NULL);
    if (retval) {
        Py_DECREF(retval);
        PyErr_SetString(PyExc_RuntimeError,
                        "generator ignored GeneratorExit");
        return NULL;
    }
#if PY_VERSION_HEX < 0x02050000
    if (PyErr_ExceptionMatches(PyExc_StopIteration))
#else
    if (PyErr_ExceptionMatches(PyExc_StopIteration)
        || PyErr_ExceptionMatches(PyExc_GeneratorExit))
#endif
    {
        PyErr_Clear();          /* ignore these errors */
        Py_INCREF(Py_None);
        return Py_None;
    }
    return NULL;
}

static PyObject *__Pyx_Generator_Throw(PyObject *self, PyObject *args, CYTHON_UNUSED PyObject *kwds)
{
    struct __pyx_Generator_object *generator = (struct __pyx_Generator_object *) self;
    PyObject *typ;
    PyObject *tb = NULL;
    PyObject *val = NULL;

    if (!PyArg_UnpackTuple(args, (char *)"throw", 1, 3, &typ, &val, &tb))
        return NULL;
    __Pyx_Raise(typ, val, tb, NULL);
    return __Pyx_Generator_SendEx(generator, NULL);
}

static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        #if PY_VERSION_HEX < 0x02050000
        return PyErr_Warn(NULL, message);
        #else
        return PyErr_WarnEx(NULL, message, 1);
        #endif
    }
    return 0;
}

static int __Pyx_ExportFunction(const char *name, void (*f)(void), const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;

    d = PyObject_GetAttrString(__pyx_m, (char *)"__pyx_capi__");
    if (!d) {
        PyErr_Clear();
        d = PyDict_New();
        if (!d)
            goto bad;
        Py_INCREF(d);
        if (PyModule_AddObject(__pyx_m, (char *)"__pyx_capi__", d) < 0)
            goto bad;
    }
    tmp.fp = f;
#if PY_VERSION_HEX >= 0x02070000 && !(PY_MAJOR_VERSION==3&&PY_MINOR_VERSION==0)
    cobj = PyCapsule_New(tmp.p, sig, 0);
#else
    cobj = PyCObject_FromVoidPtrAndDesc(tmp.p, (void *)sig, 0);
#endif
    if (!cobj)
        goto bad;
    if (PyDict_SetItemString(d, name, cobj) < 0)
        goto bad;
    Py_DECREF(cobj);
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(cobj);
    Py_XDECREF(d);
    return -1;
}

static int __Pyx_SetVtable(PyObject *dict, void *vtable) {
#if PY_VERSION_HEX >= 0x02070000 && !(PY_MAJOR_VERSION==3&&PY_MINOR_VERSION==0)
    PyObject *ob = PyCapsule_New(vtable, 0, 0);
#else
    PyObject *ob = PyCObject_FromVoidPtr(vtable, 0);
#endif
    if (!ob)
        goto bad;
    if (PyDict_SetItemString(dict, "__pyx_vtable__", ob) < 0)
        goto bad;
    Py_DECREF(ob);
    return 0;
bad:
    Py_XDECREF(ob);
    return -1;
}

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    size_t size, int strict)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;
    char warning[200];

    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(class_name);
    #else
    py_name = PyUnicode_FromString(class_name);
    #endif
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (!strict && ((PyTypeObject *)result)->tp_basicsize > (Py_ssize_t)size) {
        PyOS_snprintf(warning, sizeof(warning),
            "%s.%s size changed, may indicate binary incompatibility",
            module_name, class_name);
        #if PY_VERSION_HEX < 0x02050000
        if (PyErr_Warn(NULL, warning) < 0) goto bad;
        #else
        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
        #endif
    }
    else if (((PyTypeObject *)result)->tp_basicsize != (Py_ssize_t)size) {
        PyErr_Format(PyExc_ValueError,
            "%s.%s has the wrong size, try recompiling",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return NULL;
}
#endif

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;

    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(name);
    #else
    py_name = PyUnicode_FromString(name);
    #endif
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportFunction
#define __PYX_HAVE_RT_ImportFunction
static int __Pyx_ImportFunction(PyObject *module, const char *funcname, void (**f)(void), const char *sig) {
    PyObject *d = 0;
    PyObject *cobj = 0;
    union {
        void (*fp)(void);
        void *p;
    } tmp;

    d = PyObject_GetAttrString(module, (char *)"__pyx_capi__");
    if (!d)
        goto bad;
    cobj = PyDict_GetItemString(d, funcname);
    if (!cobj) {
        PyErr_Format(PyExc_ImportError,
            "%s does not export expected C function %s",
                PyModule_GetName(module), funcname);
        goto bad;
    }
#if PY_VERSION_HEX >= 0x02070000 && !(PY_MAJOR_VERSION==3&&PY_MINOR_VERSION==0)
    if (!PyCapsule_IsValid(cobj, sig)) {
        PyErr_Format(PyExc_TypeError,
            "C function %s.%s has wrong signature (expected %s, got %s)",
             PyModule_GetName(module), funcname, sig, PyCapsule_GetName(cobj));
        goto bad;
    }
    tmp.p = PyCapsule_GetPointer(cobj, sig);
#else
    {const char *desc, *s1, *s2;
    desc = (const char *)PyCObject_GetDesc(cobj);
    if (!desc)
        goto bad;
    s1 = desc; s2 = sig;
    while (*s1 != '\0' && *s1 == *s2) { s1++; s2++; }
    if (*s1 != *s2) {
        PyErr_Format(PyExc_TypeError,
            "C function %s.%s has wrong signature (expected %s, got %s)",
             PyModule_GetName(module), funcname, sig, desc);
        goto bad;
    }
    tmp.p = PyCObject_AsVoidPtr(cobj);}
#endif
    *f = tmp.fp;
    if (!(*f))
        goto bad;
    Py_DECREF(d);
    return 0;
bad:
    Py_XDECREF(d);
    return -1;
}
#endif

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(const char *funcname, int __pyx_clineno,
                               int __pyx_lineno, const char *__pyx_filename) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;

    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(__pyx_filename);
    #else
    py_srcfile = PyUnicode_FromString(__pyx_filename);
    #endif
    if (!py_srcfile) goto bad;
    if (__pyx_clineno) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        #if PY_MAJOR_VERSION >= 3
        0,            /*int kwonlyargcount,*/
        #endif
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple,  /*PyObject *consts,*/
        __pyx_empty_tuple,  /*PyObject *names,*/
        __pyx_empty_tuple,  /*PyObject *varnames,*/
        __pyx_empty_tuple,  /*PyObject *freevars,*/
        __pyx_empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else  /* Python 3+ has unicode identifiers */
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

/* Type Conversion Functions */

static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}

static CYTHON_INLINE PyObject* __Pyx_PyNumber_Int(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_VERSION_HEX < 0x03000000
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return Py_INCREF(x), x;
  m = Py_TYPE(x)->tp_as_number;
#if PY_VERSION_HEX < 0x03000000
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_VERSION_HEX < 0x03000000
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%s__ returned non-%s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}

static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}

static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
#if PY_VERSION_HEX < 0x02050000
   if (ival <= LONG_MAX)
       return PyInt_FromLong((long)ival);
   else {
       unsigned char *bytes = (unsigned char *) &ival;
       int one = 1; int little = (int)*(unsigned char*)&one;
       return _PyLong_FromByteArray(bytes, sizeof(size_t), little, 0);
   }
#else
   return PyInt_FromSize_t(ival);
#endif
}

static CYTHON_INLINE size_t __Pyx_PyInt_AsSize_t(PyObject* x) {
   unsigned PY_LONG_LONG val = __Pyx_PyInt_AsUnsignedLongLong(x);
   if (unlikely(val == (unsigned PY_LONG_LONG)-1 && PyErr_Occurred())) {
       return (size_t)-1;
   } else if (unlikely(val != (unsigned PY_LONG_LONG)(size_t)val)) {
       PyErr_SetString(PyExc_OverflowError,
                       "value too large to convert to size_t");
       return (size_t)-1;
   }
   return (size_t)val;
}


#endif /* Py_PYTHON_H */
